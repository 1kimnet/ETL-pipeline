2025-07-25 01:22:03,402  INFO     [etl.mapping:95]  ‚öôÔ∏è  Loaded mapping settings: MappingSettings(default_schema='GNG', default_dataset_pattern='Underlag_{authority}', default_fc_pattern='{authority}_{source_name}', validate_datasets=True, create_missing_datasets=True, skip_unmappable_sources=False)
2025-07-25 01:22:03,402  INFO     [etl.mapping:117]  ‚úÖ Loaded 1 mappings from config\mappings.yaml
2025-07-25 01:22:03,403  INFO     [etl.mapping:64]  üó∫Ô∏è  Mapping manager initialized with 1 mappings
2025-07-25 01:22:03,403  INFO     [etl.monitoring:137]  üìä Metrics collector initialized (max_points=10000)
2025-07-25 01:22:03,406  INFO     [etl.monitoring:449]  üîç Pipeline monitor initialized
2025-07-25 01:22:03,406  INFO     [etl.utils.performance:367]  ‚ö° Parallel processor initialized: max_workers=2
2025-07-25 01:22:03,407  INFO     [etl.monitoring:465]  üöÄ Started pipeline run: pipeline_1753399323
2025-07-25 01:22:03,407  INFO     [pipeline:623]  üöÄ Starting ETL pipeline run - ID: pipeline_1753399323, Sources: config\sources.yaml
2025-07-25 01:22:03,409  INFO     [etl.utils.cleanup:35]  üìÅ Downloads folder is already empty
2025-07-25 01:22:03,410  INFO     [etl.utils.cleanup:77]  üìÅ Staging folder is already empty
2025-07-25 01:22:03,450  INFO     [etl.models:127]  ‚úÖ Loaded 53 sources from config\sources.yaml
2025-07-25 01:22:03,451  INFO     [pipeline:623]  üìã Found sources to process: 53
2025-07-25 01:22:03,451  INFO     [pipeline:623]  üöÄ Concurrent downloads enabled: REST=5, OGC=3, Files=4 workers
2025-07-25 01:22:03,451  INFO     [pipeline:623]  üöö F√∂rsvarsmakten - Rikst√§ckande geodata
2025-07-25 01:22:03,452  INFO     [etl.handlers.file:162]  üîó Single resource download mode for 'F√∂rsvarsmakten - Rikst√§ckande geodata' from URL: https://www.forsvarsmakten.se/siteassets/2-om-forsvarsmakten/samhallsplanering/geodata/rikstackande-geodata-forsvarsmakten.zip
2025-07-25 01:22:03,591  WARNING  [etl.utils.http:100]      HEAD request for Content-Disposition failed for https://www.forsvarsmakten.se/siteassets/2-om-forsvarsmakten/samhallsplanering/geodata/rikstackande-geodata-forsvarsmakten.zip: HTTP Error 403: Forbidden. Will fall back to URL basename.
2025-07-25 01:22:03,594  INFO     [etl.utils.http:110]      Derived filename by unquoting URL basename ('https://www.forsvarsmakten.se/siteassets/2-om-forsvarsmakten/samhallsplanering/geodata/rikstackande-geodata-forsvarsmakten.zip'): rikstackande-geodata-forsvarsmakten.zip
2025-07-25 01:22:03,597  DEBUG    [etl.handlers.file:247]  Attempting to download: https://www.forsvarsmakten.se/siteassets/2-om-forsvarsmakten/samhallsplanering/geodata/rikstackande-geodata-forsvarsmakten.zip 
    -> to local file: forsvarsmakten_-_rikstackande_geodata.zip 
    -> staging dir: data\staging\FM\forsvarsmakten_-_rikstackande_geodata
2025-07-25 01:22:03,606  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): www.forsvarsmakten.se:443
2025-07-25 01:22:03,679  DEBUG    [urllib3.connectionpool:544]  https://www.forsvarsmakten.se:443 "HEAD /siteassets/2-om-forsvarsmakten/samhallsplanering/geodata/rikstackande-geodata-forsvarsmakten.zip HTTP/1.1" 403 0
2025-07-25 01:22:03,680  INFO     [etl.utils.io:46]  ‚¨á forsvarsmakten_-_rikstackande_geodata.zip
2025-07-25 01:22:03,682  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): www.forsvarsmakten.se:443
2025-07-25 01:22:03,754  DEBUG    [urllib3.connectionpool:544]  https://www.forsvarsmakten.se:443 "GET /siteassets/2-om-forsvarsmakten/samhallsplanering/geodata/rikstackande-geodata-forsvarsmakten.zip HTTP/1.1" 200 1331177
2025-07-25 01:22:03,865  INFO     [etl.utils.io:82]  ‚úÖ forsvarsmakten_-_rikstackande_geodata.zip
2025-07-25 01:22:03,866  INFO     [etl.handlers.file:278]  Determined staged_data_type: 'shapefile_collection' for downloaded file 'forsvarsmakten_-_rikstackande_geodata.zip'
2025-07-25 01:22:03,866  INFO     [etl.utils.io:88]  üì¶ Extracting forsvarsmakten_-_rikstackande_geodata.zip ‚Üí C:\Git\ETL-pipeline\data\staging\FM\forsvarsmakten_-_rikstackande_geodata
2025-07-25 01:22:03,973  INFO     [etl.handlers.file:351]  ‚ûï Extracted and staged archive forsvarsmakten_-_rikstackande_geodata.zip to data\staging\FM\forsvarsmakten_-_rikstackande_geodata
2025-07-25 01:22:03,974  INFO     [pipeline:623]  üöö Naturv√•rdsverket - Naturv√•rdsregistret
2025-07-25 01:22:03,974  INFO     [etl.handlers.file:82]  üîó Multi-part download mode for 'Naturv√•rdsverket - Naturv√•rdsregistret' (19 archives from base URL 'https://geodata.naturvardsverket.se/nedladdning/naturvardsregistret/')‚Ä¶
2025-07-25 01:22:03,975  INFO     [etl.handlers.file:104]  üöÄ Starting concurrent download of 19 files
2025-07-25 01:22:03,975  INFO     [etl.utils.concurrent:86]  Initialized ConcurrentDownloadManager with 4 workers
2025-07-25 01:22:03,975  ERROR    [etl.handlers.file:73]  ‚ùå Failed to fetch source 'Naturv√•rdsverket - Naturv√•rdsregistret': ConcurrentFileDownloader.download_files_concurrent() got an unexpected keyword argument 'max_workers'
2025-07-25 01:22:03,975  INFO     [etl.utils.recovery:158]  üîÑ Attempting recovery from TypeError in download_source_Naturv√•rdsverket - Naturv√•rdsregistret: ConcurrentFileDownloader.download_files_concurrent() got an unexpected keyword argument 'max_workers'
2025-07-25 01:22:03,975  WARNING  [etl.utils.recovery:245]  ‚è≠Ô∏è Skipping failed operation: download_source_Naturv√•rdsverket - Naturv√•rdsregistret
2025-07-25 01:22:03,975  INFO     [etl.utils.recovery:214]  ‚úÖ Recovery successful using skip strategy
2025-07-25 01:22:03,976  INFO     [pipeline:623]  ‚úÖ Recovered from download error for Naturv√•rdsverket - Naturv√•rdsregistret
2025-07-25 01:22:03,976  INFO     [pipeline:623]  üöö Milj√∂riskomr√•de
2025-07-25 01:22:03,977  INFO     [etl.handlers.atom_feed:41]  üåê Reading Atom feed for source 'Milj√∂riskomr√•de' from URL: https://ext-dokument.lansstyrelsen.se/gemensamt/geodata/ATOM/ATOM_lst.LST_Miljoriskomrade.xml
2025-07-25 01:22:03,979  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): ext-dokument.lansstyrelsen.se:443
2025-07-25 01:22:04,136  DEBUG    [urllib3.connectionpool:544]  https://ext-dokument.lansstyrelsen.se:443 "HEAD /gemensamt/geodata/ATOM/ATOM_lst.LST_Miljoriskomrade.xml HTTP/1.1" 200 0
2025-07-25 01:22:04,137  INFO     [etl.utils.io:44]  ‚¨á miljoriskomrade_feed.xml (1.0 KB)
2025-07-25 01:22:04,139  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): ext-dokument.lansstyrelsen.se:443
2025-07-25 01:22:04,249  DEBUG    [urllib3.connectionpool:544]  https://ext-dokument.lansstyrelsen.se:443 "GET /gemensamt/geodata/ATOM/ATOM_lst.LST_Miljoriskomrade.xml HTTP/1.1" 200 1034
2025-07-25 01:22:04,251  INFO     [etl.utils.io:82]  ‚úÖ miljoriskomrade_feed.xml
2025-07-25 01:22:04,255  INFO     [etl.handlers.atom_feed:77]  Target staging directory for all content from Atom source 'Milj√∂riskomr√•de': data\staging\LST\miljoriskomrade
2025-07-25 01:22:04,256  INFO     [etl.handlers.atom_feed:105]  Found linked resource in Atom feed for 'Milj√∂riskomr√•de': https://ext-dokument.lansstyrelsen.se/gemensamt/geodata/ShapeExport/lst.LST_Miljoriskomrade.zip
2025-07-25 01:22:04,421  INFO     [etl.utils.http:110]      Derived filename by unquoting URL basename ('https://ext-dokument.lansstyrelsen.se/gemensamt/geodata/ShapeExport/lst.LST_Miljoriskomrade.zip'): lst.LST_Miljoriskomrade.zip
2025-07-25 01:22:04,421  INFO     [etl.handlers.atom_feed:157]  Attempting to download linked resource: https://ext-dokument.lansstyrelsen.se/gemensamt/geodata/ShapeExport/lst.LST_Miljoriskomrade.zip 
        -> to local file: lst_lst_miljoriskomrade.zip
2025-07-25 01:22:04,425  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): ext-dokument.lansstyrelsen.se:443
2025-07-25 01:22:04,538  DEBUG    [urllib3.connectionpool:544]  https://ext-dokument.lansstyrelsen.se:443 "HEAD /gemensamt/geodata/ShapeExport/lst.LST_Miljoriskomrade.zip HTTP/1.1" 200 0
2025-07-25 01:22:04,539  INFO     [etl.utils.io:44]  ‚¨á lst_lst_miljoriskomrade.zip (74.2 KB)
2025-07-25 01:22:04,542  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): ext-dokument.lansstyrelsen.se:443
2025-07-25 01:22:04,667  DEBUG    [urllib3.connectionpool:544]  https://ext-dokument.lansstyrelsen.se:443 "GET /gemensamt/geodata/ShapeExport/lst.LST_Miljoriskomrade.zip HTTP/1.1" 200 75966
2025-07-25 01:22:04,708  INFO     [etl.utils.io:82]  ‚úÖ lst_lst_miljoriskomrade.zip
2025-07-25 01:22:04,709  INFO     [etl.handlers.atom_feed:168]  Downloaded file 'lst_lst_miljoriskomrade.zip' is a ZIP archive. Extracting...
2025-07-25 01:22:04,709  INFO     [etl.utils.io:88]  üì¶ Extracting lst_lst_miljoriskomrade.zip ‚Üí C:\Git\ETL-pipeline\data\staging\LST\miljoriskomrade
2025-07-25 01:22:04,725  INFO     [etl.handlers.atom_feed:173]  ‚ûï Extracted and staged archive lst_lst_miljoriskomrade.zip into data\staging\LST\miljoriskomrade
2025-07-25 01:22:04,725  INFO     [etl.handlers.atom_feed:180]  Source 'Milj√∂riskomr√•de' expects a GPKG. Searching in extracted contents of lst_lst_miljoriskomrade.zip...
2025-07-25 01:22:04,727  INFO     [etl.handlers.atom_feed:197]  Renaming/moving extracted GPKG 'lst.LST_Miljoriskomrade.gpkg' to 'miljoriskomrade.gpkg'
2025-07-25 01:22:04,727  INFO     [etl.handlers.atom_feed:207]  ‚úÖ Successfully staged GPKG 'miljoriskomrade.gpkg' for source 'Milj√∂riskomr√•de'.
2025-07-25 01:22:04,728  INFO     [pipeline:623]  üöö Vindkraftskollen: Vindkraftverk
2025-07-25 01:22:04,728  INFO     [etl.handlers.atom_feed:41]  üåê Reading Atom feed for source 'Vindkraftskollen: Vindkraftverk' from URL: https://ext-dokument.lansstyrelsen.se/gemensamt/geodata/ATOM/ATOM_lst.vbk_vindkraftverk.xml
2025-07-25 01:22:04,730  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): ext-dokument.lansstyrelsen.se:443
2025-07-25 01:22:04,856  DEBUG    [urllib3.connectionpool:544]  https://ext-dokument.lansstyrelsen.se:443 "HEAD /gemensamt/geodata/ATOM/ATOM_lst.vbk_vindkraftverk.xml HTTP/1.1" 200 0
2025-07-25 01:22:04,857  INFO     [etl.utils.io:44]  ‚¨á vindkraftskollen_vindkraftverk_feed.xml (1.0 KB)
2025-07-25 01:22:04,858  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): ext-dokument.lansstyrelsen.se:443
2025-07-25 01:22:04,951  DEBUG    [urllib3.connectionpool:544]  https://ext-dokument.lansstyrelsen.se:443 "GET /gemensamt/geodata/ATOM/ATOM_lst.vbk_vindkraftverk.xml HTTP/1.1" 200 1037
2025-07-25 01:22:04,952  INFO     [etl.utils.io:82]  ‚úÖ vindkraftskollen_vindkraftverk_feed.xml
2025-07-25 01:22:04,954  INFO     [etl.handlers.atom_feed:77]  Target staging directory for all content from Atom source 'Vindkraftskollen: Vindkraftverk': data\staging\LST\vindkraftskollen_vindkraftverk
2025-07-25 01:22:04,954  INFO     [etl.handlers.atom_feed:105]  Found linked resource in Atom feed for 'Vindkraftskollen: Vindkraftverk': https://ext-dokument.lansstyrelsen.se/gemensamt/geodata/ShapeExport/lst.vbk_vindkraftverk.zip
2025-07-25 01:22:05,100  INFO     [etl.utils.http:110]      Derived filename by unquoting URL basename ('https://ext-dokument.lansstyrelsen.se/gemensamt/geodata/ShapeExport/lst.vbk_vindkraftverk.zip'): lst.vbk_vindkraftverk.zip
2025-07-25 01:22:05,102  INFO     [etl.handlers.atom_feed:157]  Attempting to download linked resource: https://ext-dokument.lansstyrelsen.se/gemensamt/geodata/ShapeExport/lst.vbk_vindkraftverk.zip 
        -> to local file: lst_vbk_vindkraftverk.zip
2025-07-25 01:22:05,105  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): ext-dokument.lansstyrelsen.se:443
2025-07-25 01:22:05,219  DEBUG    [urllib3.connectionpool:544]  https://ext-dokument.lansstyrelsen.se:443 "HEAD /gemensamt/geodata/ShapeExport/lst.vbk_vindkraftverk.zip HTTP/1.1" 200 0
2025-07-25 01:22:05,221  INFO     [etl.utils.io:44]  ‚¨á lst_vbk_vindkraftverk.zip (4.1 MB)
2025-07-25 01:22:05,223  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): ext-dokument.lansstyrelsen.se:443
2025-07-25 01:22:05,361  DEBUG    [urllib3.connectionpool:544]  https://ext-dokument.lansstyrelsen.se:443 "GET /gemensamt/geodata/ShapeExport/lst.vbk_vindkraftverk.zip HTTP/1.1" 200 4321083
2025-07-25 01:22:06,356  INFO     [etl.utils.io:82]  ‚úÖ lst_vbk_vindkraftverk.zip
2025-07-25 01:22:06,357  INFO     [etl.handlers.atom_feed:168]  Downloaded file 'lst_vbk_vindkraftverk.zip' is a ZIP archive. Extracting...
2025-07-25 01:22:06,357  INFO     [etl.utils.io:88]  üì¶ Extracting lst_vbk_vindkraftverk.zip ‚Üí C:\Git\ETL-pipeline\data\staging\LST\vindkraftskollen_vindkraftverk
2025-07-25 01:22:06,499  INFO     [etl.handlers.atom_feed:173]  ‚ûï Extracted and staged archive lst_vbk_vindkraftverk.zip into data\staging\LST\vindkraftskollen_vindkraftverk
2025-07-25 01:22:06,499  INFO     [etl.handlers.atom_feed:180]  Source 'Vindkraftskollen: Vindkraftverk' expects a GPKG. Searching in extracted contents of lst_vbk_vindkraftverk.zip...
2025-07-25 01:22:06,500  INFO     [etl.handlers.atom_feed:197]  Renaming/moving extracted GPKG 'lst.vbk_vindkraftverk.gpkg' to 'vindkraftskollen_vindkraftverk.gpkg'
2025-07-25 01:22:06,501  INFO     [etl.handlers.atom_feed:207]  ‚úÖ Successfully staged GPKG 'vindkraftskollen_vindkraftverk.gpkg' for source 'Vindkraftskollen: Vindkraftverk'.
2025-07-25 01:22:06,501  INFO     [pipeline:623]  üöö Vindkraftskollen: Projekteringsomr√•den
2025-07-25 01:22:06,502  INFO     [etl.handlers.atom_feed:41]  üåê Reading Atom feed for source 'Vindkraftskollen: Projekteringsomr√•den' from URL: https://ext-dokument.lansstyrelsen.se/gemensamt/geodata/ATOM/ATOM_lst.vbk_projekteringsomraden.xml
2025-07-25 01:22:06,503  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): ext-dokument.lansstyrelsen.se:443
2025-07-25 01:22:06,631  DEBUG    [urllib3.connectionpool:544]  https://ext-dokument.lansstyrelsen.se:443 "HEAD /gemensamt/geodata/ATOM/ATOM_lst.vbk_projekteringsomraden.xml HTTP/1.1" 200 0
2025-07-25 01:22:06,632  INFO     [etl.utils.io:44]  ‚¨á vindkraftskollen_projekteringsomraden_feed.xml (1.0 KB)
2025-07-25 01:22:06,635  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): ext-dokument.lansstyrelsen.se:443
2025-07-25 01:22:06,752  DEBUG    [urllib3.connectionpool:544]  https://ext-dokument.lansstyrelsen.se:443 "GET /gemensamt/geodata/ATOM/ATOM_lst.vbk_projekteringsomraden.xml HTTP/1.1" 200 1049
2025-07-25 01:22:06,754  INFO     [etl.utils.io:82]  ‚úÖ vindkraftskollen_projekteringsomraden_feed.xml
2025-07-25 01:22:06,757  INFO     [etl.handlers.atom_feed:77]  Target staging directory for all content from Atom source 'Vindkraftskollen: Projekteringsomr√•den': data\staging\LST\vindkraftskollen_projekteringsomraden
2025-07-25 01:22:06,757  INFO     [etl.handlers.atom_feed:105]  Found linked resource in Atom feed for 'Vindkraftskollen: Projekteringsomr√•den': https://ext-dokument.lansstyrelsen.se/gemensamt/geodata/ShapeExport/lst.vbk_projekteringsomraden.zip
2025-07-25 01:22:06,882  INFO     [etl.utils.http:110]      Derived filename by unquoting URL basename ('https://ext-dokument.lansstyrelsen.se/gemensamt/geodata/ShapeExport/lst.vbk_projekteringsomraden.zip'): lst.vbk_projekteringsomraden.zip
2025-07-25 01:22:06,882  INFO     [etl.handlers.atom_feed:157]  Attempting to download linked resource: https://ext-dokument.lansstyrelsen.se/gemensamt/geodata/ShapeExport/lst.vbk_projekteringsomraden.zip 
        -> to local file: lst_vbk_projekteringsomraden.zip
2025-07-25 01:22:06,884  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): ext-dokument.lansstyrelsen.se:443
2025-07-25 01:22:06,993  DEBUG    [urllib3.connectionpool:544]  https://ext-dokument.lansstyrelsen.se:443 "HEAD /gemensamt/geodata/ShapeExport/lst.vbk_projekteringsomraden.zip HTTP/1.1" 200 0
2025-07-25 01:22:06,993  INFO     [etl.utils.io:44]  ‚¨á lst_vbk_projekteringsomraden.zip (4.5 MB)
2025-07-25 01:22:06,995  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): ext-dokument.lansstyrelsen.se:443
2025-07-25 01:22:07,113  DEBUG    [urllib3.connectionpool:544]  https://ext-dokument.lansstyrelsen.se:443 "GET /gemensamt/geodata/ShapeExport/lst.vbk_projekteringsomraden.zip HTTP/1.1" 200 4735498
2025-07-25 01:22:07,434  INFO     [etl.utils.io:82]  ‚úÖ lst_vbk_projekteringsomraden.zip
2025-07-25 01:22:07,435  INFO     [etl.handlers.atom_feed:168]  Downloaded file 'lst_vbk_projekteringsomraden.zip' is a ZIP archive. Extracting...
2025-07-25 01:22:07,435  INFO     [etl.utils.io:88]  üì¶ Extracting lst_vbk_projekteringsomraden.zip ‚Üí C:\Git\ETL-pipeline\data\staging\LST\vindkraftskollen_projekteringsomraden
2025-07-25 01:22:07,520  INFO     [etl.handlers.atom_feed:173]  ‚ûï Extracted and staged archive lst_vbk_projekteringsomraden.zip into data\staging\LST\vindkraftskollen_projekteringsomraden
2025-07-25 01:22:07,520  INFO     [etl.handlers.atom_feed:180]  Source 'Vindkraftskollen: Projekteringsomr√•den' expects a GPKG. Searching in extracted contents of lst_vbk_projekteringsomraden.zip...
2025-07-25 01:22:07,522  INFO     [etl.handlers.atom_feed:197]  Renaming/moving extracted GPKG 'lst.vbk_projekteringsomraden.gpkg' to 'vindkraftskollen_projekteringsomraden.gpkg'
2025-07-25 01:22:07,523  INFO     [etl.handlers.atom_feed:207]  ‚úÖ Successfully staged GPKG 'vindkraftskollen_projekteringsomraden.gpkg' for source 'Vindkraftskollen: Projekteringsomr√•den'.
2025-07-25 01:22:07,524  INFO     [pipeline:623]  üöö Potentiellt f√∂rorenade omr√•den
2025-07-25 01:22:07,525  INFO     [etl.handlers.file:162]  üîó Single resource download mode for 'Potentiellt f√∂rorenade omr√•den' from URL: https://ext-dokument.lansstyrelsen.se/Gemensamt/Geodata/Datadistribution/SWEREF99TM/EBH_Potentiellt_fororenade_omraden.zip
2025-07-25 01:22:07,683  INFO     [etl.utils.http:110]      Derived filename by unquoting URL basename ('https://ext-dokument.lansstyrelsen.se/Gemensamt/Geodata/Datadistribution/SWEREF99TM/EBH_Potentiellt_fororenade_omraden.zip'): EBH_Potentiellt_fororenade_omraden.zip
2025-07-25 01:22:07,685  DEBUG    [etl.handlers.file:247]  Attempting to download: https://ext-dokument.lansstyrelsen.se/Gemensamt/Geodata/Datadistribution/SWEREF99TM/EBH_Potentiellt_fororenade_omraden.zip 
    -> to local file: potentiellt_fororenade_omraden.zip 
    -> staging dir: data\staging\LST\potentiellt_fororenade_omraden
2025-07-25 01:22:07,689  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): ext-dokument.lansstyrelsen.se:443
2025-07-25 01:22:07,808  DEBUG    [urllib3.connectionpool:544]  https://ext-dokument.lansstyrelsen.se:443 "HEAD /Gemensamt/Geodata/Datadistribution/SWEREF99TM/EBH_Potentiellt_fororenade_omraden.zip HTTP/1.1" 200 0
2025-07-25 01:22:07,809  INFO     [etl.utils.io:44]  ‚¨á potentiellt_fororenade_omraden.zip (5.0 MB)
2025-07-25 01:22:07,810  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): ext-dokument.lansstyrelsen.se:443
2025-07-25 01:22:07,907  DEBUG    [urllib3.connectionpool:544]  https://ext-dokument.lansstyrelsen.se:443 "GET /Gemensamt/Geodata/Datadistribution/SWEREF99TM/EBH_Potentiellt_fororenade_omraden.zip HTTP/1.1" 200 5250357
2025-07-25 01:22:08,659  INFO     [etl.utils.io:82]  ‚úÖ potentiellt_fororenade_omraden.zip
2025-07-25 01:22:08,660  INFO     [etl.handlers.file:278]  Determined staged_data_type: 'shapefile_collection' for downloaded file 'potentiellt_fororenade_omraden.zip'
2025-07-25 01:22:08,660  INFO     [etl.utils.io:88]  üì¶ Extracting potentiellt_fororenade_omraden.zip ‚Üí C:\Git\ETL-pipeline\data\staging\LST\potentiellt_fororenade_omraden
2025-07-25 01:22:08,915  INFO     [etl.handlers.file:351]  ‚ûï Extracted and staged archive potentiellt_fororenade_omraden.zip to data\staging\LST\potentiellt_fororenade_omraden
2025-07-25 01:22:08,915  INFO     [pipeline:623]  üöö Riksintressen
2025-07-25 01:22:08,916  INFO     [etl.handlers.rest_api:68]  üöÄ Initializing RestApiDownloadHandler for source: Riksintressen
2025-07-25 01:22:08,916  INFO     [etl.handlers.rest_api:321]  üåê Processing REST API source: 'Riksintressen' from URL: https://ext-geodata-nationella.lansstyrelsen.se/arcgis/rest/services/LST/lst_lst_riksintressen_4/MapServer
2025-07-25 01:22:08,918  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): ext-geodata-nationella.lansstyrelsen.se:443
2025-07-25 01:22:09,048  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-nationella.lansstyrelsen.se:443 "GET /arcgis/rest/services/LST/lst_lst_riksintressen_4/MapServer?f=json HTTP/1.1" 200 1106
2025-07-25 01:22:09,049  INFO     [etl.handlers.rest_api:346]  Found explicit layer_ids in config: [0] for source 'Riksintressen'. Processing only these.
2025-07-25 01:22:09,050  INFO     [etl.handlers.rest_api:427]  Source 'Riksintressen': Will attempt to query 1 layer(s): ['0']
2025-07-25 01:22:09,050  INFO     [etl.handlers.rest_api:659]  üöö lst_riksintresse_rorligt_friluftsliv_mb4kap_1plus2
2025-07-25 01:22:09,050  DEBUG    [etl.handlers.rest_api:660]  Querying Layer ID: 0 (Sanitized Name: lst_riksintresse_rorligt_friluftsliv_mb4kap_1plus2, Original: LST_Riksintresse_Rorligt_Friluftsliv_MB4kap_1plus2) from https://ext-geodata-nationella.lansstyrelsen.se/arcgis/rest/services/LST/lst_lst_riksintressen_4/MapServer/0/query
2025-07-25 01:22:09,050  DEBUG    [etl.handlers.rest_api:530]  maxRecordCount not found in layer metadata, using default: 5000
2025-07-25 01:22:09,050  DEBUG    [etl.handlers.rest_api:199]  Applying BBOX: 586206,6551160,647910,6610992 (SRID: 3006)
2025-07-25 01:22:09,051  DEBUG    [etl.handlers.rest_api:565]  Fetching page 1 for layer lst_riksintresse_rorligt_friluftsliv_mb4kap_1plus2 (offset 0, limit 5000)
2025-07-25 01:22:09,179  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-nationella.lansstyrelsen.se:443 "GET /arcgis/rest/services/LST/lst_lst_riksintressen_4/MapServer/0/query?where=1%3D1&outFields=%2A&returnGeometry=true&f=geojson&geometry=586206%2C6551160%2C647910%2C6610992&geometryType=esriGeometryEnvelope&inSR=3006&spatialRel=esriSpatialRelIntersects&resultOffset=0&resultRecordCount=5000 HTTP/1.1" 200 None
2025-07-25 01:22:09,290  DEBUG    [etl.handlers.rest_api:279]  üèÅ All features likely retrieved for layer lst_riksintresse_rorligt_friluftsliv_mb4kap_1plus2 (less than page limit or server maxRecordCount is 0).
2025-07-25 01:22:09,361  INFO     [etl.handlers.rest_api:298]  ‚úÖ lst_riksintresse_rorligt_friluftsliv_mb4kap_1plus2: 6 features
2025-07-25 01:22:09,361  DEBUG    [etl.handlers.rest_api:299]  üíæ Successfully saved 6 features for layer lst_riksintresse_rorligt_friluftsliv_mb4kap_1plus2 to C:\Git\ETL-pipeline\data\staging\LST\riksintressen\lst_riksintresse_rorligt_friluftsliv_mb4kap_1plus2.geojson
2025-07-25 01:22:09,362  INFO     [pipeline:623]  üöö Riksintressen - Vindbruk
2025-07-25 01:22:09,362  INFO     [etl.handlers.rest_api:68]  üöÄ Initializing RestApiDownloadHandler for source: Riksintressen - Vindbruk
2025-07-25 01:22:09,362  INFO     [etl.handlers.rest_api:321]  üåê Processing REST API source: 'Riksintressen - Vindbruk' from URL: https://ext-geodata-nationella.lansstyrelsen.se/arcgis/rest/services/LST/lst_lst_riksintressen_vindbruk_4/MapServer
2025-07-25 01:22:09,386  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-nationella.lansstyrelsen.se:443 "GET /arcgis/rest/services/LST/lst_lst_riksintressen_vindbruk_4/MapServer?f=json HTTP/1.1" 200 123
2025-07-25 01:22:09,386  WARNING  [etl.handlers.rest_api:419]  ‚ö†Ô∏è No layers identified or specified to query for source 'Riksintressen - Vindbruk'. Check service metadata and `layer_ids` config.
2025-07-25 01:22:09,388  INFO     [pipeline:623]  üöö LstD F√∂reskrifter
2025-07-25 01:22:09,388  INFO     [etl.handlers.rest_api:68]  üöÄ Initializing RestApiDownloadHandler for source: LstD F√∂reskrifter
2025-07-25 01:22:09,389  INFO     [etl.handlers.rest_api:321]  üåê Processing REST API source: 'LstD F√∂reskrifter' from URL: https://ext-geodata-lokala-visning.lansstyrelsen.se/arcgis/rest/services/LSTD/LstD_Foreskrifter_EXT/MapServer
2025-07-25 01:22:09,390  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): ext-geodata-lokala-visning.lansstyrelsen.se:443
2025-07-25 01:22:09,567  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-lokala-visning.lansstyrelsen.se:443 "GET /arcgis/rest/services/LSTD/LstD_Foreskrifter_EXT/MapServer?f=json HTTP/1.1" 200 None
2025-07-25 01:22:09,568  INFO     [etl.handlers.rest_api:380]  No explicit layer_ids in config for source 'LstD F√∂reskrifter'. Discovering all layers from service metadata.
2025-07-25 01:22:09,569  INFO     [etl.handlers.rest_api:427]  Source 'LstD F√∂reskrifter': Will attempt to query 1 layer(s): ['0']
2025-07-25 01:22:09,569  INFO     [etl.handlers.rest_api:659]  üöö lstd_sjotrafikforeskrifter
2025-07-25 01:22:09,569  DEBUG    [etl.handlers.rest_api:660]  Querying Layer ID: 0 (Sanitized Name: lstd_sjotrafikforeskrifter, Original: LstD Sj√∂trafikf√∂reskrifter) from https://ext-geodata-lokala-visning.lansstyrelsen.se/arcgis/rest/services/LSTD/LstD_Foreskrifter_EXT/MapServer/0/query
2025-07-25 01:22:09,569  DEBUG    [etl.handlers.rest_api:530]  maxRecordCount not found in layer metadata, using default: 5000
2025-07-25 01:22:09,569  DEBUG    [etl.handlers.rest_api:199]  Applying BBOX: 586206,6551160,647910,6610992 (SRID: 3006)
2025-07-25 01:22:09,571  DEBUG    [etl.handlers.rest_api:565]  Fetching page 1 for layer lstd_sjotrafikforeskrifter (offset 0, limit 5000)
2025-07-25 01:22:10,696  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-lokala-visning.lansstyrelsen.se:443 "GET /arcgis/rest/services/LSTD/LstD_Foreskrifter_EXT/MapServer/0/query?where=1%3D1&outFields=%2A&returnGeometry=true&f=geojson&geometry=586206%2C6551160%2C647910%2C6610992&geometryType=esriGeometryEnvelope&inSR=3006&spatialRel=esriSpatialRelIntersects&resultOffset=0&resultRecordCount=5000 HTTP/1.1" 200 None
2025-07-25 01:22:11,991  DEBUG    [etl.handlers.rest_api:279]  üèÅ All features likely retrieved for layer lstd_sjotrafikforeskrifter (less than page limit or server maxRecordCount is 0).
2025-07-25 01:22:12,207  INFO     [etl.handlers.rest_api:298]  ‚úÖ lstd_sjotrafikforeskrifter: 61 features
2025-07-25 01:22:12,207  DEBUG    [etl.handlers.rest_api:299]  üíæ Successfully saved 61 features for layer lstd_sjotrafikforeskrifter to C:\Git\ETL-pipeline\data\staging\LSTD\lstd_foreskrifter\lstd_sjotrafikforeskrifter.geojson
2025-07-25 01:22:12,209  INFO     [pipeline:623]  üöö LstD Fysisk planering
2025-07-25 01:22:12,210  INFO     [etl.handlers.rest_api:68]  üöÄ Initializing RestApiDownloadHandler for source: LstD Fysisk planering
2025-07-25 01:22:12,210  INFO     [etl.handlers.rest_api:321]  üåê Processing REST API source: 'LstD Fysisk planering' from URL: https://ext-geodata-lokala-visning.lansstyrelsen.se/arcgis/rest/services/LSTD/LstD_Fysisk_planering_EXT/MapServer
2025-07-25 01:22:12,249  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-lokala-visning.lansstyrelsen.se:443 "GET /arcgis/rest/services/LSTD/LstD_Fysisk_planering_EXT/MapServer?f=json HTTP/1.1" 200 None
2025-07-25 01:22:12,249  WARNING  [etl.handlers.rest_api:419]  ‚ö†Ô∏è No layers identified or specified to query for source 'LstD Fysisk planering'. Check service metadata and `layer_ids` config.
2025-07-25 01:22:12,250  INFO     [pipeline:623]  üöö LstD Ett rikt odlingslandskap
2025-07-25 01:22:12,250  INFO     [etl.handlers.rest_api:68]  üöÄ Initializing RestApiDownloadHandler for source: LstD Ett rikt odlingslandskap
2025-07-25 01:22:12,250  INFO     [etl.handlers.rest_api:321]  üåê Processing REST API source: 'LstD Ett rikt odlingslandskap' from URL: https://ext-geodata-lokala-visning.lansstyrelsen.se/arcgis/rest/services/LSTD/LstD_GI_Ett_rikt_odlingslandskap_EXT/MapServer
2025-07-25 01:22:13,027  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-lokala-visning.lansstyrelsen.se:443 "GET /arcgis/rest/services/LSTD/LstD_GI_Ett_rikt_odlingslandskap_EXT/MapServer?f=json HTTP/1.1" 200 None
2025-07-25 01:22:13,028  INFO     [etl.handlers.rest_api:346]  Found explicit layer_ids in config: [2, 3, 4, 5, 6] for source 'LstD Ett rikt odlingslandskap'. Processing only these.
2025-07-25 01:22:13,029  INFO     [etl.handlers.rest_api:427]  Source 'LstD Ett rikt odlingslandskap': Will attempt to query 5 layer(s): ['2', '3', '4', '5', '6']
2025-07-25 01:22:13,029  INFO     [etl.handlers.rest_api:447]  üöÄ Starting concurrent download of 5 layers
2025-07-25 01:22:13,029  INFO     [etl.utils.concurrent:86]  Initialized ConcurrentDownloadManager with 5 workers
2025-07-25 01:22:13,030  INFO     [etl.utils.concurrent:261]  Starting concurrent download of 5 layers
2025-07-25 01:22:13,030  INFO     [etl.utils.concurrent:121]  Starting concurrent execution of 5 tasks with 5 workers
2025-07-25 01:22:13,038  INFO     [etl.utils.concurrent:215]  Concurrent execution completed: 0/5 successful (0.0%), avg=0.00s, max=0.00s, total=0.00s
2025-07-25 01:22:13,039  INFO     [etl.handlers.rest_api:480]  üèÅ Concurrent downloads completed: 0 successful, 5 failed
2025-07-25 01:22:13,039  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_LstD GI Betesmark - Exempelanalys - Spridningsl√§nkar mellan kluster - Under 500 m - name 'time' is not defined
2025-07-25 01:22:13,039  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_LstD GI Jordbruksmark - Tv√§rvillkorselement - Ytor - name 'time' is not defined
2025-07-25 01:22:13,039  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_LstD GI V√§rdetrakter naturbetesmark - name 'time' is not defined
2025-07-25 01:22:13,039  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_LstD GI Betesmark - Exempelanalys - Kluster av betesmarker - Buffert 250 m - name 'time' is not defined
2025-07-25 01:22:13,039  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_LstD GI Jordbruksmark - √Ökerholmar - name 'time' is not defined
2025-07-25 01:22:13,039  INFO     [pipeline:623]  üöö LstD Friluftsliv
2025-07-25 01:22:13,041  INFO     [etl.handlers.rest_api:68]  üöÄ Initializing RestApiDownloadHandler for source: LstD Friluftsliv
2025-07-25 01:22:13,041  INFO     [etl.handlers.rest_api:321]  üåê Processing REST API source: 'LstD Friluftsliv' from URL: https://ext-geodata-lokala-visning.lansstyrelsen.se/arcgis/rest/services/LSTD/LstD_GI_Friluftsliv_EXT/MapServer
2025-07-25 01:22:13,083  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-lokala-visning.lansstyrelsen.se:443 "GET /arcgis/rest/services/LSTD/LstD_GI_Friluftsliv_EXT/MapServer?f=json HTTP/1.1" 200 None
2025-07-25 01:22:13,084  INFO     [etl.handlers.rest_api:346]  Found explicit layer_ids in config: [0, 1, 2, 3, 4] for source 'LstD Friluftsliv'. Processing only these.
2025-07-25 01:22:13,085  WARNING  [etl.handlers.rest_api:364]  Layer ID '0' specified in config for source 'LstD Friluftsliv' was not found in the service's layer metadata list. Will attempt to query it using this ID and a placeholder name.
2025-07-25 01:22:13,085  WARNING  [etl.handlers.rest_api:364]  Layer ID '1' specified in config for source 'LstD Friluftsliv' was not found in the service's layer metadata list. Will attempt to query it using this ID and a placeholder name.
2025-07-25 01:22:13,085  WARNING  [etl.handlers.rest_api:364]  Layer ID '2' specified in config for source 'LstD Friluftsliv' was not found in the service's layer metadata list. Will attempt to query it using this ID and a placeholder name.
2025-07-25 01:22:13,085  WARNING  [etl.handlers.rest_api:364]  Layer ID '3' specified in config for source 'LstD Friluftsliv' was not found in the service's layer metadata list. Will attempt to query it using this ID and a placeholder name.
2025-07-25 01:22:13,085  WARNING  [etl.handlers.rest_api:364]  Layer ID '4' specified in config for source 'LstD Friluftsliv' was not found in the service's layer metadata list. Will attempt to query it using this ID and a placeholder name.
2025-07-25 01:22:13,085  INFO     [etl.handlers.rest_api:427]  Source 'LstD Friluftsliv': Will attempt to query 5 layer(s): ['0', '1', '2', '3', '4']
2025-07-25 01:22:13,085  INFO     [etl.handlers.rest_api:447]  üöÄ Starting concurrent download of 5 layers
2025-07-25 01:22:13,085  INFO     [etl.utils.concurrent:261]  Starting concurrent download of 5 layers
2025-07-25 01:22:13,086  INFO     [etl.utils.concurrent:121]  Starting concurrent execution of 5 tasks with 5 workers
2025-07-25 01:22:13,091  INFO     [etl.utils.concurrent:215]  Concurrent execution completed: 0/5 successful (0.0%), avg=0.00s, max=0.00s, total=0.00s
2025-07-25 01:22:13,093  INFO     [etl.handlers.rest_api:480]  üèÅ Concurrent downloads completed: 0 successful, 5 failed
2025-07-25 01:22:13,093  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_layer_0_cfg_only - name 'time' is not defined
2025-07-25 01:22:13,093  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_layer_1_cfg_only - name 'time' is not defined
2025-07-25 01:22:13,093  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_layer_2_cfg_only - name 'time' is not defined
2025-07-25 01:22:13,093  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_layer_3_cfg_only - name 'time' is not defined
2025-07-25 01:22:13,094  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_layer_4_cfg_only - name 'time' is not defined
2025-07-25 01:22:13,094  INFO     [pipeline:623]  üöö LstD God bebyggd milj√∂
2025-07-25 01:22:13,095  INFO     [etl.handlers.rest_api:68]  üöÄ Initializing RestApiDownloadHandler for source: LstD God bebyggd milj√∂
2025-07-25 01:22:13,095  INFO     [etl.handlers.rest_api:321]  üåê Processing REST API source: 'LstD God bebyggd milj√∂' from URL: https://ext-geodata-lokala-visning.lansstyrelsen.se/arcgis/rest/services/LSTD/LstD_GI_God_bebyggd_miljo_EXT/MapServer
2025-07-25 01:22:14,191  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-lokala-visning.lansstyrelsen.se:443 "GET /arcgis/rest/services/LSTD/LstD_GI_God_bebyggd_miljo_EXT/MapServer?f=json HTTP/1.1" 200 None
2025-07-25 01:22:14,192  INFO     [etl.handlers.rest_api:380]  No explicit layer_ids in config for source 'LstD God bebyggd milj√∂'. Discovering all layers from service metadata.
2025-07-25 01:22:14,192  INFO     [etl.handlers.rest_api:427]  Source 'LstD God bebyggd milj√∂': Will attempt to query 1 layer(s): ['0']
2025-07-25 01:22:14,192  INFO     [etl.handlers.rest_api:659]  üöö lstd_gi_opaverkade_omraden_-_avgransning
2025-07-25 01:22:14,192  DEBUG    [etl.handlers.rest_api:660]  Querying Layer ID: 0 (Sanitized Name: lstd_gi_opaverkade_omraden_-_avgransning, Original: LstD GI Op√•verkade omr√•den - Avgr√§nsning) from https://ext-geodata-lokala-visning.lansstyrelsen.se/arcgis/rest/services/LSTD/LstD_GI_God_bebyggd_miljo_EXT/MapServer/0/query
2025-07-25 01:22:14,192  DEBUG    [etl.handlers.rest_api:530]  maxRecordCount not found in layer metadata, using default: 5000
2025-07-25 01:22:14,192  DEBUG    [etl.handlers.rest_api:199]  Applying BBOX: 586206,6551160,647910,6610992 (SRID: 3006)
2025-07-25 01:22:14,193  DEBUG    [etl.handlers.rest_api:565]  Fetching page 1 for layer lstd_gi_opaverkade_omraden_-_avgransning (offset 0, limit 5000)
2025-07-25 01:22:15,086  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-lokala-visning.lansstyrelsen.se:443 "GET /arcgis/rest/services/LSTD/LstD_GI_God_bebyggd_miljo_EXT/MapServer/0/query?where=1%3D1&outFields=%2A&returnGeometry=true&f=geojson&geometry=586206%2C6551160%2C647910%2C6610992&geometryType=esriGeometryEnvelope&inSR=3006&spatialRel=esriSpatialRelIntersects&resultOffset=0&resultRecordCount=5000 HTTP/1.1" 200 None
2025-07-25 01:22:15,176  DEBUG    [etl.handlers.rest_api:279]  üèÅ All features likely retrieved for layer lstd_gi_opaverkade_omraden_-_avgransning (less than page limit or server maxRecordCount is 0).
2025-07-25 01:22:15,201  INFO     [etl.handlers.rest_api:298]  ‚úÖ lstd_gi_opaverkade_omraden_-_avgransning: 10 features
2025-07-25 01:22:15,202  DEBUG    [etl.handlers.rest_api:299]  üíæ Successfully saved 10 features for layer lstd_gi_opaverkade_omraden_-_avgransning to C:\Git\ETL-pipeline\data\staging\LSTD\lstd_god_bebyggd_miljo\lstd_gi_opaverkade_omraden_-_avgransning.geojson
2025-07-25 01:22:15,202  INFO     [pipeline:623]  üöö LstD Hav i balans
2025-07-25 01:22:15,202  INFO     [etl.handlers.rest_api:68]  üöÄ Initializing RestApiDownloadHandler for source: LstD Hav i balans
2025-07-25 01:22:15,203  INFO     [etl.handlers.rest_api:321]  üåê Processing REST API source: 'LstD Hav i balans' from URL: https://ext-geodata-lokala-visning.lansstyrelsen.se/arcgis/rest/services/LSTD/LstD_GI_Hav_i_balans_EXT/MapServer
2025-07-25 01:22:15,272  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-lokala-visning.lansstyrelsen.se:443 "GET /arcgis/rest/services/LSTD/LstD_GI_Hav_i_balans_EXT/MapServer?f=json HTTP/1.1" 200 None
2025-07-25 01:22:15,274  INFO     [etl.handlers.rest_api:380]  No explicit layer_ids in config for source 'LstD Hav i balans'. Discovering all layers from service metadata.
2025-07-25 01:22:15,274  INFO     [etl.handlers.rest_api:427]  Source 'LstD Hav i balans': Will attempt to query 1 layer(s): ['0']
2025-07-25 01:22:15,274  INFO     [etl.handlers.rest_api:659]  üöö lstd_gi_marina_naturvarden_-_inventering
2025-07-25 01:22:15,274  DEBUG    [etl.handlers.rest_api:660]  Querying Layer ID: 0 (Sanitized Name: lstd_gi_marina_naturvarden_-_inventering, Original: LstD GI Marina naturv√§rden - Inventering) from https://ext-geodata-lokala-visning.lansstyrelsen.se/arcgis/rest/services/LSTD/LstD_GI_Hav_i_balans_EXT/MapServer/0/query
2025-07-25 01:22:15,274  DEBUG    [etl.handlers.rest_api:530]  maxRecordCount not found in layer metadata, using default: 5000
2025-07-25 01:22:15,274  DEBUG    [etl.handlers.rest_api:199]  Applying BBOX: 586206,6551160,647910,6610992 (SRID: 3006)
2025-07-25 01:22:15,276  DEBUG    [etl.handlers.rest_api:565]  Fetching page 1 for layer lstd_gi_marina_naturvarden_-_inventering (offset 0, limit 5000)
2025-07-25 01:22:16,032  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-lokala-visning.lansstyrelsen.se:443 "GET /arcgis/rest/services/LSTD/LstD_GI_Hav_i_balans_EXT/MapServer/0/query?where=1%3D1&outFields=%2A&returnGeometry=true&f=geojson&geometry=586206%2C6551160%2C647910%2C6610992&geometryType=esriGeometryEnvelope&inSR=3006&spatialRel=esriSpatialRelIntersects&resultOffset=0&resultRecordCount=5000 HTTP/1.1" 200 58
2025-07-25 01:22:16,034  DEBUG    [etl.handlers.rest_api:253]  ‚ÑπÔ∏è No features returned for layer lstd_gi_marina_naturvarden_-_inventering with current parameters.
2025-07-25 01:22:16,034  INFO     [etl.handlers.rest_api:693]  ‚ÑπÔ∏è lstd_gi_marina_naturvarden_-_inventering: no features
2025-07-25 01:22:16,034  INFO     [pipeline:623]  üöö LstD Levande sj√∂ar och vattendrag
2025-07-25 01:22:16,037  INFO     [etl.handlers.rest_api:68]  üöÄ Initializing RestApiDownloadHandler for source: LstD Levande sj√∂ar och vattendrag
2025-07-25 01:22:16,037  INFO     [etl.handlers.rest_api:321]  üåê Processing REST API source: 'LstD Levande sj√∂ar och vattendrag' from URL: https://ext-geodata-lokala-visning.lansstyrelsen.se/arcgis/rest/services/LSTD/LstD_GI_Levande_sjoar_och_vattendrag_EXT/MapServer
2025-07-25 01:22:16,370  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-lokala-visning.lansstyrelsen.se:443 "GET /arcgis/rest/services/LSTD/LstD_GI_Levande_sjoar_och_vattendrag_EXT/MapServer?f=json HTTP/1.1" 200 None
2025-07-25 01:22:16,371  INFO     [etl.handlers.rest_api:346]  Found explicit layer_ids in config: [2, 3, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17] for source 'LstD Levande sj√∂ar och vattendrag'. Processing only these.
2025-07-25 01:22:16,371  INFO     [etl.handlers.rest_api:427]  Source 'LstD Levande sj√∂ar och vattendrag': Will attempt to query 13 layer(s): ['2', '3', '7', '8', '9', '10', '11', '12', '13', '14', '15', '16', '17']
2025-07-25 01:22:16,371  INFO     [etl.handlers.rest_api:447]  üöÄ Starting concurrent download of 13 layers
2025-07-25 01:22:16,371  INFO     [etl.utils.concurrent:261]  Starting concurrent download of 13 layers
2025-07-25 01:22:16,372  INFO     [etl.utils.concurrent:121]  Starting concurrent execution of 13 tasks with 5 workers
2025-07-25 01:22:16,377  INFO     [etl.utils.concurrent:215]  Concurrent execution completed: 0/13 successful (0.0%), avg=0.00s, max=0.00s, total=0.00s
2025-07-25 01:22:16,377  INFO     [etl.handlers.rest_api:480]  üèÅ Concurrent downloads completed: 0 successful, 13 failed
2025-07-25 01:22:16,378  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_LstD GI S√∂tvatten - Tjockskalig m√•larmussla - name 'time' is not defined
2025-07-25 01:22:16,378  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_LstD GI S√∂tvatten - Kortskottsv√§xter - name 'time' is not defined
2025-07-25 01:22:16,378  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_LstD GI Ansvarsomr√•de s√∂tvatten L√§nsstyrelsen i S√∂dermanlands l√§n - name 'time' is not defined
2025-07-25 01:22:16,378  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_LstD GI V√§rdetrakter Hj√§lmar-, M√§lar- och kustmynnande vattendrag (inkl M√§laren och Hj√§lmaren) - name 'time' is not defined
2025-07-25 01:22:16,378  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_LstD GI V√§rdetrakter Kila√•ns avrinningsomr√•de - name 'time' is not defined
2025-07-25 01:22:16,378  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_LstD GI V√§rdetrakter klarvattensj√∂ar med kortskottsv√§xter - name 'time' is not defined
2025-07-25 01:22:16,378  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_LstD GI V√§rdetrakter malens rike - name 'time' is not defined
2025-07-25 01:22:16,378  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_LstD GI V√§rdetrakter n√§tverk f√∂r tjockskalig m√•larmussla - name 'time' is not defined
2025-07-25 01:22:16,378  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_LstD GI S√∂tvatten - Klarvattensj√∂ar och kortskottsv√§xter - name 'time' is not defined
2025-07-25 01:22:16,378  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_LstD GI S√∂tvatten - Sj√∂ar med r√∂dlistade arter - name 'time' is not defined
2025-07-25 01:22:16,379  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_LstD GI S√∂tvatten - Sj√∂ar med konnektivitetsarter - name 'time' is not defined
2025-07-25 01:22:16,379  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_LstD GI S√∂tvatten - Fosforbeting totalt i kg (omr√•de) - name 'time' is not defined
2025-07-25 01:22:16,379  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_LstD GI S√∂tvatten - Fosforbeting per arealenhet - name 'time' is not defined
2025-07-25 01:22:16,379  INFO     [pipeline:623]  üöö LstD Levande skogar
2025-07-25 01:22:16,380  INFO     [etl.handlers.rest_api:68]  üöÄ Initializing RestApiDownloadHandler for source: LstD Levande skogar
2025-07-25 01:22:16,380  INFO     [etl.handlers.rest_api:321]  üåê Processing REST API source: 'LstD Levande skogar' from URL: https://ext-geodata-lokala-visning.lansstyrelsen.se/arcgis/rest/services/LSTD/LstD_GI_Levande_skogar_EXT/MapServer
2025-07-25 01:22:16,414  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-lokala-visning.lansstyrelsen.se:443 "GET /arcgis/rest/services/LSTD/LstD_GI_Levande_skogar_EXT/MapServer?f=json HTTP/1.1" 200 None
2025-07-25 01:22:16,415  INFO     [etl.handlers.rest_api:346]  Found explicit layer_ids in config: [0] for source 'LstD Levande skogar'. Processing only these.
2025-07-25 01:22:16,415  INFO     [etl.handlers.rest_api:427]  Source 'LstD Levande skogar': Will attempt to query 1 layer(s): ['0']
2025-07-25 01:22:16,415  INFO     [etl.handlers.rest_api:659]  üöö lstd_gi_vardekarnor_adellovmiljoer_inkl_skyddsvarda_trad
2025-07-25 01:22:16,416  DEBUG    [etl.handlers.rest_api:660]  Querying Layer ID: 0 (Sanitized Name: lstd_gi_vardekarnor_adellovmiljoer_inkl_skyddsvarda_trad, Original: LstD GI V√§rdek√§rnor √§dell√∂vmilj√∂er inkl skyddsv√§rda tr√§d) from https://ext-geodata-lokala-visning.lansstyrelsen.se/arcgis/rest/services/LSTD/LstD_GI_Levande_skogar_EXT/MapServer/0/query
2025-07-25 01:22:16,416  DEBUG    [etl.handlers.rest_api:530]  maxRecordCount not found in layer metadata, using default: 5000
2025-07-25 01:22:16,416  DEBUG    [etl.handlers.rest_api:199]  Applying BBOX: 586206,6551160,647910,6610992 (SRID: 3006)
2025-07-25 01:22:16,418  DEBUG    [etl.handlers.rest_api:565]  Fetching page 1 for layer lstd_gi_vardekarnor_adellovmiljoer_inkl_skyddsvarda_trad (offset 0, limit 5000)
2025-07-25 01:22:18,656  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-lokala-visning.lansstyrelsen.se:443 "GET /arcgis/rest/services/LSTD/LstD_GI_Levande_skogar_EXT/MapServer/0/query?where=1%3D1&outFields=%2A&returnGeometry=true&f=geojson&geometry=586206%2C6551160%2C647910%2C6610992&geometryType=esriGeometryEnvelope&inSR=3006&spatialRel=esriSpatialRelIntersects&resultOffset=0&resultRecordCount=5000 HTTP/1.1" 200 None
2025-07-25 01:22:19,757  DEBUG    [etl.handlers.rest_api:270]  ‚ö†Ô∏è Exceeded transfer limit for layer lstd_gi_vardekarnor_adellovmiljoer_inkl_skyddsvarda_trad, fetching next page.
2025-07-25 01:22:19,757  DEBUG    [etl.handlers.rest_api:565]  Fetching page 2 for layer lstd_gi_vardekarnor_adellovmiljoer_inkl_skyddsvarda_trad (offset 2000, limit 5000)
2025-07-25 01:22:21,828  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-lokala-visning.lansstyrelsen.se:443 "GET /arcgis/rest/services/LSTD/LstD_GI_Levande_skogar_EXT/MapServer/0/query?where=1%3D1&outFields=%2A&returnGeometry=true&f=geojson&geometry=586206%2C6551160%2C647910%2C6610992&geometryType=esriGeometryEnvelope&inSR=3006&spatialRel=esriSpatialRelIntersects&resultOffset=2000&resultRecordCount=5000 HTTP/1.1" 200 None
2025-07-25 01:22:31,008  DEBUG    [etl.handlers.rest_api:279]  üèÅ All features likely retrieved for layer lstd_gi_vardekarnor_adellovmiljoer_inkl_skyddsvarda_trad (less than page limit or server maxRecordCount is 0).
2025-07-25 01:22:33,675  INFO     [etl.handlers.rest_api:298]  ‚úÖ lstd_gi_vardekarnor_adellovmiljoer_inkl_skyddsvarda_trad: 2783 features
2025-07-25 01:22:33,675  DEBUG    [etl.handlers.rest_api:299]  üíæ Successfully saved 2783 features for layer lstd_gi_vardekarnor_adellovmiljoer_inkl_skyddsvarda_trad to C:\Git\ETL-pipeline\data\staging\LSTD\lstd_levande_skogar\lstd_gi_vardekarnor_adellovmiljoer_inkl_skyddsvarda_trad.geojson
2025-07-25 01:22:33,692  INFO     [pipeline:623]  üöö LstD Klimat
2025-07-25 01:22:33,692  INFO     [etl.handlers.rest_api:68]  üöÄ Initializing RestApiDownloadHandler for source: LstD Klimat
2025-07-25 01:22:33,692  INFO     [etl.handlers.rest_api:321]  üåê Processing REST API source: 'LstD Klimat' from URL: https://ext-geodata-lokala-visning.lansstyrelsen.se/arcgis/rest/services/LSTD/LstD_Klimat_EXT/MapServer
2025-07-25 01:22:33,767  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-lokala-visning.lansstyrelsen.se:443 "GET /arcgis/rest/services/LSTD/LstD_Klimat_EXT/MapServer?f=json HTTP/1.1" 200 None
2025-07-25 01:22:33,769  INFO     [etl.handlers.rest_api:346]  Found explicit layer_ids in config: [2, 3, 4, 5, 6] for source 'LstD Klimat'. Processing only these.
2025-07-25 01:22:33,769  INFO     [etl.handlers.rest_api:427]  Source 'LstD Klimat': Will attempt to query 5 layer(s): ['2', '3', '4', '5', '6']
2025-07-25 01:22:33,770  INFO     [etl.handlers.rest_api:447]  üöÄ Starting concurrent download of 5 layers
2025-07-25 01:22:33,770  INFO     [etl.utils.concurrent:261]  Starting concurrent download of 5 layers
2025-07-25 01:22:33,771  INFO     [etl.utils.concurrent:121]  Starting concurrent execution of 5 tasks with 5 workers
2025-07-25 01:22:33,776  INFO     [etl.utils.concurrent:215]  Concurrent execution completed: 0/5 successful (0.0%), avg=0.00s, max=0.00s, total=0.00s
2025-07-25 01:22:33,776  INFO     [etl.handlers.rest_api:480]  üèÅ Concurrent downloads completed: 0 successful, 5 failed
2025-07-25 01:22:33,776  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_LstD Klimatanpassning - Rekommenderad l√§gsta grundl√§ggningsniv√• f√∂r ny bebyggelse - M√§laren - name 'time' is not defined
2025-07-25 01:22:33,777  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_LstD Klimatanpassning - Kust√∂versv√§mning - HHW10 2012 - name 'time' is not defined
2025-07-25 01:22:33,777  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_LstD Klimatanpassning - Kust√∂versv√§mning - HHW100 2012 - name 'time' is not defined
2025-07-25 01:22:33,777  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_LstD Klimatanpassning - Kust√∂versv√§mning - HHW10 2100 - name 'time' is not defined
2025-07-25 01:22:33,777  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_LstD Klimatanpassning - Kust√∂versv√§mning - HHW100 2100 - name 'time' is not defined
2025-07-25 01:22:33,777  INFO     [pipeline:623]  üöö LstD Kulturmilj√∂
2025-07-25 01:22:33,778  INFO     [etl.handlers.rest_api:68]  üöÄ Initializing RestApiDownloadHandler for source: LstD Kulturmilj√∂
2025-07-25 01:22:33,778  INFO     [etl.handlers.rest_api:321]  üåê Processing REST API source: 'LstD Kulturmilj√∂' from URL: https://ext-geodata-lokala-visning.lansstyrelsen.se/arcgis/rest/services/LSTD/LstD_Kulturmiljo_EXT/MapServer
2025-07-25 01:22:33,815  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-lokala-visning.lansstyrelsen.se:443 "GET /arcgis/rest/services/LSTD/LstD_Kulturmiljo_EXT/MapServer?f=json HTTP/1.1" 200 None
2025-07-25 01:22:33,816  INFO     [etl.handlers.rest_api:346]  Found explicit layer_ids in config: [1] for source 'LstD Kulturmilj√∂'. Processing only these.
2025-07-25 01:22:33,816  INFO     [etl.handlers.rest_api:427]  Source 'LstD Kulturmilj√∂': Will attempt to query 1 layer(s): ['1']
2025-07-25 01:22:33,817  INFO     [etl.handlers.rest_api:659]  üöö lstd_anmalningsplikt_enligt_kml_3_6
2025-07-25 01:22:33,817  DEBUG    [etl.handlers.rest_api:660]  Querying Layer ID: 1 (Sanitized Name: lstd_anmalningsplikt_enligt_kml_3_6, Original: LstD Anm√§lningsplikt enligt KML 3_6) from https://ext-geodata-lokala-visning.lansstyrelsen.se/arcgis/rest/services/LSTD/LstD_Kulturmiljo_EXT/MapServer/1/query
2025-07-25 01:22:33,817  DEBUG    [etl.handlers.rest_api:530]  maxRecordCount not found in layer metadata, using default: 5000
2025-07-25 01:22:33,817  DEBUG    [etl.handlers.rest_api:199]  Applying BBOX: 586206,6551160,647910,6610992 (SRID: 3006)
2025-07-25 01:22:33,818  DEBUG    [etl.handlers.rest_api:565]  Fetching page 1 for layer lstd_anmalningsplikt_enligt_kml_3_6 (offset 0, limit 5000)
2025-07-25 01:22:35,792  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-lokala-visning.lansstyrelsen.se:443 "GET /arcgis/rest/services/LSTD/LstD_Kulturmiljo_EXT/MapServer/1/query?where=1%3D1&outFields=%2A&returnGeometry=true&f=geojson&geometry=586206%2C6551160%2C647910%2C6610992&geometryType=esriGeometryEnvelope&inSR=3006&spatialRel=esriSpatialRelIntersects&resultOffset=0&resultRecordCount=5000 HTTP/1.1" 200 1348
2025-07-25 01:22:35,795  DEBUG    [etl.handlers.rest_api:279]  üèÅ All features likely retrieved for layer lstd_anmalningsplikt_enligt_kml_3_6 (less than page limit or server maxRecordCount is 0).
2025-07-25 01:22:35,811  INFO     [etl.handlers.rest_api:298]  ‚úÖ lstd_anmalningsplikt_enligt_kml_3_6: 68 features
2025-07-25 01:22:35,812  DEBUG    [etl.handlers.rest_api:299]  üíæ Successfully saved 68 features for layer lstd_anmalningsplikt_enligt_kml_3_6 to C:\Git\ETL-pipeline\data\staging\LSTD\lstd_kulturmiljo\lstd_anmalningsplikt_enligt_kml_3_6.geojson
2025-07-25 01:22:35,812  INFO     [pipeline:623]  üöö LstD Markavvattning
2025-07-25 01:22:35,813  INFO     [etl.handlers.rest_api:68]  üöÄ Initializing RestApiDownloadHandler for source: LstD Markavvattning
2025-07-25 01:22:35,813  INFO     [etl.handlers.rest_api:321]  üåê Processing REST API source: 'LstD Markavvattning' from URL: https://ext-geodata-lokala-visning.lansstyrelsen.se/arcgis/rest/services/LSTD/LstD_Markavvattning_EXT/MapServer
2025-07-25 01:22:35,851  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-lokala-visning.lansstyrelsen.se:443 "GET /arcgis/rest/services/LSTD/LstD_Markavvattning_EXT/MapServer?f=json HTTP/1.1" 200 None
2025-07-25 01:22:35,853  INFO     [etl.handlers.rest_api:346]  Found explicit layer_ids in config: [2, 3, 4, 5, 6] for source 'LstD Markavvattning'. Processing only these.
2025-07-25 01:22:35,853  INFO     [etl.handlers.rest_api:427]  Source 'LstD Markavvattning': Will attempt to query 5 layer(s): ['2', '3', '4', '5', '6']
2025-07-25 01:22:35,853  INFO     [etl.handlers.rest_api:447]  üöÄ Starting concurrent download of 5 layers
2025-07-25 01:22:35,853  INFO     [etl.utils.concurrent:261]  Starting concurrent download of 5 layers
2025-07-25 01:22:35,854  INFO     [etl.utils.concurrent:121]  Starting concurrent execution of 5 tasks with 5 workers
2025-07-25 01:22:35,860  INFO     [etl.utils.concurrent:215]  Concurrent execution completed: 0/5 successful (0.0%), avg=0.00s, max=0.00s, total=0.00s
2025-07-25 01:22:35,861  INFO     [etl.handlers.rest_api:480]  üèÅ Concurrent downloads completed: 0 successful, 5 failed
2025-07-25 01:22:35,861  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_LstD Markavvattningsf√∂retag - B√•tnadsomr√•de - Yta - name 'time' is not defined
2025-07-25 01:22:35,861  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_LstD Lantbruksn√§mnden Markavvattning - Dikningsregister - name 'time' is not defined
2025-07-25 01:22:35,861  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_LstD Lantbruksn√§mnden Markavvattning - T√§ckdikningsregister - name 'time' is not defined
2025-07-25 01:22:35,861  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_LstD Lantbruksn√§mnden Markavvattning - Blandat arkivmaterial - name 'time' is not defined
2025-07-25 01:22:35,861  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_LstD LM Markavvattning - Vattenf√∂rr√§ttningar f√∂re 1935 - name 'time' is not defined
2025-07-25 01:22:35,861  INFO     [pipeline:623]  üöö LstD Markstabilitet
2025-07-25 01:22:35,862  INFO     [etl.handlers.rest_api:68]  üöÄ Initializing RestApiDownloadHandler for source: LstD Markstabilitet
2025-07-25 01:22:35,863  INFO     [etl.handlers.rest_api:321]  üåê Processing REST API source: 'LstD Markstabilitet' from URL: https://ext-geodata-lokala-visning.lansstyrelsen.se/arcgis/rest/services/LSTD/LstD_Markstabilitet_EXT/MapServer
2025-07-25 01:22:36,812  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-lokala-visning.lansstyrelsen.se:443 "GET /arcgis/rest/services/LSTD/LstD_Markstabilitet_EXT/MapServer?f=json HTTP/1.1" 200 None
2025-07-25 01:22:36,813  INFO     [etl.handlers.rest_api:380]  No explicit layer_ids in config for source 'LstD Markstabilitet'. Discovering all layers from service metadata.
2025-07-25 01:22:36,813  INFO     [etl.handlers.rest_api:427]  Source 'LstD Markstabilitet': Will attempt to query 1 layer(s): ['0']
2025-07-25 01:22:36,813  INFO     [etl.handlers.rest_api:659]  üöö lstd_msb_oversiktlig_stabilitetskartering_-_90-talet_-_finkorniga_jordarter
2025-07-25 01:22:36,814  DEBUG    [etl.handlers.rest_api:660]  Querying Layer ID: 0 (Sanitized Name: lstd_msb_oversiktlig_stabilitetskartering_-_90-talet_-_finkorniga_jordarter, Original: LstD MSB √ñversiktlig stabilitetskartering - 90-talet - Finkorniga jordarter) from https://ext-geodata-lokala-visning.lansstyrelsen.se/arcgis/rest/services/LSTD/LstD_Markstabilitet_EXT/MapServer/0/query
2025-07-25 01:22:36,814  DEBUG    [etl.handlers.rest_api:530]  maxRecordCount not found in layer metadata, using default: 5000
2025-07-25 01:22:36,814  DEBUG    [etl.handlers.rest_api:199]  Applying BBOX: 586206,6551160,647910,6610992 (SRID: 3006)
2025-07-25 01:22:36,816  DEBUG    [etl.handlers.rest_api:565]  Fetching page 1 for layer lstd_msb_oversiktlig_stabilitetskartering_-_90-talet_-_finkorniga_jordarter (offset 0, limit 5000)
2025-07-25 01:22:37,668  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-lokala-visning.lansstyrelsen.se:443 "GET /arcgis/rest/services/LSTD/LstD_Markstabilitet_EXT/MapServer/0/query?where=1%3D1&outFields=%2A&returnGeometry=true&f=geojson&geometry=586206%2C6551160%2C647910%2C6610992&geometryType=esriGeometryEnvelope&inSR=3006&spatialRel=esriSpatialRelIntersects&resultOffset=0&resultRecordCount=5000 HTTP/1.1" 200 None
2025-07-25 01:22:38,223  DEBUG    [etl.handlers.rest_api:279]  üèÅ All features likely retrieved for layer lstd_msb_oversiktlig_stabilitetskartering_-_90-talet_-_finkorniga_jordarter (less than page limit or server maxRecordCount is 0).
2025-07-25 01:22:38,366  INFO     [etl.handlers.rest_api:298]  ‚úÖ lstd_msb_oversiktlig_stabilitetskartering_-_90-talet_-_finkorniga_jordarter: 52 features
2025-07-25 01:22:38,366  DEBUG    [etl.handlers.rest_api:299]  üíæ Successfully saved 52 features for layer lstd_msb_oversiktlig_stabilitetskartering_-_90-talet_-_finkorniga_jordarter to C:\Git\ETL-pipeline\data\staging\LSTD\lstd_markstabilitet\lstd_msb_oversiktlig_stabilitetskartering_-_90-talet_-_finkorniga_jordarter.geojson
2025-07-25 01:22:38,367  INFO     [pipeline:623]  üöö LstD Naturkartl√§ggning
2025-07-25 01:22:38,368  INFO     [etl.handlers.rest_api:68]  üöÄ Initializing RestApiDownloadHandler for source: LstD Naturkartl√§ggning
2025-07-25 01:22:38,368  INFO     [etl.handlers.rest_api:321]  üåê Processing REST API source: 'LstD Naturkartl√§ggning' from URL: https://ext-geodata-lokala-visning.lansstyrelsen.se/arcgis/rest/services/LSTD/LstD_Naturkartlaggning_EXT/MapServer
2025-07-25 01:22:39,359  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-lokala-visning.lansstyrelsen.se:443 "GET /arcgis/rest/services/LSTD/LstD_Naturkartlaggning_EXT/MapServer?f=json HTTP/1.1" 200 None
2025-07-25 01:22:39,360  INFO     [etl.handlers.rest_api:380]  No explicit layer_ids in config for source 'LstD Naturkartl√§ggning'. Discovering all layers from service metadata.
2025-07-25 01:22:39,360  INFO     [etl.handlers.rest_api:427]  Source 'LstD Naturkartl√§ggning': Will attempt to query 1 layer(s): ['0']
2025-07-25 01:22:39,361  INFO     [etl.handlers.rest_api:659]  üöö lstd_sormlands_natur_-_naturvardsprogram_1991
2025-07-25 01:22:39,361  DEBUG    [etl.handlers.rest_api:660]  Querying Layer ID: 0 (Sanitized Name: lstd_sormlands_natur_-_naturvardsprogram_1991, Original: LstD S√∂rmlands natur - Naturv√•rdsprogram 1991) from https://ext-geodata-lokala-visning.lansstyrelsen.se/arcgis/rest/services/LSTD/LstD_Naturkartlaggning_EXT/MapServer/0/query
2025-07-25 01:22:39,361  DEBUG    [etl.handlers.rest_api:530]  maxRecordCount not found in layer metadata, using default: 5000
2025-07-25 01:22:39,361  DEBUG    [etl.handlers.rest_api:199]  Applying BBOX: 586206,6551160,647910,6610992 (SRID: 3006)
2025-07-25 01:22:39,364  DEBUG    [etl.handlers.rest_api:565]  Fetching page 1 for layer lstd_sormlands_natur_-_naturvardsprogram_1991 (offset 0, limit 5000)
2025-07-25 01:22:40,134  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-lokala-visning.lansstyrelsen.se:443 "GET /arcgis/rest/services/LSTD/LstD_Naturkartlaggning_EXT/MapServer/0/query?where=1%3D1&outFields=%2A&returnGeometry=true&f=geojson&geometry=586206%2C6551160%2C647910%2C6610992&geometryType=esriGeometryEnvelope&inSR=3006&spatialRel=esriSpatialRelIntersects&resultOffset=0&resultRecordCount=5000 HTTP/1.1" 200 None
2025-07-25 01:22:41,104  DEBUG    [etl.handlers.rest_api:279]  üèÅ All features likely retrieved for layer lstd_sormlands_natur_-_naturvardsprogram_1991 (less than page limit or server maxRecordCount is 0).
2025-07-25 01:22:41,279  INFO     [etl.handlers.rest_api:298]  ‚úÖ lstd_sormlands_natur_-_naturvardsprogram_1991: 245 features
2025-07-25 01:22:41,280  DEBUG    [etl.handlers.rest_api:299]  üíæ Successfully saved 245 features for layer lstd_sormlands_natur_-_naturvardsprogram_1991 to C:\Git\ETL-pipeline\data\staging\LSTD\lstd_naturkartlaggning\lstd_sormlands_natur_-_naturvardsprogram_1991.geojson
2025-07-25 01:22:41,281  INFO     [pipeline:623]  üöö LstD Skog och tr√§d
2025-07-25 01:22:41,282  INFO     [etl.handlers.rest_api:68]  üöÄ Initializing RestApiDownloadHandler for source: LstD Skog och tr√§d
2025-07-25 01:22:41,282  INFO     [etl.handlers.rest_api:321]  üåê Processing REST API source: 'LstD Skog och tr√§d' from URL: https://ext-geodata-lokala-visning.lansstyrelsen.se/arcgis/rest/services/LSTD/LstD_Skog_och_trad_EXT/MapServer
2025-07-25 01:22:42,440  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-lokala-visning.lansstyrelsen.se:443 "GET /arcgis/rest/services/LSTD/LstD_Skog_och_trad_EXT/MapServer?f=json HTTP/1.1" 200 None
2025-07-25 01:22:42,441  INFO     [etl.handlers.rest_api:380]  No explicit layer_ids in config for source 'LstD Skog och tr√§d'. Discovering all layers from service metadata.
2025-07-25 01:22:42,442  INFO     [etl.handlers.rest_api:427]  Source 'LstD Skog och tr√§d': Will attempt to query 3 layer(s): ['0', '1', '2']
2025-07-25 01:22:42,443  INFO     [etl.handlers.rest_api:447]  üöÄ Starting concurrent download of 3 layers
2025-07-25 01:22:42,443  INFO     [etl.utils.concurrent:261]  Starting concurrent download of 3 layers
2025-07-25 01:22:42,443  INFO     [etl.utils.concurrent:121]  Starting concurrent execution of 3 tasks with 5 workers
2025-07-25 01:22:42,448  INFO     [etl.utils.concurrent:215]  Concurrent execution completed: 0/3 successful (0.0%), avg=0.00s, max=0.00s, total=0.00s
2025-07-25 01:22:42,449  INFO     [etl.handlers.rest_api:480]  üèÅ Concurrent downloads completed: 0 successful, 3 failed
2025-07-25 01:22:42,449  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_LstD All√©inventering - name 'time' is not defined
2025-07-25 01:22:42,449  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_LstD K√§llskogar (extern) - name 'time' is not defined
2025-07-25 01:22:42,449  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_LstD Skogliga v√§rdetrakter - name 'time' is not defined
2025-07-25 01:22:42,450  INFO     [pipeline:623]  üöö LstD GI V√§rdetrakter v√•tmark
2025-07-25 01:22:42,451  INFO     [etl.handlers.rest_api:68]  üöÄ Initializing RestApiDownloadHandler for source: LstD GI V√§rdetrakter v√•tmark
2025-07-25 01:22:42,451  INFO     [etl.handlers.rest_api:321]  üåê Processing REST API source: 'LstD GI V√§rdetrakter v√•tmark' from URL: https://ext-geodata-lokala-visning.lansstyrelsen.se/arcgis/rest/services/LSTD/LstD_GI_Myllrande_vatmarker_EXT/MapServer
2025-07-25 01:22:42,491  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-lokala-visning.lansstyrelsen.se:443 "GET /arcgis/rest/services/LSTD/LstD_GI_Myllrande_vatmarker_EXT/MapServer?f=json HTTP/1.1" 200 None
2025-07-25 01:22:42,492  INFO     [etl.handlers.rest_api:380]  No explicit layer_ids in config for source 'LstD GI V√§rdetrakter v√•tmark'. Discovering all layers from service metadata.
2025-07-25 01:22:42,493  INFO     [etl.handlers.rest_api:427]  Source 'LstD GI V√§rdetrakter v√•tmark': Will attempt to query 1 layer(s): ['0']
2025-07-25 01:22:42,493  INFO     [etl.handlers.rest_api:659]  üöö lstd_gi_vardetrakter_vatmark
2025-07-25 01:22:42,494  DEBUG    [etl.handlers.rest_api:660]  Querying Layer ID: 0 (Sanitized Name: lstd_gi_vardetrakter_vatmark, Original: LstD GI V√§rdetrakter v√•tmark) from https://ext-geodata-lokala-visning.lansstyrelsen.se/arcgis/rest/services/LSTD/LstD_GI_Myllrande_vatmarker_EXT/MapServer/0/query
2025-07-25 01:22:42,494  DEBUG    [etl.handlers.rest_api:530]  maxRecordCount not found in layer metadata, using default: 5000
2025-07-25 01:22:42,494  DEBUG    [etl.handlers.rest_api:199]  Applying BBOX: 586206,6551160,647910,6610992 (SRID: 3006)
2025-07-25 01:22:42,495  DEBUG    [etl.handlers.rest_api:565]  Fetching page 1 for layer lstd_gi_vardetrakter_vatmark (offset 0, limit 5000)
2025-07-25 01:22:44,054  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-lokala-visning.lansstyrelsen.se:443 "GET /arcgis/rest/services/LSTD/LstD_GI_Myllrande_vatmarker_EXT/MapServer/0/query?where=1%3D1&outFields=%2A&returnGeometry=true&f=geojson&geometry=586206%2C6551160%2C647910%2C6610992&geometryType=esriGeometryEnvelope&inSR=3006&spatialRel=esriSpatialRelIntersects&resultOffset=0&resultRecordCount=5000 HTTP/1.1" 200 None
2025-07-25 01:22:44,104  DEBUG    [etl.handlers.rest_api:279]  üèÅ All features likely retrieved for layer lstd_gi_vardetrakter_vatmark (less than page limit or server maxRecordCount is 0).
2025-07-25 01:22:44,114  INFO     [etl.handlers.rest_api:298]  ‚úÖ lstd_gi_vardetrakter_vatmark: 7 features
2025-07-25 01:22:44,114  DEBUG    [etl.handlers.rest_api:299]  üíæ Successfully saved 7 features for layer lstd_gi_vardetrakter_vatmark to C:\Git\ETL-pipeline\data\staging\LSTD\lstd_gi_vardetrakter_vatmark\lstd_gi_vardetrakter_vatmark.geojson
2025-07-25 01:22:44,114  INFO     [pipeline:623]  üöö LstD Strandskydd
2025-07-25 01:22:44,115  INFO     [etl.handlers.rest_api:68]  üöÄ Initializing RestApiDownloadHandler for source: LstD Strandskydd
2025-07-25 01:22:44,115  INFO     [etl.handlers.rest_api:321]  üåê Processing REST API source: 'LstD Strandskydd' from URL: https://ext-geodata-lokala-visning.lansstyrelsen.se/arcgis/rest/services/LSTD/LstD_Strandskydd_EXT/MapServer
2025-07-25 01:22:44,162  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-lokala-visning.lansstyrelsen.se:443 "GET /arcgis/rest/services/LSTD/LstD_Strandskydd_EXT/MapServer?f=json HTTP/1.1" 200 None
2025-07-25 01:22:44,163  INFO     [etl.handlers.rest_api:380]  No explicit layer_ids in config for source 'LstD Strandskydd'. Discovering all layers from service metadata.
2025-07-25 01:22:44,163  INFO     [etl.handlers.rest_api:427]  Source 'LstD Strandskydd': Will attempt to query 4 layer(s): ['0', '1', '2', '3']
2025-07-25 01:22:44,163  INFO     [etl.handlers.rest_api:447]  üöÄ Starting concurrent download of 4 layers
2025-07-25 01:22:44,163  INFO     [etl.utils.concurrent:261]  Starting concurrent download of 4 layers
2025-07-25 01:22:44,163  INFO     [etl.utils.concurrent:121]  Starting concurrent execution of 4 tasks with 5 workers
2025-07-25 01:22:44,166  INFO     [etl.utils.concurrent:215]  Concurrent execution completed: 0/4 successful (0.0%), avg=0.00s, max=0.00s, total=0.00s
2025-07-25 01:22:44,166  INFO     [etl.handlers.rest_api:480]  üèÅ Concurrent downloads completed: 0 successful, 4 failed
2025-07-25 01:22:44,166  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_LstD LM Strandskydd - Generellt - name 'time' is not defined
2025-07-25 01:22:44,166  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_LstD Strandskydd - Upph√§vt i enskilda fall - name 'time' is not defined
2025-07-25 01:22:44,166  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_LstD Strandskydd - Utvidgat - name 'time' is not defined
2025-07-25 01:22:44,166  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_LstD Strandskydd - Utvidgat - Kartblad M√§laren Str√§ngn√§s - name 'time' is not defined
2025-07-25 01:22:44,166  INFO     [pipeline:623]  üöö Skyddsrum
2025-07-25 01:22:44,167  INFO     [etl.handlers.file:162]  üîó Single resource download mode for 'Skyddsrum' from URL: https://inspire.msb.se/nedladdning/filer/shape/Skyddsrum.zip
2025-07-25 01:22:44,297  INFO     [etl.utils.http:110]      Derived filename by unquoting URL basename ('https://inspire.msb.se/nedladdning/filer/shape/Skyddsrum.zip'): Skyddsrum.zip
2025-07-25 01:22:44,299  DEBUG    [etl.handlers.file:247]  Attempting to download: https://inspire.msb.se/nedladdning/filer/shape/Skyddsrum.zip 
    -> to local file: skyddsrum.zip 
    -> staging dir: data\staging\MSB\skyddsrum
2025-07-25 01:22:44,300  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): inspire.msb.se:443
2025-07-25 01:22:44,408  DEBUG    [urllib3.connectionpool:544]  https://inspire.msb.se:443 "HEAD /nedladdning/filer/shape/Skyddsrum.zip HTTP/1.1" 200 0
2025-07-25 01:22:44,408  INFO     [etl.utils.io:44]  ‚¨á skyddsrum.zip (3.1 MB)
2025-07-25 01:22:44,409  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): inspire.msb.se:443
2025-07-25 01:22:44,506  DEBUG    [urllib3.connectionpool:544]  https://inspire.msb.se:443 "GET /nedladdning/filer/shape/Skyddsrum.zip HTTP/1.1" 200 3243792
2025-07-25 01:22:44,676  INFO     [etl.utils.io:82]  ‚úÖ skyddsrum.zip
2025-07-25 01:22:44,677  INFO     [etl.handlers.file:278]  Determined staged_data_type: 'shapefile_collection' for downloaded file 'skyddsrum.zip'
2025-07-25 01:22:44,677  INFO     [etl.utils.io:88]  üì¶ Extracting skyddsrum.zip ‚Üí C:\Git\ETL-pipeline\data\staging\MSB\skyddsrum
2025-07-25 01:22:44,927  INFO     [etl.handlers.file:351]  ‚ûï Extracted and staged archive skyddsrum.zip to data\staging\MSB\skyddsrum
2025-07-25 01:22:44,928  INFO     [pipeline:623]  üöö Riksintresse Kulturmilj√∂v√•rd MB3kap6
2025-07-25 01:22:44,928  INFO     [etl.handlers.atom_feed:41]  üåê Reading Atom feed for source 'Riksintresse Kulturmilj√∂v√•rd MB3kap6' from URL: https://ext-dokument.lansstyrelsen.se/gemensamt/geodata/ATOM/ATOM_raa.RAA_RI_kulturmiljovard_MB3kap6.xml
2025-07-25 01:22:44,930  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): ext-dokument.lansstyrelsen.se:443
2025-07-25 01:22:45,060  DEBUG    [urllib3.connectionpool:544]  https://ext-dokument.lansstyrelsen.se:443 "HEAD /gemensamt/geodata/ATOM/ATOM_raa.RAA_RI_kulturmiljovard_MB3kap6.xml HTTP/1.1" 200 0
2025-07-25 01:22:45,061  INFO     [etl.utils.io:44]  ‚¨á riksintresse_kulturmiljovard_mb3kap6_feed.xml (1.1 KB)
2025-07-25 01:22:45,063  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): ext-dokument.lansstyrelsen.se:443
2025-07-25 01:22:45,212  DEBUG    [urllib3.connectionpool:544]  https://ext-dokument.lansstyrelsen.se:443 "GET /gemensamt/geodata/ATOM/ATOM_raa.RAA_RI_kulturmiljovard_MB3kap6.xml HTTP/1.1" 200 1082
2025-07-25 01:22:45,215  INFO     [etl.utils.io:82]  ‚úÖ riksintresse_kulturmiljovard_mb3kap6_feed.xml
2025-07-25 01:22:45,217  INFO     [etl.handlers.atom_feed:77]  Target staging directory for all content from Atom source 'Riksintresse Kulturmilj√∂v√•rd MB3kap6': data\staging\RAA\riksintresse_kulturmiljovard_mb3kap6
2025-07-25 01:22:45,217  INFO     [etl.handlers.atom_feed:105]  Found linked resource in Atom feed for 'Riksintresse Kulturmilj√∂v√•rd MB3kap6': https://ext-dokument.lansstyrelsen.se/gemensamt/geodata/ShapeExport/raa.RAA_RI_kulturmiljovard_MB3kap6.zip
2025-07-25 01:22:45,346  INFO     [etl.utils.http:110]      Derived filename by unquoting URL basename ('https://ext-dokument.lansstyrelsen.se/gemensamt/geodata/ShapeExport/raa.RAA_RI_kulturmiljovard_MB3kap6.zip'): raa.RAA_RI_kulturmiljovard_MB3kap6.zip
2025-07-25 01:22:45,346  INFO     [etl.handlers.atom_feed:157]  Attempting to download linked resource: https://ext-dokument.lansstyrelsen.se/gemensamt/geodata/ShapeExport/raa.RAA_RI_kulturmiljovard_MB3kap6.zip 
        -> to local file: raa_raa_ri_kulturmiljovard_mb3kap6.zip
2025-07-25 01:22:45,348  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): ext-dokument.lansstyrelsen.se:443
2025-07-25 01:22:45,451  DEBUG    [urllib3.connectionpool:544]  https://ext-dokument.lansstyrelsen.se:443 "HEAD /gemensamt/geodata/ShapeExport/raa.RAA_RI_kulturmiljovard_MB3kap6.zip HTTP/1.1" 200 0
2025-07-25 01:22:45,452  INFO     [etl.utils.io:44]  ‚¨á raa_raa_ri_kulturmiljovard_mb3kap6.zip (5.4 MB)
2025-07-25 01:22:45,453  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): ext-dokument.lansstyrelsen.se:443
2025-07-25 01:22:45,552  DEBUG    [urllib3.connectionpool:544]  https://ext-dokument.lansstyrelsen.se:443 "GET /gemensamt/geodata/ShapeExport/raa.RAA_RI_kulturmiljovard_MB3kap6.zip HTTP/1.1" 200 5687784
2025-07-25 01:22:46,167  INFO     [etl.utils.io:82]  ‚úÖ raa_raa_ri_kulturmiljovard_mb3kap6.zip
2025-07-25 01:22:46,168  INFO     [etl.handlers.atom_feed:168]  Downloaded file 'raa_raa_ri_kulturmiljovard_mb3kap6.zip' is a ZIP archive. Extracting...
2025-07-25 01:22:46,168  INFO     [etl.utils.io:88]  üì¶ Extracting raa_raa_ri_kulturmiljovard_mb3kap6.zip ‚Üí C:\Git\ETL-pipeline\data\staging\RAA\riksintresse_kulturmiljovard_mb3kap6
2025-07-25 01:22:46,248  INFO     [etl.handlers.atom_feed:173]  ‚ûï Extracted and staged archive raa_raa_ri_kulturmiljovard_mb3kap6.zip into data\staging\RAA\riksintresse_kulturmiljovard_mb3kap6
2025-07-25 01:22:46,248  INFO     [etl.handlers.atom_feed:180]  Source 'Riksintresse Kulturmilj√∂v√•rd MB3kap6' expects a GPKG. Searching in extracted contents of raa_raa_ri_kulturmiljovard_mb3kap6.zip...
2025-07-25 01:22:46,250  INFO     [etl.handlers.atom_feed:197]  Renaming/moving extracted GPKG 'raa.RAA_RI_kulturmiljovard_MB3kap6.gpkg' to 'riksintresse_kulturmiljovard_mb3kap6.gpkg'
2025-07-25 01:22:46,251  INFO     [etl.handlers.atom_feed:207]  ‚úÖ Successfully staged GPKG 'riksintresse_kulturmiljovard_mb3kap6.gpkg' for source 'Riksintresse Kulturmilj√∂v√•rd MB3kap6'.
2025-07-25 01:22:46,251  INFO     [pipeline:623]  üöö RAA Byggnader Sverige
2025-07-25 01:22:46,252  INFO     [etl.handlers.file:162]  üîó Single resource download mode for 'RAA Byggnader Sverige' from URL: https://pub.raa.se/nedladdning/datauttag/bebyggelse/byggnader_kulthist_inv/byggnader_sverige.gpkg
2025-07-25 01:22:46,370  INFO     [etl.utils.http:110]      Derived filename by unquoting URL basename ('https://pub.raa.se/nedladdning/datauttag/bebyggelse/byggnader_kulthist_inv/byggnader_sverige.gpkg'): byggnader_sverige.gpkg
2025-07-25 01:22:46,372  DEBUG    [etl.handlers.file:247]  Attempting to download: https://pub.raa.se/nedladdning/datauttag/bebyggelse/byggnader_kulthist_inv/byggnader_sverige.gpkg 
    -> to local file: raa_byggnader_sverige.gpkg 
    -> staging dir: data\staging\RAA\raa_byggnader_sverige
2025-07-25 01:22:46,373  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): pub.raa.se:443
2025-07-25 01:22:46,453  DEBUG    [urllib3.connectionpool:544]  https://pub.raa.se:443 "HEAD /nedladdning/datauttag/bebyggelse/byggnader_kulthist_inv/byggnader_sverige.gpkg HTTP/1.1" 200 0
2025-07-25 01:22:46,453  INFO     [etl.utils.io:44]  ‚¨á raa_byggnader_sverige.gpkg (75.4 MB)
2025-07-25 01:22:46,454  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): pub.raa.se:443
2025-07-25 01:22:46,522  DEBUG    [urllib3.connectionpool:544]  https://pub.raa.se:443 "GET /nedladdning/datauttag/bebyggelse/byggnader_kulthist_inv/byggnader_sverige.gpkg HTTP/1.1" 200 79097856
2025-07-25 01:22:51,533  DEBUG    [etl.utils.io:66]  üìä raa_byggnader_sverige.gpkg: 24.9% (18.8 MB / 75.4 MB)
2025-07-25 01:22:56,535  DEBUG    [etl.utils.io:66]  üìä raa_byggnader_sverige.gpkg: 49.9% (37.7 MB / 75.4 MB)
2025-07-25 01:23:01,537  DEBUG    [etl.utils.io:66]  üìä raa_byggnader_sverige.gpkg: 74.0% (55.9 MB / 75.4 MB)
2025-07-25 01:23:06,541  DEBUG    [etl.utils.io:66]  üìä raa_byggnader_sverige.gpkg: 99.4% (74.9 MB / 75.4 MB)
2025-07-25 01:23:06,651  INFO     [etl.utils.io:82]  ‚úÖ raa_byggnader_sverige.gpkg
2025-07-25 01:23:06,652  INFO     [etl.handlers.file:278]  Determined staged_data_type: 'gpkg' for downloaded file 'raa_byggnader_sverige.gpkg'
2025-07-25 01:23:06,723  INFO     [etl.handlers.file:292]  ‚ûï Staged GPKG raa_byggnader_sverige.gpkg to data\staging\RAA\raa_byggnader_sverige\raa_byggnader_sverige.gpkg
2025-07-25 01:23:06,724  INFO     [pipeline:623]  üöö Enskilda och statliga byggnadsminnen, skyddsomr√•den
2025-07-25 01:23:06,725  INFO     [etl.handlers.file:162]  üîó Single resource download mode for 'Enskilda och statliga byggnadsminnen, skyddsomr√•den' from URL: https://pub.raa.se/nedladdning/datauttag/bebyggelse/byggnadsminne_skyddsomr/skyddsomrade_byggnadsminne_sverige.gpkg
2025-07-25 01:23:06,868  INFO     [etl.utils.http:110]      Derived filename by unquoting URL basename ('https://pub.raa.se/nedladdning/datauttag/bebyggelse/byggnadsminne_skyddsomr/skyddsomrade_byggnadsminne_sverige.gpkg'): skyddsomrade_byggnadsminne_sverige.gpkg
2025-07-25 01:23:06,872  DEBUG    [etl.handlers.file:247]  Attempting to download: https://pub.raa.se/nedladdning/datauttag/bebyggelse/byggnadsminne_skyddsomr/skyddsomrade_byggnadsminne_sverige.gpkg 
    -> to local file: enskilda_och_statliga_byggnadsminnen_skyddsomraden.gpkg 
    -> staging dir: data\staging\RAA\enskilda_och_statliga_byggnadsminnen_skyddsomraden
2025-07-25 01:23:06,876  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): pub.raa.se:443
2025-07-25 01:23:06,953  DEBUG    [urllib3.connectionpool:544]  https://pub.raa.se:443 "HEAD /nedladdning/datauttag/bebyggelse/byggnadsminne_skyddsomr/skyddsomrade_byggnadsminne_sverige.gpkg HTTP/1.1" 200 0
2025-07-25 01:23:06,954  INFO     [etl.utils.io:44]  ‚¨á enskilda_och_statliga_byggnadsminnen_skyddsomraden.gpkg (7.5 MB)
2025-07-25 01:23:06,956  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): pub.raa.se:443
2025-07-25 01:23:07,048  DEBUG    [urllib3.connectionpool:544]  https://pub.raa.se:443 "GET /nedladdning/datauttag/bebyggelse/byggnadsminne_skyddsomr/skyddsomrade_byggnadsminne_sverige.gpkg HTTP/1.1" 200 7843840
2025-07-25 01:23:08,917  INFO     [etl.utils.io:82]  ‚úÖ enskilda_och_statliga_byggnadsminnen_skyddsomraden.gpkg
2025-07-25 01:23:08,918  INFO     [etl.handlers.file:278]  Determined staged_data_type: 'gpkg' for downloaded file 'enskilda_och_statliga_byggnadsminnen_skyddsomraden.gpkg'
2025-07-25 01:23:08,937  INFO     [etl.handlers.file:292]  ‚ûï Staged GPKG enskilda_och_statliga_byggnadsminnen_skyddsomraden.gpkg to data\staging\RAA\enskilda_och_statliga_byggnadsminnen_skyddsomraden\enskilda_och_statliga_byggnadsminnen_skyddsomraden.gpkg
2025-07-25 01:23:08,938  INFO     [pipeline:623]  üöö Kulturhistoriska l√§mningar, S√∂dermanland
2025-07-25 01:23:08,939  INFO     [etl.handlers.file:162]  üîó Single resource download mode for 'Kulturhistoriska l√§mningar, S√∂dermanland' from URL: https://pub.raa.se/nedladdning/datauttag/lamningar/lan/l%C3%A4mningar_l%C3%A4n_s%C3%B6dermanland.gpkg
2025-07-25 01:23:09,062  INFO     [etl.utils.http:110]      Derived filename by unquoting URL basename ('https://pub.raa.se/nedladdning/datauttag/lamningar/lan/l%C3%A4mningar_l%C3%A4n_s%C3%B6dermanland.gpkg'): l√§mningar_l√§n_s√∂dermanland.gpkg
2025-07-25 01:23:09,064  DEBUG    [etl.handlers.file:247]  Attempting to download: https://pub.raa.se/nedladdning/datauttag/lamningar/lan/l%C3%A4mningar_l%C3%A4n_s%C3%B6dermanland.gpkg 
    -> to local file: kulturhistoriska_lamningar_sodermanland.gpkg 
    -> staging dir: data\staging\RAA\kulturhistoriska_lamningar_sodermanland
2025-07-25 01:23:09,066  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): pub.raa.se:443
2025-07-25 01:23:09,154  DEBUG    [urllib3.connectionpool:544]  https://pub.raa.se:443 "HEAD /nedladdning/datauttag/lamningar/lan/l%C3%A4mningar_l%C3%A4n_s%C3%B6dermanland.gpkg HTTP/1.1" 200 0
2025-07-25 01:23:09,157  INFO     [etl.utils.io:44]  ‚¨á kulturhistoriska_lamningar_sodermanland.gpkg (41.1 MB)
2025-07-25 01:23:09,160  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): pub.raa.se:443
2025-07-25 01:23:09,257  DEBUG    [urllib3.connectionpool:544]  https://pub.raa.se:443 "GET /nedladdning/datauttag/lamningar/lan/l%C3%A4mningar_l%C3%A4n_s%C3%B6dermanland.gpkg HTTP/1.1" 200 43102208
2025-07-25 01:23:14,260  DEBUG    [etl.utils.io:66]  üìä kulturhistoriska_lamningar_sodermanland.gpkg: 47.9% (19.7 MB / 41.1 MB)
2025-07-25 01:23:19,262  DEBUG    [etl.utils.io:66]  üìä kulturhistoriska_lamningar_sodermanland.gpkg: 95.3% (39.2 MB / 41.1 MB)
2025-07-25 01:23:19,738  INFO     [etl.utils.io:82]  ‚úÖ kulturhistoriska_lamningar_sodermanland.gpkg
2025-07-25 01:23:19,738  INFO     [etl.handlers.file:278]  Determined staged_data_type: 'gpkg' for downloaded file 'kulturhistoriska_lamningar_sodermanland.gpkg'
2025-07-25 01:23:19,764  INFO     [etl.handlers.file:292]  ‚ûï Staged GPKG kulturhistoriska_lamningar_sodermanland.gpkg to data\staging\RAA\kulturhistoriska_lamningar_sodermanland\kulturhistoriska_lamningar_sodermanland.gpkg
2025-07-25 01:23:19,765  INFO     [pipeline:623]  üöö RAA V√§rldsarv i Sverige
2025-07-25 01:23:19,765  INFO     [etl.handlers.file:162]  üîó Single resource download mode for 'RAA V√§rldsarv i Sverige' from URL: https://pub.raa.se/nedladdning/datauttag/varldsarv/varldsarv_sverige.gpkg
2025-07-25 01:23:19,896  INFO     [etl.utils.http:110]      Derived filename by unquoting URL basename ('https://pub.raa.se/nedladdning/datauttag/varldsarv/varldsarv_sverige.gpkg'): varldsarv_sverige.gpkg
2025-07-25 01:23:19,899  DEBUG    [etl.handlers.file:247]  Attempting to download: https://pub.raa.se/nedladdning/datauttag/varldsarv/varldsarv_sverige.gpkg 
    -> to local file: raa_varldsarv_i_sverige.gpkg 
    -> staging dir: data\staging\RAA\raa_varldsarv_i_sverige
2025-07-25 01:23:19,903  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): pub.raa.se:443
2025-07-25 01:23:19,967  DEBUG    [urllib3.connectionpool:544]  https://pub.raa.se:443 "HEAD /nedladdning/datauttag/varldsarv/varldsarv_sverige.gpkg HTTP/1.1" 200 0
2025-07-25 01:23:19,968  INFO     [etl.utils.io:44]  ‚¨á raa_varldsarv_i_sverige.gpkg (520.0 KB)
2025-07-25 01:23:19,971  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): pub.raa.se:443
2025-07-25 01:23:20,049  DEBUG    [urllib3.connectionpool:544]  https://pub.raa.se:443 "GET /nedladdning/datauttag/varldsarv/varldsarv_sverige.gpkg HTTP/1.1" 200 532480
2025-07-25 01:23:20,220  INFO     [etl.utils.io:82]  ‚úÖ raa_varldsarv_i_sverige.gpkg
2025-07-25 01:23:20,221  INFO     [etl.handlers.file:278]  Determined staged_data_type: 'gpkg' for downloaded file 'raa_varldsarv_i_sverige.gpkg'
2025-07-25 01:23:20,230  INFO     [etl.handlers.file:292]  ‚ûï Staged GPKG raa_varldsarv_i_sverige.gpkg to data\staging\RAA\raa_varldsarv_i_sverige\raa_varldsarv_i_sverige.gpkg
2025-07-25 01:23:20,230  INFO     [pipeline:623]  üöö Intr√§ffade skred, ras och √∂vriga jordr√∂relser (skreddatabas)
2025-07-25 01:23:20,231  INFO     [etl.handlers.file:162]  üîó Single resource download mode for 'Intr√§ffade skred, ras och √∂vriga jordr√∂relser (skreddatabas)' from URL: https://gis.sgi.se/dokument/geodatasezip/SGI_Skreddatabas_ver2.zip
2025-07-25 01:23:20,417  INFO     [etl.utils.http:110]      Derived filename by unquoting URL basename ('https://gis.sgi.se/dokument/geodatasezip/SGI_Skreddatabas_ver2.zip'): SGI_Skreddatabas_ver2.zip
2025-07-25 01:23:20,420  DEBUG    [etl.handlers.file:247]  Attempting to download: https://gis.sgi.se/dokument/geodatasezip/SGI_Skreddatabas_ver2.zip 
    -> to local file: intraffade_skred_ras_och_ovriga_jordrorelser_skreddatabas.zip 
    -> staging dir: data\staging\SGI\intraffade_skred_ras_och_ovriga_jordrorelser_skreddatabas
2025-07-25 01:23:20,422  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): gis.sgi.se:443
2025-07-25 01:23:20,545  DEBUG    [urllib3.connectionpool:544]  https://gis.sgi.se:443 "HEAD /dokument/geodatasezip/SGI_Skreddatabas_ver2.zip HTTP/1.1" 200 0
2025-07-25 01:23:20,545  INFO     [etl.utils.io:44]  ‚¨á intraffade_skred_ras_och_ovriga_jordrorelser_skreddatabas.zip (188.2 KB)
2025-07-25 01:23:20,546  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): gis.sgi.se:443
2025-07-25 01:23:20,670  DEBUG    [urllib3.connectionpool:544]  https://gis.sgi.se:443 "GET /dokument/geodatasezip/SGI_Skreddatabas_ver2.zip HTTP/1.1" 200 192714
2025-07-25 01:23:20,903  INFO     [etl.utils.io:82]  ‚úÖ intraffade_skred_ras_och_ovriga_jordrorelser_skreddatabas.zip
2025-07-25 01:23:20,904  INFO     [etl.handlers.file:278]  Determined staged_data_type: 'shapefile_collection' for downloaded file 'intraffade_skred_ras_och_ovriga_jordrorelser_skreddatabas.zip'
2025-07-25 01:23:20,904  INFO     [etl.utils.io:88]  üì¶ Extracting intraffade_skred_ras_och_ovriga_jordrorelser_skreddatabas.zip ‚Üí C:\Git\ETL-pipeline\data\staging\SGI\intraffade_skred_ras_och_ovriga_jordrorelser_skreddatabas
2025-07-25 01:23:20,932  INFO     [etl.handlers.file:351]  ‚ûï Extracted and staged archive intraffade_skred_ras_och_ovriga_jordrorelser_skreddatabas.zip to data\staging\SGI\intraffade_skred_ras_och_ovriga_jordrorelser_skreddatabas
2025-07-25 01:23:20,933  INFO     [pipeline:623]  üöö Erosion
2025-07-25 01:23:20,933  INFO     [etl.handlers.ogc_api:103]      üó∫Ô∏è BBOX configured for source 'Erosion': 16.5008129,59.0906713,17.6220373,59.6050281 (CRS: CRS84 (default))
2025-07-25 01:23:20,933  INFO     [etl.handlers.ogc_api:178]  üåê Processing OGC API source: 'Erosion' from URL: https://api.sgu.se/oppnadata/stranderosion-kust/ogc/features/v1/collections/
2025-07-25 01:23:20,933  INFO     [etl.handlers.ogc_api:352]  üîÑ Discovering collections from: https://api.sgu.se/oppnadata/stranderosion-kust/ogc/features/v1/collections
2025-07-25 01:23:20,934  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): api.sgu.se:443
2025-07-25 01:23:21,071  DEBUG    [urllib3.connectionpool:544]  https://api.sgu.se:443 "GET /oppnadata/stranderosion-kust/ogc/features/v1/collections HTTP/1.1" 200 None
2025-07-25 01:23:21,110  INFO     [etl.handlers.ogc_api:386]  ‚úÖ Discovered 14 collections for source 'Erosion'
2025-07-25 01:23:21,110  DEBUG    [etl.handlers.ogc_api:392]      - Collection ID: aktiv-erosion, Title: Observerad aktiv erosion
2025-07-25 01:23:21,110  DEBUG    [etl.handlers.ogc_api:392]      - Collection ID: bottendynamik, Title: Bottendynamik
2025-07-25 01:23:21,110  DEBUG    [etl.handlers.ogc_api:392]      - Collection ID: bottenmaterial, Title: Bottenmaterial
2025-07-25 01:23:21,110  DEBUG    [etl.handlers.ogc_api:392]      - Collection ID: dynfotsforandring, Title: Dynfotens l√§gesf√∂r√§ndring
2025-07-25 01:23:21,110  DEBUG    [etl.handlers.ogc_api:392]      - Collection ID: erosionsforhallande-plus1m, Title: Erosionsf√∂rh√•llanden vid en framtida havsniv√•h√∂jning p√• ca 1 m
2025-07-25 01:23:21,110  DEBUG    [etl.handlers.ogc_api:392]      - Collection ID: erosionsforhallande-strand, Title: Erosionf√∂rh√•llanden p√• stranden
2025-07-25 01:23:21,110  DEBUG    [etl.handlers.ogc_api:392]      - Collection ID: erosionsindex, Title: Erosionsk√§nslighet baserat p√• index
2025-07-25 01:23:21,110  DEBUG    [etl.handlers.ogc_api:392]      - Collection ID: erosionsskydd, Title: Erosionsskydd
2025-07-25 01:23:21,110  DEBUG    [etl.handlers.ogc_api:392]      - Collection ID: oversvamningsskydd, Title: √ñversv√§mningsskydd
2025-07-25 01:23:21,111  DEBUG    [etl.handlers.ogc_api:392]      - Collection ID: sedimentsystem-grans, Title: Sedimentsystem, gr√§nslinje
2025-07-25 01:23:21,111  DEBUG    [etl.handlers.ogc_api:392]      - Collection ID: sedimenttransport-kustparallell, Title: Modellerad potentiell kustparallell sedimenttransport
2025-07-25 01:23:21,111  DEBUG    [etl.handlers.ogc_api:392]      - Collection ID: stranddynamik, Title: Stranddynamik
2025-07-25 01:23:21,111  DEBUG    [etl.handlers.ogc_api:392]      - Collection ID: strandmaterial, Title: Strandmaterial
2025-07-25 01:23:21,111  DEBUG    [etl.handlers.ogc_api:392]      - Collection ID: vattenyta-prognos, Title: Vattenyta vid h√∂jda havsniv√•er
2025-07-25 01:23:21,111  INFO     [etl.handlers.ogc_api:315]  üîß Filtering for configured collections: ['aktiv-erosion'] for source 'Erosion'
2025-07-25 01:23:21,111  INFO     [etl.handlers.ogc_api:212]  üì¶ Processing collection: aktiv-erosion (Source: Erosion)
2025-07-25 01:23:21,111  INFO     [etl.handlers.ogc_api:427]      üì¶ Fetching collection: aktiv-erosion (Observerad aktiv erosion)
2025-07-25 01:23:21,111  INFO     [etl.handlers.ogc_api:443]      üó∫Ô∏è Applied BBOX to items URL for collection 'aktiv-erosion'
2025-07-25 01:23:21,112  INFO     [etl.handlers.ogc_api:459]          üìÑ Fetching page 1 for collection 'aktiv-erosion' from https://api.sgu.se/oppnadata/stranderosion-kust/ogc/features/v1/collections/aktiv-erosion/items?f=application%2Fvnd.ogc.fg%2Bjson&bbox=16.5008129%2C59.0906713%2C17.6220373%2C59.6050281
2025-07-25 01:23:21,112  DEBUG    [etl.handlers.ogc_api:739]          Requesting OGC API page: https://api.sgu.se/oppnadata/stranderosion-kust/ogc/features/v1/collections/aktiv-erosion/items?f=application%2Fvnd.ogc.fg%2Bjson&bbox=16.5008129%2C59.0906713%2C17.6220373%2C59.6050281
2025-07-25 01:23:21,216  DEBUG    [urllib3.connectionpool:544]  https://api.sgu.se:443 "GET /oppnadata/stranderosion-kust/ogc/features/v1/collections/aktiv-erosion/items?f=application%2Fvnd.ogc.fg%2Bjson&bbox=16.5008129%2C59.0906713%2C17.6220373%2C59.6050281 HTTP/1.1" 500 137
2025-07-25 01:23:21,216  DEBUG    [urllib3.util.retry:521]  Incremented Retry for (url='/oppnadata/stranderosion-kust/ogc/features/v1/collections/aktiv-erosion/items?f=application%2Fvnd.ogc.fg%2Bjson&bbox=16.5008129%2C59.0906713%2C17.6220373%2C59.6050281'): Retry(total=1, connect=None, read=None, redirect=None, status=None)
2025-07-25 01:23:21,217  DEBUG    [urllib3.connectionpool:941]  Retry: /oppnadata/stranderosion-kust/ogc/features/v1/collections/aktiv-erosion/items?f=application%2Fvnd.ogc.fg%2Bjson&bbox=16.5008129%2C59.0906713%2C17.6220373%2C59.6050281
2025-07-25 01:23:21,294  DEBUG    [urllib3.connectionpool:544]  https://api.sgu.se:443 "GET /oppnadata/stranderosion-kust/ogc/features/v1/collections/aktiv-erosion/items?f=application%2Fvnd.ogc.fg%2Bjson&bbox=16.5008129%2C59.0906713%2C17.6220373%2C59.6050281 HTTP/1.1" 500 137
2025-07-25 01:23:21,295  DEBUG    [urllib3.util.retry:521]  Incremented Retry for (url='/oppnadata/stranderosion-kust/ogc/features/v1/collections/aktiv-erosion/items?f=application%2Fvnd.ogc.fg%2Bjson&bbox=16.5008129%2C59.0906713%2C17.6220373%2C59.6050281'): Retry(total=0, connect=None, read=None, redirect=None, status=None)
2025-07-25 01:23:21,896  DEBUG    [urllib3.connectionpool:941]  Retry: /oppnadata/stranderosion-kust/ogc/features/v1/collections/aktiv-erosion/items?f=application%2Fvnd.ogc.fg%2Bjson&bbox=16.5008129%2C59.0906713%2C17.6220373%2C59.6050281
2025-07-25 01:23:21,965  DEBUG    [urllib3.connectionpool:544]  https://api.sgu.se:443 "GET /oppnadata/stranderosion-kust/ogc/features/v1/collections/aktiv-erosion/items?f=application%2Fvnd.ogc.fg%2Bjson&bbox=16.5008129%2C59.0906713%2C17.6220373%2C59.6050281 HTTP/1.1" 500 137
2025-07-25 01:23:21,966  ERROR    [etl.handlers.ogc_api:236]  ‚ùå Error during OGC API processing for source Erosion: 'context'
urllib3.exceptions.ResponseError: too many 500 error responses

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\kije\AppData\Roaming\Python\Python311\site-packages\requests\adapters.py", line 667, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "C:\Users\kije\AppData\Local\ESRI\conda\envs\arcgispro-py3-dev\Lib\site-packages\urllib3\connectionpool.py", line 942, in urlopen
    return self.urlopen(
           ^^^^^^^^^^^^^
  File "C:\Users\kije\AppData\Local\ESRI\conda\envs\arcgispro-py3-dev\Lib\site-packages\urllib3\connectionpool.py", line 942, in urlopen
    return self.urlopen(
           ^^^^^^^^^^^^^
  File "C:\Users\kije\AppData\Local\ESRI\conda\envs\arcgispro-py3-dev\Lib\site-packages\urllib3\connectionpool.py", line 932, in urlopen
    retries = retries.increment(method, url, response=response, _pool=self)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\kije\AppData\Local\ESRI\conda\envs\arcgispro-py3-dev\Lib\site-packages\urllib3\util\retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='api.sgu.se', port=443): Max retries exceeded with url: /oppnadata/stranderosion-kust/ogc/features/v1/collections/aktiv-erosion/items?f=application%2Fvnd.ogc.fg%2Bjson&bbox=16.5008129%2C59.0906713%2C17.6220373%2C59.6050281 (Caused by ResponseError('too many 500 error responses'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Git\ETL-pipeline\etl\handlers\ogc_api.py", line 740, in _fetch_page
    response = self.session.get(url, timeout=DEFAULT_TIMEOUT)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\kije\AppData\Roaming\Python\Python311\site-packages\requests\sessions.py", line 602, in get
    return self.request("GET", url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Git\ETL-pipeline\etl\utils\http_session.py", line 133, in request_with_timeout
    return original_request(method, url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\kije\AppData\Roaming\Python\Python311\site-packages\requests\sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\kije\AppData\Roaming\Python\Python311\site-packages\requests\sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\kije\AppData\Roaming\Python\Python311\site-packages\requests\adapters.py", line 691, in send
    raise RetryError(e, request=request)
requests.exceptions.RetryError: HTTPSConnectionPool(host='api.sgu.se', port=443): Max retries exceeded with url: /oppnadata/stranderosion-kust/ogc/features/v1/collections/aktiv-erosion/items?f=application%2Fvnd.ogc.fg%2Bjson&bbox=16.5008129%2C59.0906713%2C17.6220373%2C59.6050281 (Caused by ResponseError('too many 500 error responses'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Git\ETL-pipeline\etl\utils\retry.py", line 464, in wrapper
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Git\ETL-pipeline\etl\handlers\ogc_api.py", line 791, in _fetch_page
    raise NetworkError(
          ^^^^^^^^^^^^^
  File "C:\Git\ETL-pipeline\etl\exceptions\core.py", line 144, in __init__
    super().__init__(
KeyError: 'context'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Git\ETL-pipeline\etl\handlers\ogc_api.py", line 217, in fetch
    if self._fetch_collection(collection_data):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Git\ETL-pipeline\etl\handlers\ogc_api.py", line 466, in _fetch_collection
    features_page, next_url_from_page = self._fetch_page(next_url)
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Git\ETL-pipeline\etl\utils\retry.py", line 482, in wrapper
    classified_error = classify_exception(e)
                       ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Git\ETL-pipeline\etl\exceptions\core.py", line 456, in classify_exception
    return SystemError(
           ^^^^^^^^^^^^
  File "C:\Git\ETL-pipeline\etl\exceptions\core.py", line 228, in __init__
    super().__init__(
KeyError: 'context'
2025-07-25 01:23:21,981  INFO     [pipeline:623]  üöö Brunnar
2025-07-25 01:23:21,982  INFO     [etl.handlers.ogc_api:103]      üó∫Ô∏è BBOX configured for source 'Brunnar': 16.5008129,59.0906713,17.6220373,59.6050281 (CRS: CRS84 (default))
2025-07-25 01:23:21,982  INFO     [etl.handlers.ogc_api:178]  üåê Processing OGC API source: 'Brunnar' from URL: https://api.sgu.se/oppnadata/brunnar/ogc/features/v1/collections/
2025-07-25 01:23:21,982  INFO     [etl.handlers.ogc_api:352]  üîÑ Discovering collections from: https://api.sgu.se/oppnadata/brunnar/ogc/features/v1/collections
2025-07-25 01:23:21,986  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): api.sgu.se:443
2025-07-25 01:23:22,099  DEBUG    [urllib3.connectionpool:544]  https://api.sgu.se:443 "GET /oppnadata/brunnar/ogc/features/v1/collections HTTP/1.1" 200 None
2025-07-25 01:23:22,101  INFO     [etl.handlers.ogc_api:386]  ‚úÖ Discovered 2 collections for source 'Brunnar'
2025-07-25 01:23:22,101  DEBUG    [etl.handlers.ogc_api:392]      - Collection ID: brunnar, Title: Brunnar
2025-07-25 01:23:22,101  DEBUG    [etl.handlers.ogc_api:392]      - Collection ID: brunnar-lager, Title: Brunnars lagerf√∂ljder
2025-07-25 01:23:22,101  INFO     [etl.handlers.ogc_api:315]  üîß Filtering for configured collections: ['brunnar'] for source 'Brunnar'
2025-07-25 01:23:22,101  INFO     [etl.handlers.ogc_api:212]  üì¶ Processing collection: brunnar (Source: Brunnar)
2025-07-25 01:23:22,102  INFO     [etl.handlers.ogc_api:427]      üì¶ Fetching collection: brunnar (Brunnar)
2025-07-25 01:23:22,102  INFO     [etl.handlers.ogc_api:443]      üó∫Ô∏è Applied BBOX to items URL for collection 'brunnar'
2025-07-25 01:23:22,103  INFO     [etl.handlers.ogc_api:459]          üìÑ Fetching page 1 for collection 'brunnar' from https://api.sgu.se/oppnadata/brunnar/ogc/features/v1/collections/brunnar/items?f=application%2Fvnd.ogc.fg%2Bjson&bbox=16.5008129%2C59.0906713%2C17.6220373%2C59.6050281
2025-07-25 01:23:22,104  DEBUG    [etl.handlers.ogc_api:739]          Requesting OGC API page: https://api.sgu.se/oppnadata/brunnar/ogc/features/v1/collections/brunnar/items?f=application%2Fvnd.ogc.fg%2Bjson&bbox=16.5008129%2C59.0906713%2C17.6220373%2C59.6050281
2025-07-25 01:23:31,609  DEBUG    [urllib3.connectionpool:544]  https://api.sgu.se:443 "GET /oppnadata/brunnar/ogc/features/v1/collections/brunnar/items?f=application%2Fvnd.ogc.fg%2Bjson&bbox=16.5008129%2C59.0906713%2C17.6220373%2C59.6050281 HTTP/1.1" 200 None
2025-07-25 01:23:32,601  INFO     [etl.handlers.ogc_api:477]          ‚úÖ Retrieved 19579 features on this page (total: 19579)
2025-07-25 01:23:32,602  WARNING  [etl.handlers.ogc_api:584]      ‚ö†Ô∏è SGU service for collection 'brunnar' reports EPSG:3006, but coordinates appear to be WGS84. Using EPSG:4326.
2025-07-25 01:23:32,602  INFO     [etl.handlers.ogc_api:592]      üó∫Ô∏è Using CRS from storageCrs for collection 'brunnar': EPSG:4326
2025-07-25 01:23:34,044  INFO     [etl.handlers.ogc_api:519]      üíæ Saved 19579 features for collection 'brunnar' to data\staging\SGU\brunnar\brunnar.geojson
2025-07-25 01:23:34,057  INFO     [pipeline:623]  üöö Jordskred och raviner
2025-07-25 01:23:34,057  INFO     [etl.handlers.ogc_api:103]      üó∫Ô∏è BBOX configured for source 'Jordskred och raviner': 16.5008129,59.0906713,17.6220373,59.6050281 (CRS: CRS84 (default))
2025-07-25 01:23:34,057  INFO     [etl.handlers.ogc_api:178]  üåê Processing OGC API source: 'Jordskred och raviner' from URL: https://api.sgu.se/oppnadata/jordskred-raviner/ogc/features/v1/collections/
2025-07-25 01:23:34,058  INFO     [etl.handlers.ogc_api:352]  üîÑ Discovering collections from: https://api.sgu.se/oppnadata/jordskred-raviner/ogc/features/v1/collections
2025-07-25 01:23:34,059  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): api.sgu.se:443
2025-07-25 01:23:34,150  DEBUG    [urllib3.connectionpool:544]  https://api.sgu.se:443 "GET /oppnadata/jordskred-raviner/ogc/features/v1/collections HTTP/1.1" 200 None
2025-07-25 01:23:34,152  INFO     [etl.handlers.ogc_api:386]  ‚úÖ Discovered 2 collections for source 'Jordskred och raviner'
2025-07-25 01:23:34,152  DEBUG    [etl.handlers.ogc_api:392]      - Collection ID: inventerat-omrade, Title: Inventerat omr√•de
2025-07-25 01:23:34,152  DEBUG    [etl.handlers.ogc_api:392]      - Collection ID: jordskred-raviner, Title: Jordskred och raviner
2025-07-25 01:23:34,152  INFO     [etl.handlers.ogc_api:315]  üîß Filtering for configured collections: ['jordskred-raviner'] for source 'Jordskred och raviner'
2025-07-25 01:23:34,152  INFO     [etl.handlers.ogc_api:212]  üì¶ Processing collection: jordskred-raviner (Source: Jordskred och raviner)
2025-07-25 01:23:34,153  INFO     [etl.handlers.ogc_api:427]      üì¶ Fetching collection: jordskred-raviner (Jordskred och raviner)
2025-07-25 01:23:34,153  INFO     [etl.handlers.ogc_api:443]      üó∫Ô∏è Applied BBOX to items URL for collection 'jordskred-raviner'
2025-07-25 01:23:34,154  INFO     [etl.handlers.ogc_api:459]          üìÑ Fetching page 1 for collection 'jordskred-raviner' from https://api.sgu.se/oppnadata/jordskred-raviner/ogc/features/v1/collections/jordskred-raviner/items?f=application%2Fvnd.ogc.fg%2Bjson&bbox=16.5008129%2C59.0906713%2C17.6220373%2C59.6050281
2025-07-25 01:23:34,155  DEBUG    [etl.handlers.ogc_api:739]          Requesting OGC API page: https://api.sgu.se/oppnadata/jordskred-raviner/ogc/features/v1/collections/jordskred-raviner/items?f=application%2Fvnd.ogc.fg%2Bjson&bbox=16.5008129%2C59.0906713%2C17.6220373%2C59.6050281
2025-07-25 01:23:34,279  DEBUG    [urllib3.connectionpool:544]  https://api.sgu.se:443 "GET /oppnadata/jordskred-raviner/ogc/features/v1/collections/jordskred-raviner/items?f=application%2Fvnd.ogc.fg%2Bjson&bbox=16.5008129%2C59.0906713%2C17.6220373%2C59.6050281 HTTP/1.1" 200 None
2025-07-25 01:23:34,298  INFO     [etl.handlers.ogc_api:477]          ‚úÖ Retrieved 48 features on this page (total: 48)
2025-07-25 01:23:34,298  WARNING  [etl.handlers.ogc_api:584]      ‚ö†Ô∏è SGU service for collection 'jordskred-raviner' reports EPSG:3006, but coordinates appear to be WGS84. Using EPSG:4326.
2025-07-25 01:23:34,299  INFO     [etl.handlers.ogc_api:592]      üó∫Ô∏è Using CRS from storageCrs for collection 'jordskred-raviner': EPSG:4326
2025-07-25 01:23:34,314  INFO     [etl.handlers.ogc_api:519]      üíæ Saved 48 features for collection 'jordskred-raviner' to data\staging\SGU\jordskred_och_raviner\jordskred-raviner.geojson
2025-07-25 01:23:34,315  INFO     [pipeline:623]  üöö Grus Krossberg
2025-07-25 01:23:34,315  INFO     [etl.handlers.ogc_api:103]      üó∫Ô∏è BBOX configured for source 'Grus Krossberg': 16.5008129,59.0906713,17.6220373,59.6050281 (CRS: CRS84 (default))
2025-07-25 01:23:34,315  INFO     [etl.handlers.ogc_api:178]  üåê Processing OGC API source: 'Grus Krossberg' from URL: https://api.sgu.se/oppnadata/grus-krossberg/ogc/features/v1/collections
2025-07-25 01:23:34,315  INFO     [etl.handlers.ogc_api:352]  üîÑ Discovering collections from: https://api.sgu.se/oppnadata/grus-krossberg/ogc/features/v1/collections
2025-07-25 01:23:34,317  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): api.sgu.se:443
2025-07-25 01:23:34,395  DEBUG    [urllib3.connectionpool:544]  https://api.sgu.se:443 "GET /oppnadata/grus-krossberg/ogc/features/v1/collections HTTP/1.1" 200 None
2025-07-25 01:23:34,397  INFO     [etl.handlers.ogc_api:386]  ‚úÖ Discovered 3 collections for source 'Grus Krossberg'
2025-07-25 01:23:34,397  DEBUG    [etl.handlers.ogc_api:392]      - Collection ID: grus-berg, Title: Bergf√∂rekomster
2025-07-25 01:23:34,397  DEBUG    [etl.handlers.ogc_api:392]      - Collection ID: grus-grus, Title: Grusf√∂rekomster
2025-07-25 01:23:34,397  DEBUG    [etl.handlers.ogc_api:392]      - Collection ID: grus-moran, Title: Mor√§nf√∂rekomster
2025-07-25 01:23:34,397  INFO     [etl.handlers.ogc_api:315]  üîß Filtering for configured collections: ['grus-grus', 'grus-berg', 'grus-moran'] for source 'Grus Krossberg'
2025-07-25 01:23:34,397  INFO     [etl.handlers.ogc_api:247]  üöÄ Starting concurrent download of 3 collections
2025-07-25 01:23:34,398  INFO     [etl.utils.concurrent:86]  Initialized ConcurrentDownloadManager with 3 workers
2025-07-25 01:23:34,398  INFO     [etl.utils.concurrent:293]  Starting concurrent download of 3 collections
2025-07-25 01:23:34,399  INFO     [etl.utils.concurrent:121]  Starting concurrent execution of 3 tasks with 3 workers
2025-07-25 01:23:34,407  INFO     [etl.utils.concurrent:215]  Concurrent execution completed: 0/3 successful (0.0%), avg=0.00s, max=0.00s, total=0.00s
2025-07-25 01:23:34,408  INFO     [etl.handlers.ogc_api:283]  üèÅ Concurrent collection downloads completed: 0 successful, 3 failed
2025-07-25 01:23:34,408  ERROR    [etl.handlers.ogc_api:292]  ‚ùå Collection download failed: collection_grus-berg - name 'time' is not defined
2025-07-25 01:23:34,408  ERROR    [etl.handlers.ogc_api:292]  ‚ùå Collection download failed: collection_grus-grus - name 'time' is not defined
2025-07-25 01:23:34,408  ERROR    [etl.handlers.ogc_api:292]  ‚ùå Collection download failed: collection_grus-moran - name 'time' is not defined
2025-07-25 01:23:34,408  WARNING  [etl.handlers.ogc_api:227]  ‚ö†Ô∏è No collections were successfully processed/saved with data for source: Grus Krossberg
2025-07-25 01:23:34,409  INFO     [pipeline:623]  üöö Jordbruksblock (2024)
2025-07-25 01:23:34,411  INFO     [etl.handlers.rest_api:68]  üöÄ Initializing RestApiDownloadHandler for source: Jordbruksblock (2024)
2025-07-25 01:23:34,411  INFO     [etl.handlers.rest_api:321]  üåê Processing REST API source: 'Jordbruksblock (2024)' from URL: https://ext-geodata-nationella.lansstyrelsen.se/arcgis/rest/services/SJV/lst_sjv_fak04jbb/MapServer
2025-07-25 01:23:34,485  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-nationella.lansstyrelsen.se:443 "GET /arcgis/rest/services/SJV/lst_sjv_fak04jbb/MapServer?f=json HTTP/1.1" 200 1193
2025-07-25 01:23:34,486  INFO     [etl.handlers.rest_api:346]  Found explicit layer_ids in config: [18] for source 'Jordbruksblock (2024)'. Processing only these.
2025-07-25 01:23:34,486  INFO     [etl.handlers.rest_api:427]  Source 'Jordbruksblock (2024)': Will attempt to query 1 layer(s): ['18']
2025-07-25 01:23:34,486  INFO     [etl.handlers.rest_api:659]  üöö sjv_jordbruksblock_2024
2025-07-25 01:23:34,486  DEBUG    [etl.handlers.rest_api:660]  Querying Layer ID: 18 (Sanitized Name: sjv_jordbruksblock_2024, Original: SJV Jordbruksblock 2024) from https://ext-geodata-nationella.lansstyrelsen.se/arcgis/rest/services/SJV/lst_sjv_fak04jbb/MapServer/18/query
2025-07-25 01:23:34,486  DEBUG    [etl.handlers.rest_api:530]  maxRecordCount not found in layer metadata, using default: 5000
2025-07-25 01:23:34,486  DEBUG    [etl.handlers.rest_api:199]  Applying BBOX: 586206,6551160,647910,6610992 (SRID: 3006)
2025-07-25 01:23:34,489  DEBUG    [etl.handlers.rest_api:565]  Fetching page 1 for layer sjv_jordbruksblock_2024 (offset 0, limit 5000)
2025-07-25 01:23:35,144  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-nationella.lansstyrelsen.se:443 "GET /arcgis/rest/services/SJV/lst_sjv_fak04jbb/MapServer/18/query?where=1%3D1&outFields=%2A&returnGeometry=true&f=geojson&geometry=586206%2C6551160%2C647910%2C6610992&geometryType=esriGeometryEnvelope&inSR=3006&spatialRel=esriSpatialRelIntersects&resultOffset=0&resultRecordCount=5000 HTTP/1.1" 200 None
2025-07-25 01:23:35,558  DEBUG    [etl.handlers.rest_api:270]  ‚ö†Ô∏è Exceeded transfer limit for layer sjv_jordbruksblock_2024, fetching next page.
2025-07-25 01:23:35,559  DEBUG    [etl.handlers.rest_api:565]  Fetching page 2 for layer sjv_jordbruksblock_2024 (offset 2000, limit 5000)
2025-07-25 01:23:36,216  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-nationella.lansstyrelsen.se:443 "GET /arcgis/rest/services/SJV/lst_sjv_fak04jbb/MapServer/18/query?where=1%3D1&outFields=%2A&returnGeometry=true&f=geojson&geometry=586206%2C6551160%2C647910%2C6610992&geometryType=esriGeometryEnvelope&inSR=3006&spatialRel=esriSpatialRelIntersects&resultOffset=2000&resultRecordCount=5000 HTTP/1.1" 200 None
2025-07-25 01:23:36,759  DEBUG    [etl.handlers.rest_api:270]  ‚ö†Ô∏è Exceeded transfer limit for layer sjv_jordbruksblock_2024, fetching next page.
2025-07-25 01:23:36,759  DEBUG    [etl.handlers.rest_api:565]  Fetching page 3 for layer sjv_jordbruksblock_2024 (offset 4000, limit 5000)
2025-07-25 01:23:37,350  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-nationella.lansstyrelsen.se:443 "GET /arcgis/rest/services/SJV/lst_sjv_fak04jbb/MapServer/18/query?where=1%3D1&outFields=%2A&returnGeometry=true&f=geojson&geometry=586206%2C6551160%2C647910%2C6610992&geometryType=esriGeometryEnvelope&inSR=3006&spatialRel=esriSpatialRelIntersects&resultOffset=4000&resultRecordCount=5000 HTTP/1.1" 200 None
2025-07-25 01:23:38,009  DEBUG    [etl.handlers.rest_api:270]  ‚ö†Ô∏è Exceeded transfer limit for layer sjv_jordbruksblock_2024, fetching next page.
2025-07-25 01:23:38,009  DEBUG    [etl.handlers.rest_api:565]  Fetching page 4 for layer sjv_jordbruksblock_2024 (offset 6000, limit 5000)
2025-07-25 01:23:38,586  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-nationella.lansstyrelsen.se:443 "GET /arcgis/rest/services/SJV/lst_sjv_fak04jbb/MapServer/18/query?where=1%3D1&outFields=%2A&returnGeometry=true&f=geojson&geometry=586206%2C6551160%2C647910%2C6610992&geometryType=esriGeometryEnvelope&inSR=3006&spatialRel=esriSpatialRelIntersects&resultOffset=6000&resultRecordCount=5000 HTTP/1.1" 200 None
2025-07-25 01:23:39,227  DEBUG    [etl.handlers.rest_api:270]  ‚ö†Ô∏è Exceeded transfer limit for layer sjv_jordbruksblock_2024, fetching next page.
2025-07-25 01:23:39,227  DEBUG    [etl.handlers.rest_api:565]  Fetching page 5 for layer sjv_jordbruksblock_2024 (offset 8000, limit 5000)
2025-07-25 01:23:39,856  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-nationella.lansstyrelsen.se:443 "GET /arcgis/rest/services/SJV/lst_sjv_fak04jbb/MapServer/18/query?where=1%3D1&outFields=%2A&returnGeometry=true&f=geojson&geometry=586206%2C6551160%2C647910%2C6610992&geometryType=esriGeometryEnvelope&inSR=3006&spatialRel=esriSpatialRelIntersects&resultOffset=8000&resultRecordCount=5000 HTTP/1.1" 200 None
2025-07-25 01:23:40,509  DEBUG    [etl.handlers.rest_api:270]  ‚ö†Ô∏è Exceeded transfer limit for layer sjv_jordbruksblock_2024, fetching next page.
2025-07-25 01:23:40,509  DEBUG    [etl.handlers.rest_api:565]  Fetching page 6 for layer sjv_jordbruksblock_2024 (offset 10000, limit 5000)
2025-07-25 01:23:41,151  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-nationella.lansstyrelsen.se:443 "GET /arcgis/rest/services/SJV/lst_sjv_fak04jbb/MapServer/18/query?where=1%3D1&outFields=%2A&returnGeometry=true&f=geojson&geometry=586206%2C6551160%2C647910%2C6610992&geometryType=esriGeometryEnvelope&inSR=3006&spatialRel=esriSpatialRelIntersects&resultOffset=10000&resultRecordCount=5000 HTTP/1.1" 200 None
2025-07-25 01:23:41,878  DEBUG    [etl.handlers.rest_api:270]  ‚ö†Ô∏è Exceeded transfer limit for layer sjv_jordbruksblock_2024, fetching next page.
2025-07-25 01:23:41,878  DEBUG    [etl.handlers.rest_api:565]  Fetching page 7 for layer sjv_jordbruksblock_2024 (offset 12000, limit 5000)
2025-07-25 01:23:42,544  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-nationella.lansstyrelsen.se:443 "GET /arcgis/rest/services/SJV/lst_sjv_fak04jbb/MapServer/18/query?where=1%3D1&outFields=%2A&returnGeometry=true&f=geojson&geometry=586206%2C6551160%2C647910%2C6610992&geometryType=esriGeometryEnvelope&inSR=3006&spatialRel=esriSpatialRelIntersects&resultOffset=12000&resultRecordCount=5000 HTTP/1.1" 200 None
2025-07-25 01:23:43,368  DEBUG    [etl.handlers.rest_api:270]  ‚ö†Ô∏è Exceeded transfer limit for layer sjv_jordbruksblock_2024, fetching next page.
2025-07-25 01:23:43,368  DEBUG    [etl.handlers.rest_api:565]  Fetching page 8 for layer sjv_jordbruksblock_2024 (offset 14000, limit 5000)
2025-07-25 01:23:44,030  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-nationella.lansstyrelsen.se:443 "GET /arcgis/rest/services/SJV/lst_sjv_fak04jbb/MapServer/18/query?where=1%3D1&outFields=%2A&returnGeometry=true&f=geojson&geometry=586206%2C6551160%2C647910%2C6610992&geometryType=esriGeometryEnvelope&inSR=3006&spatialRel=esriSpatialRelIntersects&resultOffset=14000&resultRecordCount=5000 HTTP/1.1" 200 None
2025-07-25 01:23:44,673  DEBUG    [etl.handlers.rest_api:270]  ‚ö†Ô∏è Exceeded transfer limit for layer sjv_jordbruksblock_2024, fetching next page.
2025-07-25 01:23:44,673  DEBUG    [etl.handlers.rest_api:565]  Fetching page 9 for layer sjv_jordbruksblock_2024 (offset 16000, limit 5000)
2025-07-25 01:23:45,323  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-nationella.lansstyrelsen.se:443 "GET /arcgis/rest/services/SJV/lst_sjv_fak04jbb/MapServer/18/query?where=1%3D1&outFields=%2A&returnGeometry=true&f=geojson&geometry=586206%2C6551160%2C647910%2C6610992&geometryType=esriGeometryEnvelope&inSR=3006&spatialRel=esriSpatialRelIntersects&resultOffset=16000&resultRecordCount=5000 HTTP/1.1" 200 None
2025-07-25 01:23:46,084  DEBUG    [etl.handlers.rest_api:270]  ‚ö†Ô∏è Exceeded transfer limit for layer sjv_jordbruksblock_2024, fetching next page.
2025-07-25 01:23:46,085  DEBUG    [etl.handlers.rest_api:565]  Fetching page 10 for layer sjv_jordbruksblock_2024 (offset 18000, limit 5000)
2025-07-25 01:23:46,432  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-nationella.lansstyrelsen.se:443 "GET /arcgis/rest/services/SJV/lst_sjv_fak04jbb/MapServer/18/query?where=1%3D1&outFields=%2A&returnGeometry=true&f=geojson&geometry=586206%2C6551160%2C647910%2C6610992&geometryType=esriGeometryEnvelope&inSR=3006&spatialRel=esriSpatialRelIntersects&resultOffset=18000&resultRecordCount=5000 HTTP/1.1" 200 None
2025-07-25 01:23:46,627  DEBUG    [etl.handlers.rest_api:279]  üèÅ All features likely retrieved for layer sjv_jordbruksblock_2024 (less than page limit or server maxRecordCount is 0).
2025-07-25 01:23:55,605  INFO     [etl.handlers.rest_api:298]  ‚úÖ sjv_jordbruksblock_2024: 18581 features
2025-07-25 01:23:55,605  DEBUG    [etl.handlers.rest_api:299]  üíæ Successfully saved 18581 features for layer sjv_jordbruksblock_2024 to C:\Git\ETL-pipeline\data\staging\SJV\jordbruksblock_2024\sjv_jordbruksblock_2024.geojson
2025-07-25 01:23:55,671  INFO     [pipeline:623]  üöö Jordbruksskiften (senaste √•ret)
2025-07-25 01:23:55,672  INFO     [etl.handlers.rest_api:68]  üöÄ Initializing RestApiDownloadHandler for source: Jordbruksskiften (senaste √•ret)
2025-07-25 01:23:55,672  INFO     [etl.handlers.rest_api:321]  üåê Processing REST API source: 'Jordbruksskiften (senaste √•ret)' from URL: https://epub.sjv.se/inspire/inspire/wfs?service=WFS&request=GetFeature&typeName=inspire:senaste_arslager_skifte&outputFormat=application/json
2025-07-25 01:23:55,674  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): epub.sjv.se:443
2025-07-25 01:23:56,508  DEBUG    [urllib3.connectionpool:544]  https://epub.sjv.se:443 "GET /inspire/inspire/wfs?service=WFS&request=GetFeature&typeName=inspire:senaste_arslager_skifte&outputFormat=application/json&f=json HTTP/1.1" 200 None
2025-07-25 01:26:41,025  WARNING  [etl.handlers.rest_api:419]  ‚ö†Ô∏è No layers identified or specified to query for source 'Jordbruksskiften (senaste √•ret)'. Check service metadata and `layer_ids` config.
2025-07-25 01:26:43,601  INFO     [pipeline:623]  üöö Produktionsplatser f√∂r djurh√•llning
2025-07-25 01:26:43,603  INFO     [etl.handlers.rest_api:68]  üöÄ Initializing RestApiDownloadHandler for source: Produktionsplatser f√∂r djurh√•llning
2025-07-25 01:26:43,603  INFO     [etl.handlers.rest_api:321]  üåê Processing REST API source: 'Produktionsplatser f√∂r djurh√•llning' from URL: http://epub.sjv.se/inspire/inspire/wfs?service=WFS&version=2.0.0&request=GetFeature&typeName=inspire:produktionsplatser&outputFormat=application/json
2025-07-25 01:26:43,604  DEBUG    [urllib3.connectionpool:241]  Starting new HTTP connection (1): epub.sjv.se:80
2025-07-25 01:26:43,742  DEBUG    [urllib3.connectionpool:544]  http://epub.sjv.se:80 "GET /inspire/inspire/wfs?service=WFS&version=2.0.0&request=GetFeature&typeName=inspire:produktionsplatser&outputFormat=application/json&f=json HTTP/1.1" 200 None
2025-07-25 01:26:47,711  WARNING  [etl.handlers.rest_api:419]  ‚ö†Ô∏è No layers identified or specified to query for source 'Produktionsplatser f√∂r djurh√•llning'. Check service metadata and `layer_ids` config.
2025-07-25 01:26:47,767  INFO     [pipeline:623]  üöö √Ñngs- och betesmarksinventeringen
2025-07-25 01:26:47,767  INFO     [etl.handlers.rest_api:68]  üöÄ Initializing RestApiDownloadHandler for source: √Ñngs- och betesmarksinventeringen
2025-07-25 01:26:47,767  INFO     [etl.handlers.rest_api:321]  üåê Processing REST API source: '√Ñngs- och betesmarksinventeringen' from URL: https://ext-geodata-nationella.lansstyrelsen.se/arcgis/rest/services/SJV/lst_sjv_fak04ovr/MapServer
2025-07-25 01:26:47,769  DEBUG    [urllib3.connectionpool:289]  Resetting dropped connection: ext-geodata-nationella.lansstyrelsen.se
2025-07-25 01:26:47,950  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-nationella.lansstyrelsen.se:443 "GET /arcgis/rest/services/SJV/lst_sjv_fak04ovr/MapServer?f=json HTTP/1.1" 200 1198
2025-07-25 01:26:47,951  INFO     [etl.handlers.rest_api:346]  Found explicit layer_ids in config: [4, 5] for source '√Ñngs- och betesmarksinventeringen'. Processing only these.
2025-07-25 01:26:47,952  INFO     [etl.handlers.rest_api:427]  Source '√Ñngs- och betesmarksinventeringen': Will attempt to query 2 layer(s): ['4', '5']
2025-07-25 01:26:47,952  INFO     [etl.handlers.rest_api:447]  üöÄ Starting concurrent download of 2 layers
2025-07-25 01:26:47,952  INFO     [etl.utils.concurrent:261]  Starting concurrent download of 2 layers
2025-07-25 01:26:47,952  INFO     [etl.utils.concurrent:121]  Starting concurrent execution of 2 tasks with 5 workers
2025-07-25 01:26:47,955  INFO     [etl.utils.concurrent:215]  Concurrent execution completed: 0/2 successful (0.0%), avg=0.00s, max=0.00s, total=0.00s
2025-07-25 01:26:47,955  INFO     [etl.handlers.rest_api:480]  üèÅ Concurrent downloads completed: 0 successful, 2 failed
2025-07-25 01:26:47,955  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_SJV √Ñngs- och betesmarksinventeringen naturtyper - name 'time' is not defined
2025-07-25 01:26:47,956  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_SJV √Ñngs- och betesmarksinventeringen - name 'time' is not defined
2025-07-25 01:26:47,956  INFO     [pipeline:623]  üöö Naturv√§rden
2025-07-25 01:26:47,957  INFO     [etl.handlers.file:162]  üîó Single resource download mode for 'Naturv√§rden' from URL: https://geodpags.skogsstyrelsen.se/geodataport/data/sksNaturvarden_gpkg.zip
2025-07-25 01:26:48,204  INFO     [etl.utils.http:110]      Derived filename by unquoting URL basename ('https://geodpags.skogsstyrelsen.se/geodataport/data/sksNaturvarden_gpkg.zip'): sksNaturvarden_gpkg.zip
2025-07-25 01:26:48,301  DEBUG    [etl.handlers.file:247]  Attempting to download: https://geodpags.skogsstyrelsen.se/geodataport/data/sksNaturvarden_gpkg.zip 
    -> to local file: naturvarden.zip 
    -> staging dir: data\staging\SKS\naturvarden
2025-07-25 01:26:48,302  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): geodpags.skogsstyrelsen.se:443
2025-07-25 01:26:48,470  DEBUG    [urllib3.connectionpool:544]  https://geodpags.skogsstyrelsen.se:443 "HEAD /geodataport/data/sksNaturvarden_gpkg.zip HTTP/1.1" 200 0
2025-07-25 01:26:48,471  INFO     [etl.utils.io:44]  ‚¨á naturvarden.zip (17.8 MB)
2025-07-25 01:26:48,473  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): geodpags.skogsstyrelsen.se:443
2025-07-25 01:26:48,903  DEBUG    [urllib3.connectionpool:544]  https://geodpags.skogsstyrelsen.se:443 "GET /geodataport/data/sksNaturvarden_gpkg.zip HTTP/1.1" 200 18690966
2025-07-25 01:26:52,215  INFO     [etl.utils.io:82]  ‚úÖ naturvarden.zip
2025-07-25 01:26:52,216  INFO     [etl.handlers.file:278]  Determined staged_data_type: 'gpkg' for downloaded file 'naturvarden.zip'
2025-07-25 01:26:52,231  INFO     [etl.handlers.file:292]  ‚ûï Staged GPKG naturvarden.zip to data\staging\SKS\naturvarden\naturvarden.zip
2025-07-25 01:26:52,232  INFO     [pipeline:623]  üöö Ras och skred
2025-07-25 01:26:52,233  INFO     [etl.handlers.atom_feed:41]  üåê Reading Atom feed for source 'Ras och skred' from URL: https://geodpags.skogsstyrelsen.se/geodataport/feeds/Rasochskred.xml
2025-07-25 01:26:52,234  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): geodpags.skogsstyrelsen.se:443
2025-07-25 01:26:52,393  DEBUG    [urllib3.connectionpool:544]  https://geodpags.skogsstyrelsen.se:443 "HEAD /geodataport/feeds/Rasochskred.xml HTTP/1.1" 404 0
2025-07-25 01:26:52,393  INFO     [etl.utils.io:44]  ‚¨á ras_och_skred_feed.xml (1.2 KB)
2025-07-25 01:26:52,396  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): geodpags.skogsstyrelsen.se:443
2025-07-25 01:26:52,566  DEBUG    [urllib3.connectionpool:544]  https://geodpags.skogsstyrelsen.se:443 "GET /geodataport/feeds/Rasochskred.xml HTTP/1.1" 404 1245
2025-07-25 01:26:52,567  ERROR    [etl.handlers.atom_feed:56]  ‚ùå Failed to download or read Atom feed XML for 'Ras och skred' from https://geodpags.skogsstyrelsen.se/geodataport/feeds/Rasochskred.xml: 404 Client Error: Not Found for url: https://geodpags.skogsstyrelsen.se/geodataport/feeds/Rasochskred.xml
Traceback (most recent call last):
  File "C:\Git\ETL-pipeline\etl\handlers\atom_feed.py", line 51, in fetch
    downloaded_feed_xml_path = download(
                               ^^^^^^^^^
  File "C:\Git\ETL-pipeline\etl\utils\io.py", line 49, in download
    resp.raise_for_status()
  File "C:\Users\kije\AppData\Roaming\Python\Python311\site-packages\requests\models.py", line 1026, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 404 Client Error: Not Found for url: https://geodpags.skogsstyrelsen.se/geodataport/feeds/Rasochskred.xml
2025-07-25 01:26:52,575  INFO     [pipeline:623]  üöö Skogsstyrelsen - Biotopskydd (REST)
2025-07-25 01:26:52,576  INFO     [etl.handlers.rest_api:68]  üöÄ Initializing RestApiDownloadHandler for source: Skogsstyrelsen - Biotopskydd (REST)
2025-07-25 01:26:52,576  INFO     [etl.handlers.rest_api:321]  üåê Processing REST API source: 'Skogsstyrelsen - Biotopskydd (REST)' from URL: https://geodpags.skogsstyrelsen.se/arcgis/rest/services/Geodataportal/GeodataportalVisaBiotopskydd/MapServer
2025-07-25 01:26:52,576  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): geodpags.skogsstyrelsen.se:443
2025-07-25 01:26:52,796  DEBUG    [urllib3.connectionpool:544]  https://geodpags.skogsstyrelsen.se:443 "GET /arcgis/rest/services/Geodataportal/GeodataportalVisaBiotopskydd/MapServer?f=json HTTP/1.1" 200 1130
2025-07-25 01:26:52,861  INFO     [etl.handlers.rest_api:380]  No explicit layer_ids in config for source 'Skogsstyrelsen - Biotopskydd (REST)'. Discovering all layers from service metadata.
2025-07-25 01:26:52,862  INFO     [etl.handlers.rest_api:427]  Source 'Skogsstyrelsen - Biotopskydd (REST)': Will attempt to query 1 layer(s): ['0']
2025-07-25 01:26:52,862  INFO     [etl.handlers.rest_api:659]  üöö biotopskydd_skogsstyrelsen
2025-07-25 01:26:52,862  DEBUG    [etl.handlers.rest_api:660]  Querying Layer ID: 0 (Sanitized Name: biotopskydd_skogsstyrelsen, Original: Biotopskydd_Skogsstyrelsen) from https://geodpags.skogsstyrelsen.se/arcgis/rest/services/Geodataportal/GeodataportalVisaBiotopskydd/MapServer/0/query
2025-07-25 01:26:52,862  DEBUG    [etl.handlers.rest_api:530]  maxRecordCount not found in layer metadata, using default: 5000
2025-07-25 01:26:52,862  DEBUG    [etl.handlers.rest_api:199]  Applying BBOX: 586206,6551160,647910,6610992 (SRID: 3006)
2025-07-25 01:26:52,864  DEBUG    [etl.handlers.rest_api:565]  Fetching page 1 for layer biotopskydd_skogsstyrelsen (offset 0, limit 5000)
2025-07-25 01:26:53,180  DEBUG    [urllib3.connectionpool:544]  https://geodpags.skogsstyrelsen.se:443 "GET /arcgis/rest/services/Geodataportal/GeodataportalVisaBiotopskydd/MapServer/0/query?where=1%3D1&outFields=%2A&returnGeometry=true&f=geojson&geometry=586206%2C6551160%2C647910%2C6610992&geometryType=esriGeometryEnvelope&inSR=3006&spatialRel=esriSpatialRelIntersects&resultOffset=0&resultRecordCount=5000 HTTP/1.1" 200 None
2025-07-25 01:26:53,255  DEBUG    [etl.handlers.rest_api:279]  üèÅ All features likely retrieved for layer biotopskydd_skogsstyrelsen (less than page limit or server maxRecordCount is 0).
2025-07-25 01:26:53,382  INFO     [etl.handlers.rest_api:298]  ‚úÖ biotopskydd_skogsstyrelsen: 125 features
2025-07-25 01:26:53,383  DEBUG    [etl.handlers.rest_api:299]  üíæ Successfully saved 125 features for layer biotopskydd_skogsstyrelsen to C:\Git\ETL-pipeline\data\staging\SKS\skogsstyrelsen_-_biotopskydd_rest\biotopskydd_skogsstyrelsen.geojson
2025-07-25 01:26:53,384  INFO     [pipeline:623]  üöö Utf√∂rda avverkningar
2025-07-25 01:26:53,387  INFO     [etl.handlers.rest_api:68]  üöÄ Initializing RestApiDownloadHandler for source: Utf√∂rda avverkningar
2025-07-25 01:26:53,388  INFO     [etl.handlers.rest_api:321]  üåê Processing REST API source: 'Utf√∂rda avverkningar' from URL: https://geodpags.skogsstyrelsen.se/arcgis/rest/services/Geodataportal/GeodataportalVisaUtfordavverkning/MapServer
2025-07-25 01:26:53,455  DEBUG    [urllib3.connectionpool:544]  https://geodpags.skogsstyrelsen.se:443 "GET /arcgis/rest/services/Geodataportal/GeodataportalVisaUtfordavverkning/MapServer?f=json HTTP/1.1" 200 1201
2025-07-25 01:26:53,523  INFO     [etl.handlers.rest_api:380]  No explicit layer_ids in config for source 'Utf√∂rda avverkningar'. Discovering all layers from service metadata.
2025-07-25 01:26:53,524  INFO     [etl.handlers.rest_api:427]  Source 'Utf√∂rda avverkningar': Will attempt to query 2 layer(s): ['0', '1']
2025-07-25 01:26:53,524  INFO     [etl.handlers.rest_api:447]  üöÄ Starting concurrent download of 2 layers
2025-07-25 01:26:53,524  INFO     [etl.utils.concurrent:261]  Starting concurrent download of 2 layers
2025-07-25 01:26:53,525  INFO     [etl.utils.concurrent:121]  Starting concurrent execution of 2 tasks with 5 workers
2025-07-25 01:26:53,529  INFO     [etl.utils.concurrent:215]  Concurrent execution completed: 0/2 successful (0.0%), avg=0.00s, max=0.00s, total=0.00s
2025-07-25 01:26:53,529  INFO     [etl.handlers.rest_api:480]  üèÅ Concurrent downloads completed: 0 successful, 2 failed
2025-07-25 01:26:53,530  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_√ñversikt senaste √•ret -  UtfordAvverkning_Skogsstyrelsen - name 'time' is not defined
2025-07-25 01:26:53,530  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_UtfordAvverkning_Skogsstyrelsen - name 'time' is not defined
2025-07-25 01:26:53,530  INFO     [pipeline:623]  üöö Naturv√•rdsavtal
2025-07-25 01:26:53,532  INFO     [etl.handlers.rest_api:68]  üöÄ Initializing RestApiDownloadHandler for source: Naturv√•rdsavtal
2025-07-25 01:26:53,532  INFO     [etl.handlers.rest_api:321]  üåê Processing REST API source: 'Naturv√•rdsavtal' from URL: https://geodpags.skogsstyrelsen.se/arcgis/rest/services/Geodataportal/GeodataportalVisaNaturvardsavtal/MapServer
2025-07-25 01:26:53,590  DEBUG    [urllib3.connectionpool:544]  https://geodpags.skogsstyrelsen.se:443 "GET /arcgis/rest/services/Geodataportal/GeodataportalVisaNaturvardsavtal/MapServer?f=json HTTP/1.1" 200 1138
2025-07-25 01:26:53,656  INFO     [etl.handlers.rest_api:380]  No explicit layer_ids in config for source 'Naturv√•rdsavtal'. Discovering all layers from service metadata.
2025-07-25 01:26:53,656  INFO     [etl.handlers.rest_api:427]  Source 'Naturv√•rdsavtal': Will attempt to query 1 layer(s): ['0']
2025-07-25 01:26:53,656  INFO     [etl.handlers.rest_api:659]  üöö naturvardsavtal_skogsstyrelsen
2025-07-25 01:26:53,656  DEBUG    [etl.handlers.rest_api:660]  Querying Layer ID: 0 (Sanitized Name: naturvardsavtal_skogsstyrelsen, Original: Naturvardsavtal_Skogsstyrelsen) from https://geodpags.skogsstyrelsen.se/arcgis/rest/services/Geodataportal/GeodataportalVisaNaturvardsavtal/MapServer/0/query
2025-07-25 01:26:53,656  DEBUG    [etl.handlers.rest_api:530]  maxRecordCount not found in layer metadata, using default: 5000
2025-07-25 01:26:53,657  DEBUG    [etl.handlers.rest_api:199]  Applying BBOX: 586206,6551160,647910,6610992 (SRID: 3006)
2025-07-25 01:26:53,658  DEBUG    [etl.handlers.rest_api:565]  Fetching page 1 for layer naturvardsavtal_skogsstyrelsen (offset 0, limit 5000)
2025-07-25 01:26:54,105  DEBUG    [urllib3.connectionpool:544]  https://geodpags.skogsstyrelsen.se:443 "GET /arcgis/rest/services/Geodataportal/GeodataportalVisaNaturvardsavtal/MapServer/0/query?where=1%3D1&outFields=%2A&returnGeometry=true&f=geojson&geometry=586206%2C6551160%2C647910%2C6610992&geometryType=esriGeometryEnvelope&inSR=3006&spatialRel=esriSpatialRelIntersects&resultOffset=0&resultRecordCount=5000 HTTP/1.1" 200 None
2025-07-25 01:26:54,172  DEBUG    [etl.handlers.rest_api:279]  üèÅ All features likely retrieved for layer naturvardsavtal_skogsstyrelsen (less than page limit or server maxRecordCount is 0).
2025-07-25 01:26:54,214  INFO     [etl.handlers.rest_api:298]  ‚úÖ naturvardsavtal_skogsstyrelsen: 59 features
2025-07-25 01:26:54,214  DEBUG    [etl.handlers.rest_api:299]  üíæ Successfully saved 59 features for layer naturvardsavtal_skogsstyrelsen to C:\Git\ETL-pipeline\data\staging\SKS\naturvardsavtal\naturvardsavtal_skogsstyrelsen.geojson
2025-07-25 01:26:54,214  INFO     [pipeline:623]  üöö √Öterv√§tningsavtal
2025-07-25 01:26:54,215  INFO     [etl.handlers.rest_api:68]  üöÄ Initializing RestApiDownloadHandler for source: √Öterv√§tningsavtal
2025-07-25 01:26:54,216  INFO     [etl.handlers.rest_api:321]  üåê Processing REST API source: '√Öterv√§tningsavtal' from URL: https://geodpags.skogsstyrelsen.se/arcgis/rest/services/Geodataportal/GeodataportalVisaAtervatningavtal/MapServer
2025-07-25 01:26:54,277  DEBUG    [urllib3.connectionpool:544]  https://geodpags.skogsstyrelsen.se:443 "GET /arcgis/rest/services/Geodataportal/GeodataportalVisaAtervatningavtal/MapServer?f=json HTTP/1.1" 200 1251
2025-07-25 01:26:54,338  INFO     [etl.handlers.rest_api:380]  No explicit layer_ids in config for source '√Öterv√§tningsavtal'. Discovering all layers from service metadata.
2025-07-25 01:26:54,338  INFO     [etl.handlers.rest_api:427]  Source '√Öterv√§tningsavtal': Will attempt to query 1 layer(s): ['0']
2025-07-25 01:26:54,339  INFO     [etl.handlers.rest_api:659]  üöö atervatningyta_skogsstyrelsen
2025-07-25 01:26:54,339  DEBUG    [etl.handlers.rest_api:660]  Querying Layer ID: 0 (Sanitized Name: atervatningyta_skogsstyrelsen, Original: √Öterv√§tningYta_Skogsstyrelsen) from https://geodpags.skogsstyrelsen.se/arcgis/rest/services/Geodataportal/GeodataportalVisaAtervatningavtal/MapServer/0/query
2025-07-25 01:26:54,339  DEBUG    [etl.handlers.rest_api:530]  maxRecordCount not found in layer metadata, using default: 5000
2025-07-25 01:26:54,339  DEBUG    [etl.handlers.rest_api:199]  Applying BBOX: 586206,6551160,647910,6610992 (SRID: 3006)
2025-07-25 01:26:54,341  DEBUG    [etl.handlers.rest_api:565]  Fetching page 1 for layer atervatningyta_skogsstyrelsen (offset 0, limit 5000)
2025-07-25 01:26:54,448  DEBUG    [urllib3.connectionpool:544]  https://geodpags.skogsstyrelsen.se:443 "GET /arcgis/rest/services/Geodataportal/GeodataportalVisaAtervatningavtal/MapServer/0/query?where=1%3D1&outFields=%2A&returnGeometry=true&f=geojson&geometry=586206%2C6551160%2C647910%2C6610992&geometryType=esriGeometryEnvelope&inSR=3006&spatialRel=esriSpatialRelIntersects&resultOffset=0&resultRecordCount=5000 HTTP/1.1" 200 1921
2025-07-25 01:26:54,461  DEBUG    [etl.handlers.rest_api:279]  üèÅ All features likely retrieved for layer atervatningyta_skogsstyrelsen (less than page limit or server maxRecordCount is 0).
2025-07-25 01:26:54,465  INFO     [etl.handlers.rest_api:298]  ‚úÖ atervatningyta_skogsstyrelsen: 3 features
2025-07-25 01:26:54,465  DEBUG    [etl.handlers.rest_api:299]  üíæ Successfully saved 3 features for layer atervatningyta_skogsstyrelsen to C:\Git\ETL-pipeline\data\staging\SKS\atervatningsavtal\atervatningyta_skogsstyrelsen.geojson
2025-07-25 01:26:54,465  INFO     [pipeline:623]  üöö Nyckelbiotoper
2025-07-25 01:26:54,467  INFO     [etl.handlers.rest_api:68]  üöÄ Initializing RestApiDownloadHandler for source: Nyckelbiotoper
2025-07-25 01:26:54,467  INFO     [etl.handlers.rest_api:321]  üåê Processing REST API source: 'Nyckelbiotoper' from URL: https://geodpags.skogsstyrelsen.se/arcgis/rest/services/Geodataportal/GeodataportalVisaNyckelbiotop/MapServer
2025-07-25 01:26:54,526  DEBUG    [urllib3.connectionpool:544]  https://geodpags.skogsstyrelsen.se:443 "GET /arcgis/rest/services/Geodataportal/GeodataportalVisaNyckelbiotop/MapServer?f=json HTTP/1.1" 200 1143
2025-07-25 01:26:54,588  INFO     [etl.handlers.rest_api:380]  No explicit layer_ids in config for source 'Nyckelbiotoper'. Discovering all layers from service metadata.
2025-07-25 01:26:54,589  INFO     [etl.handlers.rest_api:427]  Source 'Nyckelbiotoper': Will attempt to query 1 layer(s): ['0']
2025-07-25 01:26:54,589  INFO     [etl.handlers.rest_api:659]  üöö nyckelbiotop_skogsstyrelsen
2025-07-25 01:26:54,589  DEBUG    [etl.handlers.rest_api:660]  Querying Layer ID: 0 (Sanitized Name: nyckelbiotop_skogsstyrelsen, Original: Nyckelbiotop_Skogsstyrelsen) from https://geodpags.skogsstyrelsen.se/arcgis/rest/services/Geodataportal/GeodataportalVisaNyckelbiotop/MapServer/0/query
2025-07-25 01:26:54,589  DEBUG    [etl.handlers.rest_api:530]  maxRecordCount not found in layer metadata, using default: 5000
2025-07-25 01:26:54,589  DEBUG    [etl.handlers.rest_api:199]  Applying BBOX: 586206,6551160,647910,6610992 (SRID: 3006)
2025-07-25 01:26:54,590  DEBUG    [etl.handlers.rest_api:565]  Fetching page 1 for layer nyckelbiotop_skogsstyrelsen (offset 0, limit 5000)
2025-07-25 01:26:55,073  DEBUG    [urllib3.connectionpool:544]  https://geodpags.skogsstyrelsen.se:443 "GET /arcgis/rest/services/Geodataportal/GeodataportalVisaNyckelbiotop/MapServer/0/query?where=1%3D1&outFields=%2A&returnGeometry=true&f=geojson&geometry=586206%2C6551160%2C647910%2C6610992&geometryType=esriGeometryEnvelope&inSR=3006&spatialRel=esriSpatialRelIntersects&resultOffset=0&resultRecordCount=5000 HTTP/1.1" 200 None
2025-07-25 01:26:55,538  DEBUG    [etl.handlers.rest_api:279]  üèÅ All features likely retrieved for layer nyckelbiotop_skogsstyrelsen (less than page limit or server maxRecordCount is 0).
2025-07-25 01:26:56,189  INFO     [etl.handlers.rest_api:298]  ‚úÖ nyckelbiotop_skogsstyrelsen: 1293 features
2025-07-25 01:26:56,190  DEBUG    [etl.handlers.rest_api:299]  üíæ Successfully saved 1293 features for layer nyckelbiotop_skogsstyrelsen to C:\Git\ETL-pipeline\data\staging\SKS\nyckelbiotoper\nyckelbiotop_skogsstyrelsen.geojson
2025-07-25 01:26:56,194  INFO     [pipeline:623]  üöö Sumpskogar
2025-07-25 01:26:56,195  INFO     [etl.handlers.rest_api:68]  üöÄ Initializing RestApiDownloadHandler for source: Sumpskogar
2025-07-25 01:26:56,195  INFO     [etl.handlers.rest_api:321]  üåê Processing REST API source: 'Sumpskogar' from URL: https://geodpags.skogsstyrelsen.se/arcgis/rest/services/Geodataportal/GeodataportalVisaSumpskog/MapServer
2025-07-25 01:26:56,257  DEBUG    [urllib3.connectionpool:544]  https://geodpags.skogsstyrelsen.se:443 "GET /arcgis/rest/services/Geodataportal/GeodataportalVisaSumpskog/MapServer?f=json HTTP/1.1" 200 1142
2025-07-25 01:26:56,313  INFO     [etl.handlers.rest_api:380]  No explicit layer_ids in config for source 'Sumpskogar'. Discovering all layers from service metadata.
2025-07-25 01:26:56,314  INFO     [etl.handlers.rest_api:427]  Source 'Sumpskogar': Will attempt to query 1 layer(s): ['0']
2025-07-25 01:26:56,314  INFO     [etl.handlers.rest_api:659]  üöö sumpskog_skogsstyrelsen
2025-07-25 01:26:56,314  DEBUG    [etl.handlers.rest_api:660]  Querying Layer ID: 0 (Sanitized Name: sumpskog_skogsstyrelsen, Original: Sumpskog_Skogsstyrelsen) from https://geodpags.skogsstyrelsen.se/arcgis/rest/services/Geodataportal/GeodataportalVisaSumpskog/MapServer/0/query
2025-07-25 01:26:56,315  DEBUG    [etl.handlers.rest_api:530]  maxRecordCount not found in layer metadata, using default: 5000
2025-07-25 01:26:56,315  DEBUG    [etl.handlers.rest_api:199]  Applying BBOX: 586206,6551160,647910,6610992 (SRID: 3006)
2025-07-25 01:26:56,315  DEBUG    [etl.handlers.rest_api:565]  Fetching page 1 for layer sumpskog_skogsstyrelsen (offset 0, limit 5000)
2025-07-25 01:26:56,963  DEBUG    [urllib3.connectionpool:544]  https://geodpags.skogsstyrelsen.se:443 "GET /arcgis/rest/services/Geodataportal/GeodataportalVisaSumpskog/MapServer/0/query?where=1%3D1&outFields=%2A&returnGeometry=true&f=geojson&geometry=586206%2C6551160%2C647910%2C6610992&geometryType=esriGeometryEnvelope&inSR=3006&spatialRel=esriSpatialRelIntersects&resultOffset=0&resultRecordCount=5000 HTTP/1.1" 200 None
2025-07-25 01:26:57,533  DEBUG    [etl.handlers.rest_api:270]  ‚ö†Ô∏è Exceeded transfer limit for layer sumpskog_skogsstyrelsen, fetching next page.
2025-07-25 01:26:57,533  DEBUG    [etl.handlers.rest_api:565]  Fetching page 2 for layer sumpskog_skogsstyrelsen (offset 2000, limit 5000)
2025-07-25 01:26:57,963  DEBUG    [urllib3.connectionpool:544]  https://geodpags.skogsstyrelsen.se:443 "GET /arcgis/rest/services/Geodataportal/GeodataportalVisaSumpskog/MapServer/0/query?where=1%3D1&outFields=%2A&returnGeometry=true&f=geojson&geometry=586206%2C6551160%2C647910%2C6610992&geometryType=esriGeometryEnvelope&inSR=3006&spatialRel=esriSpatialRelIntersects&resultOffset=2000&resultRecordCount=5000 HTTP/1.1" 200 None
2025-07-25 01:26:58,302  DEBUG    [etl.handlers.rest_api:279]  üèÅ All features likely retrieved for layer sumpskog_skogsstyrelsen (less than page limit or server maxRecordCount is 0).
2025-07-25 01:26:59,416  INFO     [etl.handlers.rest_api:298]  ‚úÖ sumpskog_skogsstyrelsen: 2769 features
2025-07-25 01:26:59,416  DEBUG    [etl.handlers.rest_api:299]  üíæ Successfully saved 2769 features for layer sumpskog_skogsstyrelsen to C:\Git\ETL-pipeline\data\staging\SKS\sumpskogar\sumpskog_skogsstyrelsen.geojson
2025-07-25 01:26:59,421  INFO     [pipeline:623]  üöö Avverkningsanm√§lda omr√•den
2025-07-25 01:26:59,423  INFO     [etl.handlers.rest_api:68]  üöÄ Initializing RestApiDownloadHandler for source: Avverkningsanm√§lda omr√•den
2025-07-25 01:26:59,423  INFO     [etl.handlers.rest_api:321]  üåê Processing REST API source: 'Avverkningsanm√§lda omr√•den' from URL: https://geodpags.skogsstyrelsen.se/arcgis/rest/services/Geodataportal/GeodataportalVisaAvverkningsanmalan/MapServer
2025-07-25 01:26:59,483  DEBUG    [urllib3.connectionpool:544]  https://geodpags.skogsstyrelsen.se:443 "GET /arcgis/rest/services/Geodataportal/GeodataportalVisaAvverkningsanmalan/MapServer?f=json HTTP/1.1" 200 1176
2025-07-25 01:26:59,552  INFO     [etl.handlers.rest_api:380]  No explicit layer_ids in config for source 'Avverkningsanm√§lda omr√•den'. Discovering all layers from service metadata.
2025-07-25 01:26:59,552  INFO     [etl.handlers.rest_api:427]  Source 'Avverkningsanm√§lda omr√•den': Will attempt to query 1 layer(s): ['0']
2025-07-25 01:26:59,552  INFO     [etl.handlers.rest_api:659]  üöö avverkningsanmalan_skogsstyrelsen
2025-07-25 01:26:59,552  DEBUG    [etl.handlers.rest_api:660]  Querying Layer ID: 0 (Sanitized Name: avverkningsanmalan_skogsstyrelsen, Original: Avverkningsanmalan_Skogsstyrelsen) from https://geodpags.skogsstyrelsen.se/arcgis/rest/services/Geodataportal/GeodataportalVisaAvverkningsanmalan/MapServer/0/query
2025-07-25 01:26:59,552  DEBUG    [etl.handlers.rest_api:530]  maxRecordCount not found in layer metadata, using default: 5000
2025-07-25 01:26:59,552  DEBUG    [etl.handlers.rest_api:199]  Applying BBOX: 586206,6551160,647910,6610992 (SRID: 3006)
2025-07-25 01:26:59,553  DEBUG    [etl.handlers.rest_api:565]  Fetching page 1 for layer avverkningsanmalan_skogsstyrelsen (offset 0, limit 5000)
2025-07-25 01:27:01,799  DEBUG    [urllib3.connectionpool:544]  https://geodpags.skogsstyrelsen.se:443 "GET /arcgis/rest/services/Geodataportal/GeodataportalVisaAvverkningsanmalan/MapServer/0/query?where=1%3D1&outFields=%2A&returnGeometry=true&f=geojson&geometry=586206%2C6551160%2C647910%2C6610992&geometryType=esriGeometryEnvelope&inSR=3006&spatialRel=esriSpatialRelIntersects&resultOffset=0&resultRecordCount=5000 HTTP/1.1" 200 None
2025-07-25 01:27:02,331  DEBUG    [etl.handlers.rest_api:279]  üèÅ All features likely retrieved for layer avverkningsanmalan_skogsstyrelsen (less than page limit or server maxRecordCount is 0).
2025-07-25 01:27:02,989  INFO     [etl.handlers.rest_api:298]  ‚úÖ avverkningsanmalan_skogsstyrelsen: 1337 features
2025-07-25 01:27:02,989  DEBUG    [etl.handlers.rest_api:299]  üíæ Successfully saved 1337 features for layer avverkningsanmalan_skogsstyrelsen to C:\Git\ETL-pipeline\data\staging\SKS\avverkningsanmalda_omraden\avverkningsanmalan_skogsstyrelsen.geojson
2025-07-25 01:27:02,993  INFO     [pipeline:623]  üöö Gr√§ns f√∂r skogsskyddsbest√§mmelser
2025-07-25 01:27:02,995  INFO     [etl.handlers.rest_api:68]  üöÄ Initializing RestApiDownloadHandler for source: Gr√§ns f√∂r skogsskyddsbest√§mmelser
2025-07-25 01:27:02,996  INFO     [etl.handlers.rest_api:321]  üåê Processing REST API source: 'Gr√§ns f√∂r skogsskyddsbest√§mmelser' from URL: https://geodpags.skogsstyrelsen.se/arcgis/rest/services/Geodataportal/GeodataportalVisaSkogsskyddsbestammelser/MapServer
2025-07-25 01:27:03,072  DEBUG    [urllib3.connectionpool:544]  https://geodpags.skogsstyrelsen.se:443 "GET /arcgis/rest/services/Geodataportal/GeodataportalVisaSkogsskyddsbestammelser/MapServer?f=json HTTP/1.1" 200 1165
2025-07-25 01:27:03,137  INFO     [etl.handlers.rest_api:380]  No explicit layer_ids in config for source 'Gr√§ns f√∂r skogsskyddsbest√§mmelser'. Discovering all layers from service metadata.
2025-07-25 01:27:03,137  INFO     [etl.handlers.rest_api:427]  Source 'Gr√§ns f√∂r skogsskyddsbest√§mmelser': Will attempt to query 1 layer(s): ['0']
2025-07-25 01:27:03,137  INFO     [etl.handlers.rest_api:659]  üöö skogsskyddsbestammelser
2025-07-25 01:27:03,137  DEBUG    [etl.handlers.rest_api:660]  Querying Layer ID: 0 (Sanitized Name: skogsskyddsbestammelser, Original: Skogsskyddsbest√§mmelser) from https://geodpags.skogsstyrelsen.se/arcgis/rest/services/Geodataportal/GeodataportalVisaSkogsskyddsbestammelser/MapServer/0/query
2025-07-25 01:27:03,138  DEBUG    [etl.handlers.rest_api:530]  maxRecordCount not found in layer metadata, using default: 5000
2025-07-25 01:27:03,138  DEBUG    [etl.handlers.rest_api:199]  Applying BBOX: 586206,6551160,647910,6610992 (SRID: 3006)
2025-07-25 01:27:03,139  DEBUG    [etl.handlers.rest_api:565]  Fetching page 1 for layer skogsskyddsbestammelser (offset 0, limit 5000)
2025-07-25 01:27:03,465  DEBUG    [urllib3.connectionpool:544]  https://geodpags.skogsstyrelsen.se:443 "GET /arcgis/rest/services/Geodataportal/GeodataportalVisaSkogsskyddsbestammelser/MapServer/0/query?where=1%3D1&outFields=%2A&returnGeometry=true&f=geojson&geometry=586206%2C6551160%2C647910%2C6610992&geometryType=esriGeometryEnvelope&inSR=3006&spatialRel=esriSpatialRelIntersects&resultOffset=0&resultRecordCount=5000 HTTP/1.1" 200 None
2025-07-25 01:27:03,583  DEBUG    [etl.handlers.rest_api:279]  üèÅ All features likely retrieved for layer skogsskyddsbestammelser (less than page limit or server maxRecordCount is 0).
2025-07-25 01:27:03,706  INFO     [etl.handlers.rest_api:298]  ‚úÖ skogsskyddsbestammelser: 1 features
2025-07-25 01:27:03,706  DEBUG    [etl.handlers.rest_api:299]  üíæ Successfully saved 1 features for layer skogsskyddsbestammelser to C:\Git\ETL-pipeline\data\staging\SKS\grans_for_skogsskyddsbestammelser\skogsskyddsbestammelser.geojson
2025-07-25 01:27:03,707  INFO     [pipeline:623]  üöö Nyckelbiotoper - storskogsbruket
2025-07-25 01:27:03,708  INFO     [etl.handlers.rest_api:68]  üöÄ Initializing RestApiDownloadHandler for source: Nyckelbiotoper - storskogsbruket
2025-07-25 01:27:03,708  INFO     [etl.handlers.rest_api:321]  üåê Processing REST API source: 'Nyckelbiotoper - storskogsbruket' from URL: https://geodpags.skogsstyrelsen.se/arcgis/rest/services/Geodataportal/GeodataportalVisaSkogsbruknyckelbiotop/MapServer
2025-07-25 01:27:03,771  DEBUG    [urllib3.connectionpool:544]  https://geodpags.skogsstyrelsen.se:443 "GET /arcgis/rest/services/Geodataportal/GeodataportalVisaSkogsbruknyckelbiotop/MapServer?f=json HTTP/1.1" 200 1197
2025-07-25 01:27:03,838  INFO     [etl.handlers.rest_api:380]  No explicit layer_ids in config for source 'Nyckelbiotoper - storskogsbruket'. Discovering all layers from service metadata.
2025-07-25 01:27:03,838  INFO     [etl.handlers.rest_api:427]  Source 'Nyckelbiotoper - storskogsbruket': Will attempt to query 1 layer(s): ['0']
2025-07-25 01:27:03,839  INFO     [etl.handlers.rest_api:659]  üöö storskogsbrukets_nyckelbiotoper
2025-07-25 01:27:03,839  DEBUG    [etl.handlers.rest_api:660]  Querying Layer ID: 0 (Sanitized Name: storskogsbrukets_nyckelbiotoper, Original: Storskogsbrukets_Nyckelbiotoper) from https://geodpags.skogsstyrelsen.se/arcgis/rest/services/Geodataportal/GeodataportalVisaSkogsbruknyckelbiotop/MapServer/0/query
2025-07-25 01:27:03,839  DEBUG    [etl.handlers.rest_api:530]  maxRecordCount not found in layer metadata, using default: 5000
2025-07-25 01:27:03,839  DEBUG    [etl.handlers.rest_api:199]  Applying BBOX: 586206,6551160,647910,6610992 (SRID: 3006)
2025-07-25 01:27:03,840  DEBUG    [etl.handlers.rest_api:565]  Fetching page 1 for layer storskogsbrukets_nyckelbiotoper (offset 0, limit 5000)
2025-07-25 01:27:04,201  DEBUG    [urllib3.connectionpool:544]  https://geodpags.skogsstyrelsen.se:443 "GET /arcgis/rest/services/Geodataportal/GeodataportalVisaSkogsbruknyckelbiotop/MapServer/0/query?where=1%3D1&outFields=%2A&returnGeometry=true&f=geojson&geometry=586206%2C6551160%2C647910%2C6610992&geometryType=esriGeometryEnvelope&inSR=3006&spatialRel=esriSpatialRelIntersects&resultOffset=0&resultRecordCount=5000 HTTP/1.1" 200 None
2025-07-25 01:27:04,381  DEBUG    [etl.handlers.rest_api:279]  üèÅ All features likely retrieved for layer storskogsbrukets_nyckelbiotoper (less than page limit or server maxRecordCount is 0).
2025-07-25 01:27:04,592  INFO     [etl.handlers.rest_api:298]  ‚úÖ storskogsbrukets_nyckelbiotoper: 161 features
2025-07-25 01:27:04,592  DEBUG    [etl.handlers.rest_api:299]  üíæ Successfully saved 161 features for layer storskogsbrukets_nyckelbiotoper to C:\Git\ETL-pipeline\data\staging\SKS\nyckelbiotoper_-_storskogsbruket\storskogsbrukets_nyckelbiotoper.geojson
2025-07-25 01:27:04,593  INFO     [pipeline:623]  üöö Stamn√§t
2025-07-25 01:27:04,594  INFO     [etl.handlers.file:162]  üîó Single resource download mode for 'Stamn√§t' from URL: https://gis-services.metria.se/svkfeed/filer/SVK_STAMNAT.zip
2025-07-25 01:27:04,764  INFO     [etl.utils.http:110]      Derived filename by unquoting URL basename ('https://gis-services.metria.se/svkfeed/filer/SVK_STAMNAT.zip'): SVK_STAMNAT.zip
2025-07-25 01:27:04,771  DEBUG    [etl.handlers.file:247]  Attempting to download: https://gis-services.metria.se/svkfeed/filer/SVK_STAMNAT.zip 
    -> to local file: stamnat.zip 
    -> staging dir: data\staging\SVK\stamnat
2025-07-25 01:27:04,775  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): gis-services.metria.se:443
2025-07-25 01:27:04,866  DEBUG    [urllib3.connectionpool:544]  https://gis-services.metria.se:443 "HEAD /svkfeed/filer/SVK_STAMNAT.zip HTTP/1.1" 200 0
2025-07-25 01:27:04,867  INFO     [etl.utils.io:44]  ‚¨á stamnat.zip (2.3 MB)
2025-07-25 01:27:04,869  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): gis-services.metria.se:443
2025-07-25 01:27:05,005  DEBUG    [urllib3.connectionpool:544]  https://gis-services.metria.se:443 "GET /svkfeed/filer/SVK_STAMNAT.zip HTTP/1.1" 200 2381635
2025-07-25 01:27:05,416  INFO     [etl.utils.io:82]  ‚úÖ stamnat.zip
2025-07-25 01:27:05,417  INFO     [etl.handlers.file:278]  Determined staged_data_type: 'shapefile_collection' for downloaded file 'stamnat.zip'
2025-07-25 01:27:05,417  INFO     [etl.utils.io:88]  üì¶ Extracting stamnat.zip ‚Üí C:\Git\ETL-pipeline\data\staging\SVK\stamnat
2025-07-25 01:27:05,572  INFO     [etl.handlers.file:351]  ‚ûï Extracted and staged archive stamnat.zip to data\staging\SVK\stamnat
2025-07-25 01:27:05,572  INFO     [pipeline:623]  üöö V√§gar
2025-07-25 01:27:05,573  INFO     [etl.handlers.rest_api:68]  üöÄ Initializing RestApiDownloadHandler for source: V√§gar
2025-07-25 01:27:05,573  INFO     [etl.handlers.rest_api:321]  üåê Processing REST API source: 'V√§gar' from URL: https://ext-geodata-nationella.lansstyrelsen.se/arcgis/rest/services/TV/lst_tv_fak01/MapServer
2025-07-25 01:27:05,620  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-nationella.lansstyrelsen.se:443 "GET /arcgis/rest/services/TV/lst_tv_fak01/MapServer?f=json HTTP/1.1" 200 1111
2025-07-25 01:27:05,622  INFO     [etl.handlers.rest_api:346]  Found explicit layer_ids in config: [0, 1, 2, 3, 4, 5, 6, 7] for source 'V√§gar'. Processing only these.
2025-07-25 01:27:05,622  WARNING  [etl.handlers.rest_api:364]  Layer ID '3' specified in config for source 'V√§gar' was not found in the service's layer metadata list. Will attempt to query it using this ID and a placeholder name.
2025-07-25 01:27:05,622  INFO     [etl.handlers.rest_api:427]  Source 'V√§gar': Will attempt to query 8 layer(s): ['0', '1', '2', '3', '4', '5', '6', '7']
2025-07-25 01:27:05,622  INFO     [etl.handlers.rest_api:447]  üöÄ Starting concurrent download of 8 layers
2025-07-25 01:27:05,622  INFO     [etl.utils.concurrent:261]  Starting concurrent download of 8 layers
2025-07-25 01:27:05,623  INFO     [etl.utils.concurrent:121]  Starting concurrent execution of 8 tasks with 5 workers
2025-07-25 01:27:05,635  INFO     [etl.utils.concurrent:215]  Concurrent execution completed: 0/8 successful (0.0%), avg=0.00s, max=0.00s, total=0.00s
2025-07-25 01:27:05,636  INFO     [etl.handlers.rest_api:480]  üèÅ Concurrent downloads completed: 0 successful, 8 failed
2025-07-25 01:27:05,636  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_TV Kulturv√§gar - name 'time' is not defined
2025-07-25 01:27:05,636  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_TV All√©er - name 'time' is not defined
2025-07-25 01:27:05,636  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_TV Artrika v√§gkanter - name 'time' is not defined
2025-07-25 01:27:05,638  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_layer_3_cfg_only - name 'time' is not defined
2025-07-25 01:27:05,638  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_TV Faunapassage f√∂r medelstora d√§ggdjur - J√§rnv√§g - name 'time' is not defined
2025-07-25 01:27:05,638  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_TV Faunapassage f√∂r medelstora d√§ggdjur - Milj√∂ och landskap - name 'time' is not defined
2025-07-25 01:27:05,638  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_TV Faunapassage f√∂r stora d√§ggdjur - J√§rnv√§g - name 'time' is not defined
2025-07-25 01:27:05,638  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_TV Faunapassage f√∂r stora d√§ggdjur - Milj√∂ och landskap - name 'time' is not defined
2025-07-25 01:27:05,638  INFO     [pipeline:623]  üöö √ñvrigt
2025-07-25 01:27:05,640  INFO     [etl.handlers.rest_api:68]  üöÄ Initializing RestApiDownloadHandler for source: √ñvrigt
2025-07-25 01:27:05,641  INFO     [etl.handlers.rest_api:321]  üåê Processing REST API source: '√ñvrigt' from URL: https://ext-geodata-nationella.lansstyrelsen.se/arcgis/rest/services/TV/lst_tv_fak06/MapServer
2025-07-25 01:27:05,702  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-nationella.lansstyrelsen.se:443 "GET /arcgis/rest/services/TV/lst_tv_fak06/MapServer?f=json HTTP/1.1" 200 1362
2025-07-25 01:27:05,702  INFO     [etl.handlers.rest_api:380]  No explicit layer_ids in config for source '√ñvrigt'. Discovering all layers from service metadata.
2025-07-25 01:27:05,703  INFO     [etl.handlers.rest_api:427]  Source '√ñvrigt': Will attempt to query 18 layer(s): ['0', '18', '1', '2', '3', '4', '5', '17', '6', '7', '8', '9', '10', '11', '12', '13', '16', '14']
2025-07-25 01:27:05,703  INFO     [etl.handlers.rest_api:447]  üöÄ Starting concurrent download of 18 layers
2025-07-25 01:27:05,703  INFO     [etl.utils.concurrent:261]  Starting concurrent download of 18 layers
2025-07-25 01:27:05,703  INFO     [etl.utils.concurrent:121]  Starting concurrent execution of 18 tasks with 5 workers
2025-07-25 01:27:05,721  INFO     [etl.utils.concurrent:215]  Concurrent execution completed: 0/18 successful (0.0%), avg=0.00s, max=0.00s, total=0.00s
2025-07-25 01:27:05,722  INFO     [etl.handlers.rest_api:480]  üèÅ Concurrent downloads completed: 0 successful, 18 failed
2025-07-25 01:27:05,723  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_TV Viltst√§ngsel - name 'time' is not defined
2025-07-25 01:27:05,723  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_TV NVDB Bro och tunnel - name 'time' is not defined
2025-07-25 01:27:05,723  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_TV NVDB B√§righet - name 'time' is not defined
2025-07-25 01:27:05,723  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_TV NVDB Cykeln√§t - name 'time' is not defined
2025-07-25 01:27:05,723  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_TV NVDB Driftbidrag - name 'time' is not defined
2025-07-25 01:27:05,724  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_TV NVDB Funktionell v√§gklass - name 'time' is not defined
2025-07-25 01:27:05,724  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_TV NVDB Gatunamn - name 'time' is not defined
2025-07-25 01:27:05,724  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_TV NVDB GCM v√§gtyp - name 'time' is not defined
2025-07-25 01:27:05,724  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_TV NVDB G√•ngfarts omr√•de - name 'time' is not defined
2025-07-25 01:27:05,724  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_TV NVDB Hastighetsgr√§ns - name 'time' is not defined
2025-07-25 01:27:05,725  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_TV NVDB Inskr√§nkningar f√∂r trafik med farligt gods - name 'time' is not defined
2025-07-25 01:27:05,725  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_TV NVDB Rekommenderade v√§gar farligt gods - name 'time' is not defined
2025-07-25 01:27:05,725  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_TV NVDB Saltade v√§gar - name 'time' is not defined
2025-07-25 01:27:05,726  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_TV NVDB Trafikfl√∂den - name 'time' is not defined
2025-07-25 01:27:05,726  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_TV NVDB V√§gbredd - name 'time' is not defined
2025-07-25 01:27:05,726  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_TV NVDB V√§gh√•llare - Enskild-, kommunal- och statlig v√§g - name 'time' is not defined
2025-07-25 01:27:05,726  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_TV NVDB V√§gnummer Text - name 'time' is not defined
2025-07-25 01:27:05,726  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_TV NVDB V√§gnummer - name 'time' is not defined
2025-07-25 01:27:05,727  INFO     [pipeline:623]  üì¶ Starting staging phase
2025-07-25 01:27:05,728  INFO     [pipeline:623]  ‚úÖ Staging GDB reset complete
2025-07-25 01:27:05,828  INFO     [etl.models:127]  ‚úÖ Loaded 53 sources from config\sources.yaml
2025-07-25 01:27:05,830  INFO     [etl.loaders.filegdb:67]  üîÑ Starting FileGDB loading process
2025-07-25 01:27:05,830  INFO     [etl.loaders.filegdb:88]  üÜï Creating new FileGDB: C:\Git\ETL-pipeline\data\staging.gdb
2025-07-25 01:27:07,881  INFO     [numexpr.utils:148]  Note: NumExpr detected 20 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-07-25 01:27:07,882  INFO     [numexpr.utils:160]  NumExpr defaulting to 8 threads.
2025-07-25 01:27:16,130  DEBUG    [arcgis.gis._impl._portalpy:179]  Connecting to portal: u-aec.sokigo.com
2025-07-25 01:27:16,134  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): u-aec.sokigo.com:443
2025-07-25 01:27:16,168  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (2): u-aec.sokigo.com:443
2025-07-25 01:27:16,216  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (3): u-aec.sokigo.com:443
2025-07-25 01:27:16,256  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (4): u-aec.sokigo.com:443
2025-07-25 01:27:16,297  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): u-aec.sokigo.com:443
2025-07-25 01:27:16,334  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (2): u-aec.sokigo.com:443
2025-07-25 01:27:19,830  INFO     [etl.loaders.filegdb:93]  ‚úÖ Successfully created GDB: C:\Git\ETL-pipeline\data\staging.gdb
2025-07-25 01:27:19,831  INFO     [etl.loaders.filegdb:77]  üìã Processing 53 configured sources
2025-07-25 01:27:19,833  INFO     [etl.loaders.filegdb:108]  üîÑ Processing source: F√∂rsvarsmakten - Rikst√§ckande geodata (Authority: FM)
2025-07-25 01:27:19,834  INFO     [etl.loaders.filegdb:135]  üîç Processing source 'F√∂rsvarsmakten - Rikst√§ckande geodata': staged_data_type='shapefile_collection', normalized='shapefile_collection'
2025-07-25 01:27:19,835  INFO     [etl.loaders.filegdb:155]  üìê Handling shapefile collection source 'F√∂rsvarsmakten - Rikst√§ckande geodata'
2025-07-25 01:27:19,842  INFO     [etl.loaders.shapefile_loader:103]  Found 1 item(s) to process for source 'F√∂rsvarsmakten - Rikst√§ckande geodata'
2025-07-25 01:27:19,850  INFO     [etl.loaders.shapefile_loader:145]  üìê Found 12 shapefile(s) in item dir 'shp'.
2025-07-25 01:27:19,877  INFO     [etl.loaders.shapefile_loader:180]  üì• Copying SHP ('L√•gflygningsomr√•de med p√•verkansomr√•de.shp') ‚Üí GDB:/'fm_lagflygningsomrade_med_paverkansomrade' (Authority: 'FM')
2025-07-25 01:27:21,481  INFO     [etl.loaders.shapefile_loader:192]  ‚úÖ SUCCESS: Copied shapefile 'L√•gflygningsomr√•de med p√•verkansomr√•de.shp' to 'fm_lagflygningsomrade_med_paverkansomrade'
2025-07-25 01:27:21,681  INFO     [etl.loaders.shapefile_loader:180]  üì• Copying SHP ('MSA-omr√•de.shp') ‚Üí GDB:/'fm_msa_omrade' (Authority: 'FM')
2025-07-25 01:27:22,442  INFO     [etl.loaders.shapefile_loader:192]  ‚úÖ SUCCESS: Copied shapefile 'MSA-omr√•de.shp' to 'fm_msa_omrade'
2025-07-25 01:27:22,599  INFO     [etl.loaders.shapefile_loader:180]  üì• Copying SHP ('Omr√•de av betydelse p√• land.shp') ‚Üí GDB:/'fm_omrade_av_betydelse_pa_land' (Authority: 'FM')
2025-07-25 01:27:23,372  INFO     [etl.loaders.shapefile_loader:192]  ‚úÖ SUCCESS: Copied shapefile 'Omr√•de av betydelse p√• land.shp' to 'fm_omrade_av_betydelse_pa_land'
2025-07-25 01:27:23,559  INFO     [etl.loaders.shapefile_loader:180]  üì• Copying SHP ('Omr√•de med s√§rskilt behov av hinderfrihet.shp') ‚Üí GDB:/'fm_omrade_med_sarskilt_behov_av_hinderfrihet' (Authority: 'FM')
2025-07-25 01:27:24,742  INFO     [etl.loaders.shapefile_loader:192]  ‚úÖ SUCCESS: Copied shapefile 'Omr√•de med s√§rskilt behov av hinderfrihet.shp' to 'fm_omrade_med_sarskilt_behov_av_hinderfrihet'
2025-07-25 01:27:24,916  INFO     [etl.loaders.shapefile_loader:180]  üì• Copying SHP ('P√•verkansomr√•de civil flygplats.shp') ‚Üí GDB:/'fm_paverkansomrade_civil_flygplats' (Authority: 'FM')
2025-07-25 01:27:25,641  INFO     [etl.loaders.shapefile_loader:192]  ‚úÖ SUCCESS: Copied shapefile 'P√•verkansomr√•de civil flygplats.shp' to 'fm_paverkansomrade_civil_flygplats'
2025-07-25 01:27:25,808  INFO     [etl.loaders.shapefile_loader:180]  üì• Copying SHP ('P√•verkansomr√•de f√∂r buller eller annan risk.shp') ‚Üí GDB:/'fm_paverkansomrade_for_buller_eller_annan_risk' (Authority: 'FM')
2025-07-25 01:27:26,825  INFO     [etl.loaders.shapefile_loader:192]  ‚úÖ SUCCESS: Copied shapefile 'P√•verkansomr√•de f√∂r buller eller annan risk.shp' to 'fm_paverkansomrade_for_buller_eller_annan_risk'
2025-07-25 01:27:26,992  INFO     [etl.loaders.shapefile_loader:180]  üì• Copying SHP ('P√•verkansomr√•de v√§derradar.shp') ‚Üí GDB:/'fm_paverkansomrade_vaderradar' (Authority: 'FM')
2025-07-25 01:27:27,892  INFO     [etl.loaders.shapefile_loader:192]  ‚úÖ SUCCESS: Copied shapefile 'P√•verkansomr√•de v√§derradar.shp' to 'fm_paverkansomrade_vaderradar'
2025-07-25 01:27:28,060  INFO     [etl.loaders.shapefile_loader:180]  üì• Copying SHP ('P√•verkansomr√•de √∂vrigt.shp') ‚Üí GDB:/'fm_paverkansomrade_ovrigt' (Authority: 'FM')
2025-07-25 01:27:28,820  INFO     [etl.loaders.shapefile_loader:192]  ‚úÖ SUCCESS: Copied shapefile 'P√•verkansomr√•de √∂vrigt.shp' to 'fm_paverkansomrade_ovrigt'
2025-07-25 01:27:29,001  INFO     [etl.loaders.shapefile_loader:180]  üì• Copying SHP ('Riksintresse i havet (sj√∂√∂vningsomr√•de).shp') ‚Üí GDB:/'fm_riksintresse_i_havet_sjoovningsomrade' (Authority: 'FM')
2025-07-25 01:27:29,891  INFO     [etl.loaders.shapefile_loader:192]  ‚úÖ SUCCESS: Copied shapefile 'Riksintresse i havet (sj√∂√∂vningsomr√•de).shp' to 'fm_riksintresse_i_havet_sjoovningsomrade'
2025-07-25 01:27:30,050  INFO     [etl.loaders.shapefile_loader:180]  üì• Copying SHP ('Riksintresse p√• land.shp') ‚Üí GDB:/'fm_riksintresse_pa_land' (Authority: 'FM')
2025-07-25 01:27:30,820  INFO     [etl.loaders.shapefile_loader:192]  ‚úÖ SUCCESS: Copied shapefile 'Riksintresse p√• land.shp' to 'fm_riksintresse_pa_land'
2025-07-25 01:27:30,975  INFO     [etl.loaders.shapefile_loader:180]  üì• Copying SHP ('Stoppomr√•de f√∂r h√∂ga objekt.shp') ‚Üí GDB:/'fm_stoppomrade_for_hoga_objekt' (Authority: 'FM')
2025-07-25 01:27:31,705  INFO     [etl.loaders.shapefile_loader:192]  ‚úÖ SUCCESS: Copied shapefile 'Stoppomr√•de f√∂r h√∂ga objekt.shp' to 'fm_stoppomrade_for_hoga_objekt'
2025-07-25 01:27:31,793  INFO     [etl.loaders.shapefile_loader:180]  üì• Copying SHP ('Stoppomr√•de f√∂r vindkraftverk.shp') ‚Üí GDB:/'fm_stoppomrade_for_vindkraftverk' (Authority: 'FM')
2025-07-25 01:27:32,492  INFO     [etl.loaders.shapefile_loader:192]  ‚úÖ SUCCESS: Copied shapefile 'Stoppomr√•de f√∂r vindkraftverk.shp' to 'fm_stoppomrade_for_vindkraftverk'
2025-07-25 01:27:32,665  INFO     [etl.loaders.filegdb:108]  üîÑ Processing source: Naturv√•rdsverket - Naturv√•rdsregistret (Authority: NVV)
2025-07-25 01:27:32,667  INFO     [etl.loaders.filegdb:135]  üîç Processing source 'Naturv√•rdsverket - Naturv√•rdsregistret': staged_data_type='shapefile_collection', normalized='shapefile_collection'
2025-07-25 01:27:32,668  INFO     [etl.loaders.filegdb:155]  üìê Handling shapefile collection source 'Naturv√•rdsverket - Naturv√•rdsregistret'
2025-07-25 01:27:32,670  WARNING  [etl.loaders.shapefile_loader:68]  No staging directory found for source 'Naturv√•rdsverket - Naturv√•rdsregistret' at C:\Git\ETL-pipeline\data\staging\NVV\naturvardsverket_-_naturvardsregistret
2025-07-25 01:27:32,671  INFO     [etl.loaders.filegdb:108]  üîÑ Processing source: Milj√∂riskomr√•de (Authority: LST)
2025-07-25 01:27:32,672  INFO     [etl.loaders.filegdb:135]  üîç Processing source 'Milj√∂riskomr√•de': staged_data_type='gpkg', normalized='gpkg'
2025-07-25 01:27:32,675  INFO     [etl.loaders.filegdb:145]  üì¶ Source 'Milj√∂riskomr√•de' configured for GPKG - using GPKG loader exclusively
2025-07-25 01:27:32,677  INFO     [etl.loaders.gpkg_loader:166]  üì¶ Processing GeoPackage: miljoriskomrade.gpkg (Authority: 'LST', Include Filter: None)
2025-07-25 01:27:39,222  INFO     [etl.loaders.gpkg_loader:186]  Found 1 feature classes in miljoriskomrade.gpkg: ['main.lst_lst_miljoriskomrade']
2025-07-25 01:27:39,252  INFO     [etl.loaders.gpkg_loader:242]  üì¶ Processing 1 valid feature classes from miljoriskomrade.gpkg
2025-07-25 01:27:39,253  INFO     [etl.loaders.gpkg_loader:144]  Stripped 'main.' from 'main.lst_lst_miljoriskomrade' ‚Üí 'lst_lst_miljoriskomrade' for output naming
2025-07-25 01:27:39,276  INFO     [etl.loaders.gpkg_loader:94]  üì• Copying GPKG FC ('main.lst_lst_miljoriskomrade') ‚Üí GDB:/'lst_lst_miljoriskomrade'
2025-07-25 01:27:40,185  INFO     [etl.loaders.gpkg_loader:35]  ‚úÖ SUCCESS: Copied GPKG FC 'main.lst_lst_miljoriskomrade' to 'lst_lst_miljoriskomrade'
2025-07-25 01:27:40,471  INFO     [etl.loaders.filegdb:108]  üîÑ Processing source: Vindkraftskollen: Vindkraftverk (Authority: LST)
2025-07-25 01:27:40,473  INFO     [etl.loaders.filegdb:135]  üîç Processing source 'Vindkraftskollen: Vindkraftverk': staged_data_type='gpkg', normalized='gpkg'
2025-07-25 01:27:40,475  INFO     [etl.loaders.filegdb:145]  üì¶ Source 'Vindkraftskollen: Vindkraftverk' configured for GPKG - using GPKG loader exclusively
2025-07-25 01:27:40,477  INFO     [etl.loaders.gpkg_loader:166]  üì¶ Processing GeoPackage: vindkraftskollen_vindkraftverk.gpkg (Authority: 'LST', Include Filter: None)
2025-07-25 01:27:41,634  INFO     [etl.loaders.gpkg_loader:186]  Found 1 feature classes in vindkraftskollen_vindkraftverk.gpkg: ['main.lst_vbk_vindkraftverk']
2025-07-25 01:27:41,661  INFO     [etl.loaders.gpkg_loader:242]  üì¶ Processing 1 valid feature classes from vindkraftskollen_vindkraftverk.gpkg
2025-07-25 01:27:41,663  INFO     [etl.loaders.gpkg_loader:144]  Stripped 'main.' from 'main.lst_vbk_vindkraftverk' ‚Üí 'lst_vbk_vindkraftverk' for output naming
2025-07-25 01:27:41,698  INFO     [etl.loaders.gpkg_loader:94]  üì• Copying GPKG FC ('main.lst_vbk_vindkraftverk') ‚Üí GDB:/'lst_vbk_vindkraftverk'
2025-07-25 01:27:54,462  INFO     [etl.loaders.gpkg_loader:35]  ‚úÖ SUCCESS: Copied GPKG FC 'main.lst_vbk_vindkraftverk' to 'lst_vbk_vindkraftverk'
2025-07-25 01:27:54,784  INFO     [etl.loaders.filegdb:108]  üîÑ Processing source: Vindkraftskollen: Projekteringsomr√•den (Authority: LST)
2025-07-25 01:27:54,784  INFO     [etl.loaders.filegdb:135]  üîç Processing source 'Vindkraftskollen: Projekteringsomr√•den': staged_data_type='gpkg', normalized='gpkg'
2025-07-25 01:27:54,786  INFO     [etl.loaders.filegdb:145]  üì¶ Source 'Vindkraftskollen: Projekteringsomr√•den' configured for GPKG - using GPKG loader exclusively
2025-07-25 01:27:54,788  INFO     [etl.loaders.gpkg_loader:166]  üì¶ Processing GeoPackage: vindkraftskollen_projekteringsomraden.gpkg (Authority: 'LST', Include Filter: None)
2025-07-25 01:27:56,104  INFO     [etl.loaders.gpkg_loader:186]  Found 1 feature classes in vindkraftskollen_projekteringsomraden.gpkg: ['main.lst_vbk_projekteringsomraden']
2025-07-25 01:27:56,118  INFO     [etl.loaders.gpkg_loader:242]  üì¶ Processing 1 valid feature classes from vindkraftskollen_projekteringsomraden.gpkg
2025-07-25 01:27:56,119  INFO     [etl.loaders.gpkg_loader:144]  Stripped 'main.' from 'main.lst_vbk_projekteringsomraden' ‚Üí 'lst_vbk_projekteringsomraden' for output naming
2025-07-25 01:27:56,134  INFO     [etl.loaders.gpkg_loader:94]  üì• Copying GPKG FC ('main.lst_vbk_projekteringsomraden') ‚Üí GDB:/'lst_vbk_projekteringsomraden'
2025-07-25 01:27:58,600  INFO     [etl.loaders.gpkg_loader:35]  ‚úÖ SUCCESS: Copied GPKG FC 'main.lst_vbk_projekteringsomraden' to 'lst_vbk_projekteringsomraden'
2025-07-25 01:27:58,945  INFO     [etl.loaders.filegdb:108]  üîÑ Processing source: Potentiellt f√∂rorenade omr√•den (Authority: LST)
2025-07-25 01:27:58,947  INFO     [etl.loaders.filegdb:135]  üîç Processing source 'Potentiellt f√∂rorenade omr√•den': staged_data_type='shapefile_collection', normalized='shapefile_collection'
2025-07-25 01:27:58,949  INFO     [etl.loaders.filegdb:155]  üìê Handling shapefile collection source 'Potentiellt f√∂rorenade omr√•den'
2025-07-25 01:27:58,956  INFO     [etl.loaders.shapefile_loader:103]  Found 1 item(s) to process for source 'Potentiellt f√∂rorenade omr√•den'
2025-07-25 01:27:58,963  INFO     [etl.loaders.shapefile_loader:145]  üìê Found 1 shapefile(s) in item dir 'potentiellt_fororenade_omraden'.
2025-07-25 01:27:58,990  INFO     [etl.loaders.shapefile_loader:180]  üì• Copying SHP ('EBH_Potentiellt_fororenade_omraden.shp') ‚Üí GDB:/'lst_ebh_potentiellt_fororenade_omraden' (Authority: 'LST')
2025-07-25 01:28:04,332  INFO     [etl.loaders.shapefile_loader:192]  ‚úÖ SUCCESS: Copied shapefile 'EBH_Potentiellt_fororenade_omraden.shp' to 'lst_ebh_potentiellt_fororenade_omraden'
2025-07-25 01:28:04,461  INFO     [etl.loaders.filegdb:108]  üîÑ Processing source: Riksintressen (Authority: LST)
2025-07-25 01:28:04,462  INFO     [etl.loaders.filegdb:135]  üîç Processing source 'Riksintressen': staged_data_type='geojson', normalized='geojson'
2025-07-25 01:28:04,466  INFO     [etl.loaders.filegdb:262]  üåç Found 1 JSON/GeoJSON file(s) for source 'Riksintressen'.
2025-07-25 01:28:04,494  INFO     [etl.loaders.geojson_loader:53]  üîç Detected geometry types in lst_riksintresse_rorligt_friluftsliv_mb4kap_1plus2.geojson: {'Polygon', 'MultiPolygon'}
2025-07-25 01:28:04,494  WARNING  [etl.loaders.geojson_loader:79]  ‚ö†Ô∏è Mixed geometry types found in lst_riksintresse_rorligt_friluftsliv_mb4kap_1plus2.geojson: {'Polygon', 'MultiPolygon'}. Using POLYGON as default.
2025-07-25 01:28:04,495  INFO     [etl.loaders.geojson_loader:129]  üìç Detected geometry type: POLYGON for lst_riksintresse_rorligt_friluftsliv_mb4kap_1plus2.geojson
2025-07-25 01:28:04,496  INFO     [etl.loaders.geojson_loader:142]  üì• Converting JSON/GeoJSON ('lst_riksintresse_rorligt_friluftsliv_mb4kap_1plus2.geojson') ‚Üí GDB:/'lst_riksintresse_rorligt_friluftsliv_mb4kap_1plus2_polygon' (Authority: 'LST', Geom: POLYGON)
2025-07-25 01:28:06,731  INFO     [etl.loaders.geojson_loader:166]  ‚úÖ SUCCESS: Created FC 'lst_riksintresse_rorligt_friluftsliv_mb4kap_1plus2_polygon' with 6 records, geometry type: Polygon
2025-07-25 01:28:06,734  INFO     [etl.loaders.filegdb:108]  üîÑ Processing source: Riksintressen - Vindbruk (Authority: LST)
2025-07-25 01:28:06,735  INFO     [etl.loaders.filegdb:135]  üîç Processing source 'Riksintressen - Vindbruk': staged_data_type='geojson', normalized='geojson'
2025-07-25 01:28:06,737  WARNING  [etl.loaders.filegdb:250]  ‚ö†Ô∏è Staging directory not found for JSON/GeoJSON source 'Riksintressen - Vindbruk': C:\Git\ETL-pipeline\data\staging\LST\riksintressen_-_vindbruk
2025-07-25 01:28:06,738  INFO     [etl.loaders.filegdb:108]  üîÑ Processing source: LstD F√∂reskrifter (Authority: LSTD)
2025-07-25 01:28:06,739  INFO     [etl.loaders.filegdb:135]  üîç Processing source 'LstD F√∂reskrifter': staged_data_type='geojson', normalized='geojson'
2025-07-25 01:28:06,744  INFO     [etl.loaders.filegdb:262]  üåç Found 1 JSON/GeoJSON file(s) for source 'LstD F√∂reskrifter'.
2025-07-25 01:28:06,852  INFO     [etl.loaders.geojson_loader:53]  üîç Detected geometry types in lstd_sjotrafikforeskrifter.geojson: {'Polygon'}
2025-07-25 01:28:06,854  INFO     [etl.loaders.geojson_loader:71]  üîç Mapping Polygon ‚Üí POLYGON for lstd_sjotrafikforeskrifter.geojson
2025-07-25 01:28:06,857  INFO     [etl.loaders.geojson_loader:129]  üìç Detected geometry type: POLYGON for lstd_sjotrafikforeskrifter.geojson
2025-07-25 01:28:06,859  INFO     [etl.loaders.geojson_loader:142]  üì• Converting JSON/GeoJSON ('lstd_sjotrafikforeskrifter.geojson') ‚Üí GDB:/'lstd_sjotrafikforeskrifter_polygon' (Authority: 'LSTD', Geom: POLYGON)
2025-07-25 01:28:08,340  INFO     [etl.loaders.geojson_loader:166]  ‚úÖ SUCCESS: Created FC 'lstd_sjotrafikforeskrifter_polygon' with 61 records, geometry type: Polygon
2025-07-25 01:28:08,342  INFO     [etl.loaders.filegdb:108]  üîÑ Processing source: LstD Fysisk planering (Authority: LSTD)
2025-07-25 01:28:08,344  INFO     [etl.loaders.filegdb:135]  üîç Processing source 'LstD Fysisk planering': staged_data_type='geojson', normalized='geojson'
2025-07-25 01:28:08,345  WARNING  [etl.loaders.filegdb:250]  ‚ö†Ô∏è Staging directory not found for JSON/GeoJSON source 'LstD Fysisk planering': C:\Git\ETL-pipeline\data\staging\LSTD\lstd_fysisk_planering
2025-07-25 01:28:08,346  INFO     [etl.loaders.filegdb:108]  üîÑ Processing source: LstD Ett rikt odlingslandskap (Authority: LSTD)
2025-07-25 01:28:08,347  INFO     [etl.loaders.filegdb:135]  üîç Processing source 'LstD Ett rikt odlingslandskap': staged_data_type='geojson', normalized='geojson'
2025-07-25 01:28:08,349  WARNING  [etl.loaders.filegdb:250]  ‚ö†Ô∏è Staging directory not found for JSON/GeoJSON source 'LstD Ett rikt odlingslandskap': C:\Git\ETL-pipeline\data\staging\LSTD\lstd_ett_rikt_odlingslandskap
2025-07-25 01:28:08,353  INFO     [etl.loaders.filegdb:108]  üîÑ Processing source: LstD Friluftsliv (Authority: LSTD)
2025-07-25 01:28:08,355  INFO     [etl.loaders.filegdb:135]  üîç Processing source 'LstD Friluftsliv': staged_data_type='geojson', normalized='geojson'
2025-07-25 01:28:08,357  WARNING  [etl.loaders.filegdb:250]  ‚ö†Ô∏è Staging directory not found for JSON/GeoJSON source 'LstD Friluftsliv': C:\Git\ETL-pipeline\data\staging\LSTD\lstd_friluftsliv
2025-07-25 01:28:08,358  INFO     [etl.loaders.filegdb:108]  üîÑ Processing source: LstD God bebyggd milj√∂ (Authority: LSTD)
2025-07-25 01:28:08,361  INFO     [etl.loaders.filegdb:135]  üîç Processing source 'LstD God bebyggd milj√∂': staged_data_type='geojson', normalized='geojson'
2025-07-25 01:28:08,365  INFO     [etl.loaders.filegdb:262]  üåç Found 1 JSON/GeoJSON file(s) for source 'LstD God bebyggd milj√∂'.
2025-07-25 01:28:08,377  INFO     [etl.loaders.geojson_loader:53]  üîç Detected geometry types in lstd_gi_opaverkade_omraden_-_avgransning.geojson: {'Polygon'}
2025-07-25 01:28:08,379  INFO     [etl.loaders.geojson_loader:71]  üîç Mapping Polygon ‚Üí POLYGON for lstd_gi_opaverkade_omraden_-_avgransning.geojson
2025-07-25 01:28:08,380  INFO     [etl.loaders.geojson_loader:129]  üìç Detected geometry type: POLYGON for lstd_gi_opaverkade_omraden_-_avgransning.geojson
2025-07-25 01:28:08,383  INFO     [etl.loaders.geojson_loader:142]  üì• Converting JSON/GeoJSON ('lstd_gi_opaverkade_omraden_-_avgransning.geojson') ‚Üí GDB:/'lstd_gi_opaverkade_omraden_avgransning_polygon' (Authority: 'LSTD', Geom: POLYGON)
2025-07-25 01:28:09,499  INFO     [etl.loaders.geojson_loader:166]  ‚úÖ SUCCESS: Created FC 'lstd_gi_opaverkade_omraden_avgransning_polygon' with 10 records, geometry type: Polygon
2025-07-25 01:28:09,501  INFO     [etl.loaders.filegdb:108]  üîÑ Processing source: LstD Hav i balans (Authority: LSTD)
2025-07-25 01:28:09,501  INFO     [etl.loaders.filegdb:135]  üîç Processing source 'LstD Hav i balans': staged_data_type='geojson', normalized='geojson'
2025-07-25 01:28:09,502  INFO     [etl.loaders.filegdb:276]  ‚ÑπÔ∏è No JSON/GeoJSON files found for source 'LstD Hav i balans'.
2025-07-25 01:28:09,502  INFO     [etl.loaders.filegdb:108]  üîÑ Processing source: LstD Levande sj√∂ar och vattendrag (Authority: LSTD)
2025-07-25 01:28:09,503  INFO     [etl.loaders.filegdb:135]  üîç Processing source 'LstD Levande sj√∂ar och vattendrag': staged_data_type='geojson', normalized='geojson'
2025-07-25 01:28:09,503  WARNING  [etl.loaders.filegdb:250]  ‚ö†Ô∏è Staging directory not found for JSON/GeoJSON source 'LstD Levande sj√∂ar och vattendrag': C:\Git\ETL-pipeline\data\staging\LSTD\lstd_levande_sjoar_och_vattendrag
2025-07-25 01:28:09,504  INFO     [etl.loaders.filegdb:108]  üîÑ Processing source: LstD Levande skogar (Authority: LSTD)
2025-07-25 01:28:09,504  INFO     [etl.loaders.filegdb:135]  üîç Processing source 'LstD Levande skogar': staged_data_type='geojson', normalized='geojson'
2025-07-25 01:28:09,505  INFO     [etl.loaders.filegdb:262]  üåç Found 1 JSON/GeoJSON file(s) for source 'LstD Levande skogar'.
2025-07-25 01:28:10,515  INFO     [etl.loaders.geojson_loader:53]  üîç Detected geometry types in lstd_gi_vardekarnor_adellovmiljoer_inkl_skyddsvarda_trad.geojson: {'Polygon'}
2025-07-25 01:28:10,515  INFO     [etl.loaders.geojson_loader:71]  üîç Mapping Polygon ‚Üí POLYGON for lstd_gi_vardekarnor_adellovmiljoer_inkl_skyddsvarda_trad.geojson
2025-07-25 01:28:10,538  INFO     [etl.loaders.geojson_loader:129]  üìç Detected geometry type: POLYGON for lstd_gi_vardekarnor_adellovmiljoer_inkl_skyddsvarda_trad.geojson
2025-07-25 01:28:10,540  INFO     [etl.loaders.geojson_loader:142]  üì• Converting JSON/GeoJSON ('lstd_gi_vardekarnor_adellovmiljoer_inkl_skyddsvarda_trad.geojson') ‚Üí GDB:/'lstd_gi_vardekarnor_adellovmiljoer_inkl_skyddsvarda_trad_polygon' (Authority: 'LSTD', Geom: POLYGON)
2025-07-25 01:29:20,425  INFO     [etl.loaders.geojson_loader:166]  ‚úÖ SUCCESS: Created FC 'lstd_gi_vardekarnor_adellovmiljoer_inkl_skyddsvarda_trad_polygon' with 2783 records, geometry type: Polygon
2025-07-25 01:29:20,426  INFO     [etl.loaders.filegdb:108]  üîÑ Processing source: LstD Klimat (Authority: LSTD)
2025-07-25 01:29:20,427  INFO     [etl.loaders.filegdb:135]  üîç Processing source 'LstD Klimat': staged_data_type='geojson', normalized='geojson'
2025-07-25 01:29:20,428  WARNING  [etl.loaders.filegdb:250]  ‚ö†Ô∏è Staging directory not found for JSON/GeoJSON source 'LstD Klimat': C:\Git\ETL-pipeline\data\staging\LSTD\lstd_klimat
2025-07-25 01:29:20,429  INFO     [etl.loaders.filegdb:108]  üîÑ Processing source: LstD Kulturmilj√∂ (Authority: LSTD)
2025-07-25 01:29:20,429  INFO     [etl.loaders.filegdb:135]  üîç Processing source 'LstD Kulturmilj√∂': staged_data_type='geojson', normalized='geojson'
2025-07-25 01:29:20,430  INFO     [etl.loaders.filegdb:262]  üåç Found 1 JSON/GeoJSON file(s) for source 'LstD Kulturmilj√∂'.
2025-07-25 01:29:20,434  INFO     [etl.loaders.geojson_loader:53]  üîç Detected geometry types in lstd_anmalningsplikt_enligt_kml_3_6.geojson: {'Polygon'}
2025-07-25 01:29:20,435  INFO     [etl.loaders.geojson_loader:71]  üîç Mapping Polygon ‚Üí POLYGON for lstd_anmalningsplikt_enligt_kml_3_6.geojson
2025-07-25 01:29:20,436  INFO     [etl.loaders.geojson_loader:129]  üìç Detected geometry type: POLYGON for lstd_anmalningsplikt_enligt_kml_3_6.geojson
2025-07-25 01:29:20,437  INFO     [etl.loaders.geojson_loader:142]  üì• Converting JSON/GeoJSON ('lstd_anmalningsplikt_enligt_kml_3_6.geojson') ‚Üí GDB:/'lstd_anmalningsplikt_enligt_kml_3_6_polygon' (Authority: 'LSTD', Geom: POLYGON)
2025-07-25 01:29:21,360  INFO     [etl.loaders.geojson_loader:166]  ‚úÖ SUCCESS: Created FC 'lstd_anmalningsplikt_enligt_kml_3_6_polygon' with 68 records, geometry type: Polygon
2025-07-25 01:29:21,361  INFO     [etl.loaders.filegdb:108]  üîÑ Processing source: LstD Markavvattning (Authority: LSTD)
2025-07-25 01:29:21,362  INFO     [etl.loaders.filegdb:135]  üîç Processing source 'LstD Markavvattning': staged_data_type='geojson', normalized='geojson'
2025-07-25 01:29:21,363  WARNING  [etl.loaders.filegdb:250]  ‚ö†Ô∏è Staging directory not found for JSON/GeoJSON source 'LstD Markavvattning': C:\Git\ETL-pipeline\data\staging\LSTD\lstd_markavvattning
2025-07-25 01:29:21,364  INFO     [etl.loaders.filegdb:108]  üîÑ Processing source: LstD Markstabilitet (Authority: LSTD)
2025-07-25 01:29:21,364  INFO     [etl.loaders.filegdb:135]  üîç Processing source 'LstD Markstabilitet': staged_data_type='geojson', normalized='geojson'
2025-07-25 01:29:21,366  INFO     [etl.loaders.filegdb:262]  üåç Found 1 JSON/GeoJSON file(s) for source 'LstD Markstabilitet'.
2025-07-25 01:29:21,406  INFO     [etl.loaders.geojson_loader:53]  üîç Detected geometry types in lstd_msb_oversiktlig_stabilitetskartering_-_90-talet_-_finkorniga_jordarter.geojson: {'Polygon'}
2025-07-25 01:29:21,407  INFO     [etl.loaders.geojson_loader:71]  üîç Mapping Polygon ‚Üí POLYGON for lstd_msb_oversiktlig_stabilitetskartering_-_90-talet_-_finkorniga_jordarter.geojson
2025-07-25 01:29:21,409  INFO     [etl.loaders.geojson_loader:129]  üìç Detected geometry type: POLYGON for lstd_msb_oversiktlig_stabilitetskartering_-_90-talet_-_finkorniga_jordarter.geojson
2025-07-25 01:29:21,410  INFO     [etl.loaders.geojson_loader:142]  üì• Converting JSON/GeoJSON ('lstd_msb_oversiktlig_stabilitetskartering_-_90-talet_-_finkorniga_jordarter.geojson') ‚Üí GDB:/'lstd_msb_oversiktlig_stabilitetskartering_90_talet_finkorniga_jordarter_polygon' (Authority: 'LSTD', Geom: POLYGON)
2025-07-25 01:29:22,439  INFO     [etl.loaders.geojson_loader:166]  ‚úÖ SUCCESS: Created FC 'lstd_msb_oversiktlig_stabilitetskartering_90_talet_finkorniga_jordarter_polygon' with 52 records, geometry type: Polygon
2025-07-25 01:29:22,440  INFO     [etl.loaders.filegdb:108]  üîÑ Processing source: LstD Naturkartl√§ggning (Authority: LSTD)
2025-07-25 01:29:22,441  INFO     [etl.loaders.filegdb:135]  üîç Processing source 'LstD Naturkartl√§ggning': staged_data_type='geojson', normalized='geojson'
2025-07-25 01:29:22,442  INFO     [etl.loaders.filegdb:262]  üåç Found 1 JSON/GeoJSON file(s) for source 'LstD Naturkartl√§ggning'.
2025-07-25 01:29:22,481  INFO     [etl.loaders.geojson_loader:53]  üîç Detected geometry types in lstd_sormlands_natur_-_naturvardsprogram_1991.geojson: {'Polygon'}
2025-07-25 01:29:22,481  INFO     [etl.loaders.geojson_loader:71]  üîç Mapping Polygon ‚Üí POLYGON for lstd_sormlands_natur_-_naturvardsprogram_1991.geojson
2025-07-25 01:29:22,483  INFO     [etl.loaders.geojson_loader:129]  üìç Detected geometry type: POLYGON for lstd_sormlands_natur_-_naturvardsprogram_1991.geojson
2025-07-25 01:29:22,484  INFO     [etl.loaders.geojson_loader:142]  üì• Converting JSON/GeoJSON ('lstd_sormlands_natur_-_naturvardsprogram_1991.geojson') ‚Üí GDB:/'lstd_sormlands_natur_naturvardsprogram_1991_polygon' (Authority: 'LSTD', Geom: POLYGON)
2025-07-25 01:29:23,871  INFO     [etl.loaders.geojson_loader:166]  ‚úÖ SUCCESS: Created FC 'lstd_sormlands_natur_naturvardsprogram_1991_polygon' with 245 records, geometry type: Polygon
2025-07-25 01:29:23,872  INFO     [etl.loaders.filegdb:108]  üîÑ Processing source: LstD Skog och tr√§d (Authority: LSTD)
2025-07-25 01:29:23,873  INFO     [etl.loaders.filegdb:135]  üîç Processing source 'LstD Skog och tr√§d': staged_data_type='geojson', normalized='geojson'
2025-07-25 01:29:23,873  WARNING  [etl.loaders.filegdb:250]  ‚ö†Ô∏è Staging directory not found for JSON/GeoJSON source 'LstD Skog och tr√§d': C:\Git\ETL-pipeline\data\staging\LSTD\lstd_skog_och_trad
2025-07-25 01:29:23,874  INFO     [etl.loaders.filegdb:108]  üîÑ Processing source: LstD GI V√§rdetrakter v√•tmark (Authority: LSTD)
2025-07-25 01:29:23,874  INFO     [etl.loaders.filegdb:135]  üîç Processing source 'LstD GI V√§rdetrakter v√•tmark': staged_data_type='geojson', normalized='geojson'
2025-07-25 01:29:23,874  INFO     [etl.loaders.filegdb:262]  üåç Found 1 JSON/GeoJSON file(s) for source 'LstD GI V√§rdetrakter v√•tmark'.
2025-07-25 01:29:23,879  INFO     [etl.loaders.geojson_loader:53]  üîç Detected geometry types in lstd_gi_vardetrakter_vatmark.geojson: {'Polygon'}
2025-07-25 01:29:23,879  INFO     [etl.loaders.geojson_loader:71]  üîç Mapping Polygon ‚Üí POLYGON for lstd_gi_vardetrakter_vatmark.geojson
2025-07-25 01:29:23,879  INFO     [etl.loaders.geojson_loader:129]  üìç Detected geometry type: POLYGON for lstd_gi_vardetrakter_vatmark.geojson
2025-07-25 01:29:23,880  INFO     [etl.loaders.geojson_loader:142]  üì• Converting JSON/GeoJSON ('lstd_gi_vardetrakter_vatmark.geojson') ‚Üí GDB:/'lstd_gi_vardetrakter_vatmark_polygon' (Authority: 'LSTD', Geom: POLYGON)
2025-07-25 01:29:24,748  INFO     [etl.loaders.geojson_loader:166]  ‚úÖ SUCCESS: Created FC 'lstd_gi_vardetrakter_vatmark_polygon' with 7 records, geometry type: Polygon
2025-07-25 01:29:24,750  INFO     [etl.loaders.filegdb:108]  üîÑ Processing source: LstD Strandskydd (Authority: LSTD)
2025-07-25 01:29:24,751  INFO     [etl.loaders.filegdb:135]  üîç Processing source 'LstD Strandskydd': staged_data_type='geojson', normalized='geojson'
2025-07-25 01:29:24,751  WARNING  [etl.loaders.filegdb:250]  ‚ö†Ô∏è Staging directory not found for JSON/GeoJSON source 'LstD Strandskydd': C:\Git\ETL-pipeline\data\staging\LSTD\lstd_strandskydd
2025-07-25 01:29:24,752  INFO     [etl.loaders.filegdb:108]  üîÑ Processing source: Skyddsrum (Authority: MSB)
2025-07-25 01:29:24,752  INFO     [etl.loaders.filegdb:135]  üîç Processing source 'Skyddsrum': staged_data_type='shapefile_collection', normalized='shapefile_collection'
2025-07-25 01:29:24,753  INFO     [etl.loaders.filegdb:155]  üìê Handling shapefile collection source 'Skyddsrum'
2025-07-25 01:29:24,757  INFO     [etl.loaders.shapefile_loader:103]  Found 1 item(s) to process for source 'Skyddsrum'
2025-07-25 01:29:24,759  INFO     [etl.loaders.shapefile_loader:145]  üìê Found 1 shapefile(s) in item dir 'skyddsrum'.
2025-07-25 01:29:24,775  INFO     [etl.loaders.shapefile_loader:180]  üì• Copying SHP ('Skyddsrum.shp') ‚Üí GDB:/'msb_skyddsrum' (Authority: 'MSB')
2025-07-25 01:29:28,665  INFO     [etl.loaders.shapefile_loader:192]  ‚úÖ SUCCESS: Copied shapefile 'Skyddsrum.shp' to 'msb_skyddsrum'
2025-07-25 01:29:28,795  INFO     [etl.loaders.filegdb:108]  üîÑ Processing source: Riksintresse Kulturmilj√∂v√•rd MB3kap6 (Authority: RAA)
2025-07-25 01:29:28,796  INFO     [etl.loaders.filegdb:135]  üîç Processing source 'Riksintresse Kulturmilj√∂v√•rd MB3kap6': staged_data_type='gpkg', normalized='gpkg'
2025-07-25 01:29:28,798  INFO     [etl.loaders.filegdb:145]  üì¶ Source 'Riksintresse Kulturmilj√∂v√•rd MB3kap6' configured for GPKG - using GPKG loader exclusively
2025-07-25 01:29:28,800  INFO     [etl.loaders.gpkg_loader:166]  üì¶ Processing GeoPackage: riksintresse_kulturmiljovard_mb3kap6.gpkg (Authority: 'RAA', Include Filter: None)
2025-07-25 01:29:30,238  INFO     [etl.loaders.gpkg_loader:186]  Found 1 feature classes in riksintresse_kulturmiljovard_mb3kap6.gpkg: ['main.raa_raa_ri_kulturmiljovard_mb3kap6']
2025-07-25 01:29:30,264  INFO     [etl.loaders.gpkg_loader:242]  üì¶ Processing 1 valid feature classes from riksintresse_kulturmiljovard_mb3kap6.gpkg
2025-07-25 01:29:30,265  INFO     [etl.loaders.gpkg_loader:144]  Stripped 'main.' from 'main.raa_raa_ri_kulturmiljovard_mb3kap6' ‚Üí 'raa_raa_ri_kulturmiljovard_mb3kap6' for output naming
2025-07-25 01:29:30,289  INFO     [etl.loaders.gpkg_loader:94]  üì• Copying GPKG FC ('main.raa_raa_ri_kulturmiljovard_mb3kap6') ‚Üí GDB:/'raa_raa_ri_kulturmiljovard_mb3kap6'
2025-07-25 01:29:31,485  INFO     [etl.loaders.gpkg_loader:35]  ‚úÖ SUCCESS: Copied GPKG FC 'main.raa_raa_ri_kulturmiljovard_mb3kap6' to 'raa_raa_ri_kulturmiljovard_mb3kap6'
2025-07-25 01:29:31,701  INFO     [etl.loaders.filegdb:108]  üîÑ Processing source: RAA Byggnader Sverige (Authority: RAA)
2025-07-25 01:29:31,702  INFO     [etl.loaders.filegdb:135]  üîç Processing source 'RAA Byggnader Sverige': staged_data_type='gpkg', normalized='gpkg'
2025-07-25 01:29:31,703  INFO     [etl.loaders.filegdb:145]  üì¶ Source 'RAA Byggnader Sverige' configured for GPKG - using GPKG loader exclusively
2025-07-25 01:29:31,705  INFO     [etl.loaders.gpkg_loader:166]  üì¶ Processing GeoPackage: raa_byggnader_sverige.gpkg (Authority: 'RAA', Include Filter: ['byggnader_sverige_point'])
2025-07-25 01:29:32,681  INFO     [etl.loaders.gpkg_loader:186]  Found 3 feature classes in raa_byggnader_sverige.gpkg: ['main.byggnader_sverige_linestring', 'main.byggnader_sverige_point', 'main.byggnader_sverige_polygon']
2025-07-25 01:29:32,682  INFO     [etl.loaders.gpkg_loader:197]  Normalized include filter for raa_byggnader_sverige.gpkg: {'byggnader_sverige_point'}
2025-07-25 01:29:32,683  INFO     [etl.loaders.gpkg_loader:212]  ‚è≠Ô∏è Excluding GPKG FC 'main.byggnader_sverige_linestring' (not in include filter)
2025-07-25 01:29:32,683  INFO     [etl.loaders.gpkg_loader:209]  ‚úÖ Including GPKG FC 'main.byggnader_sverige_point' (matches filter)
2025-07-25 01:29:32,684  INFO     [etl.loaders.gpkg_loader:212]  ‚è≠Ô∏è Excluding GPKG FC 'main.byggnader_sverige_polygon' (not in include filter)
2025-07-25 01:29:32,685  INFO     [etl.loaders.gpkg_loader:216]  üì¶ After applying include filter: 1 feature classes remain
2025-07-25 01:29:32,726  INFO     [etl.loaders.gpkg_loader:242]  üì¶ Processing 1 valid feature classes from raa_byggnader_sverige.gpkg
2025-07-25 01:29:32,727  INFO     [etl.loaders.gpkg_loader:138]  ‚úÖ GPKG FC 'main.byggnader_sverige_point' (normalized: 'byggnader_sverige_point') is in include filter. Proceeding.
2025-07-25 01:29:32,728  INFO     [etl.loaders.gpkg_loader:144]  Stripped 'main.' from 'main.byggnader_sverige_point' ‚Üí 'byggnader_sverige_point' for output naming
2025-07-25 01:29:32,762  INFO     [etl.loaders.gpkg_loader:94]  üì• Copying GPKG FC ('main.byggnader_sverige_point') ‚Üí GDB:/'raa_byggnader_sverige_point'
2025-07-25 01:29:45,249  INFO     [etl.loaders.gpkg_loader:35]  ‚úÖ SUCCESS: Copied GPKG FC 'main.byggnader_sverige_point' to 'raa_byggnader_sverige_point'
2025-07-25 01:29:45,492  INFO     [etl.loaders.filegdb:108]  üîÑ Processing source: Enskilda och statliga byggnadsminnen, skyddsomr√•den (Authority: RAA)
2025-07-25 01:29:45,494  INFO     [etl.loaders.filegdb:135]  üîç Processing source 'Enskilda och statliga byggnadsminnen, skyddsomr√•den': staged_data_type='gpkg', normalized='gpkg'
2025-07-25 01:29:45,495  INFO     [etl.loaders.filegdb:145]  üì¶ Source 'Enskilda och statliga byggnadsminnen, skyddsomr√•den' configured for GPKG - using GPKG loader exclusively
2025-07-25 01:29:45,497  INFO     [etl.loaders.gpkg_loader:166]  üì¶ Processing GeoPackage: enskilda_och_statliga_byggnadsminnen_skyddsomraden.gpkg (Authority: 'RAA', Include Filter: ['skyddsomrade_byggnadsminne_sverige_polygon'])
2025-07-25 01:29:46,325  INFO     [etl.loaders.gpkg_loader:186]  Found 3 feature classes in enskilda_och_statliga_byggnadsminnen_skyddsomraden.gpkg: ['main.skyddsomrade_byggnadsminne_sverige_linestring', 'main.skyddsomrade_byggnadsminne_sverige_point', 'main.skyddsomrade_byggnadsminne_sverige_polygon']
2025-07-25 01:29:46,326  INFO     [etl.loaders.gpkg_loader:197]  Normalized include filter for enskilda_och_statliga_byggnadsminnen_skyddsomraden.gpkg: {'skyddsomrade_byggnadsminne_sverige_polygon'}
2025-07-25 01:29:46,326  INFO     [etl.loaders.gpkg_loader:212]  ‚è≠Ô∏è Excluding GPKG FC 'main.skyddsomrade_byggnadsminne_sverige_linestring' (not in include filter)
2025-07-25 01:29:46,327  INFO     [etl.loaders.gpkg_loader:212]  ‚è≠Ô∏è Excluding GPKG FC 'main.skyddsomrade_byggnadsminne_sverige_point' (not in include filter)
2025-07-25 01:29:46,328  INFO     [etl.loaders.gpkg_loader:209]  ‚úÖ Including GPKG FC 'main.skyddsomrade_byggnadsminne_sverige_polygon' (matches filter)
2025-07-25 01:29:46,329  INFO     [etl.loaders.gpkg_loader:216]  üì¶ After applying include filter: 1 feature classes remain
2025-07-25 01:29:46,358  INFO     [etl.loaders.gpkg_loader:242]  üì¶ Processing 1 valid feature classes from enskilda_och_statliga_byggnadsminnen_skyddsomraden.gpkg
2025-07-25 01:29:46,359  INFO     [etl.loaders.gpkg_loader:138]  ‚úÖ GPKG FC 'main.skyddsomrade_byggnadsminne_sverige_polygon' (normalized: 'skyddsomrade_byggnadsminne_sverige_polygon') is in include filter. Proceeding.
2025-07-25 01:29:46,359  INFO     [etl.loaders.gpkg_loader:144]  Stripped 'main.' from 'main.skyddsomrade_byggnadsminne_sverige_polygon' ‚Üí 'skyddsomrade_byggnadsminne_sverige_polygon' for output naming
2025-07-25 01:29:46,380  INFO     [etl.loaders.gpkg_loader:94]  üì• Copying GPKG FC ('main.skyddsomrade_byggnadsminne_sverige_polygon') ‚Üí GDB:/'raa_skyddsomrade_byggnadsminne_sverige_polygon'
2025-07-25 01:29:47,799  INFO     [etl.loaders.gpkg_loader:35]  ‚úÖ SUCCESS: Copied GPKG FC 'main.skyddsomrade_byggnadsminne_sverige_polygon' to 'raa_skyddsomrade_byggnadsminne_sverige_polygon'
2025-07-25 01:29:47,980  INFO     [etl.loaders.filegdb:108]  üîÑ Processing source: Kulturhistoriska l√§mningar, S√∂dermanland (Authority: RAA)
2025-07-25 01:29:47,981  INFO     [etl.loaders.filegdb:135]  üîç Processing source 'Kulturhistoriska l√§mningar, S√∂dermanland': staged_data_type='gpkg', normalized='gpkg'
2025-07-25 01:29:47,982  INFO     [etl.loaders.filegdb:145]  üì¶ Source 'Kulturhistoriska l√§mningar, S√∂dermanland' configured for GPKG - using GPKG loader exclusively
2025-07-25 01:29:47,984  INFO     [etl.loaders.gpkg_loader:166]  üì¶ Processing GeoPackage: kulturhistoriska_lamningar_sodermanland.gpkg (Authority: 'RAA', Include Filter: None)
2025-07-25 01:29:48,935  INFO     [etl.loaders.gpkg_loader:186]  Found 3 feature classes in kulturhistoriska_lamningar_sodermanland.gpkg: ['main.l√§mningar_l√§n_s√∂dermanland_linestring', 'main.l√§mningar_l√§n_s√∂dermanland_point', 'main.l√§mningar_l√§n_s√∂dermanland_polygon']
2025-07-25 01:29:49,027  INFO     [etl.loaders.gpkg_loader:242]  üì¶ Processing 3 valid feature classes from kulturhistoriska_lamningar_sodermanland.gpkg
2025-07-25 01:29:49,028  INFO     [etl.loaders.gpkg_loader:144]  Stripped 'main.' from 'main.l√§mningar_l√§n_s√∂dermanland_linestring' ‚Üí 'l√§mningar_l√§n_s√∂dermanland_linestring' for output naming
2025-07-25 01:29:49,046  INFO     [etl.loaders.gpkg_loader:94]  üì• Copying GPKG FC ('main.l√§mningar_l√§n_s√∂dermanland_linestring') ‚Üí GDB:/'raa_lamningar_lan_sodermanland_linestring'
2025-07-25 01:29:49,978  INFO     [etl.loaders.gpkg_loader:35]  ‚úÖ SUCCESS: Copied GPKG FC 'main.l√§mningar_l√§n_s√∂dermanland_linestring' to 'raa_lamningar_lan_sodermanland_linestring'
2025-07-25 01:29:50,106  INFO     [etl.loaders.gpkg_loader:144]  Stripped 'main.' from 'main.l√§mningar_l√§n_s√∂dermanland_point' ‚Üí 'l√§mningar_l√§n_s√∂dermanland_point' for output naming
2025-07-25 01:29:50,161  INFO     [etl.loaders.gpkg_loader:94]  üì• Copying GPKG FC ('main.l√§mningar_l√§n_s√∂dermanland_point') ‚Üí GDB:/'raa_lamningar_lan_sodermanland_point'
2025-07-25 01:29:54,820  INFO     [etl.loaders.gpkg_loader:35]  ‚úÖ SUCCESS: Copied GPKG FC 'main.l√§mningar_l√§n_s√∂dermanland_point' to 'raa_lamningar_lan_sodermanland_point'
2025-07-25 01:29:54,961  INFO     [etl.loaders.gpkg_loader:144]  Stripped 'main.' from 'main.l√§mningar_l√§n_s√∂dermanland_polygon' ‚Üí 'l√§mningar_l√§n_s√∂dermanland_polygon' for output naming
2025-07-25 01:29:55,109  INFO     [etl.loaders.gpkg_loader:94]  üì• Copying GPKG FC ('main.l√§mningar_l√§n_s√∂dermanland_polygon') ‚Üí GDB:/'raa_lamningar_lan_sodermanland_polygon'
2025-07-25 01:29:57,416  INFO     [etl.loaders.gpkg_loader:35]  ‚úÖ SUCCESS: Copied GPKG FC 'main.l√§mningar_l√§n_s√∂dermanland_polygon' to 'raa_lamningar_lan_sodermanland_polygon'
2025-07-25 01:29:57,667  INFO     [etl.loaders.filegdb:108]  üîÑ Processing source: RAA V√§rldsarv i Sverige (Authority: RAA)
2025-07-25 01:29:57,668  INFO     [etl.loaders.filegdb:135]  üîç Processing source 'RAA V√§rldsarv i Sverige': staged_data_type='gpkg', normalized='gpkg'
2025-07-25 01:29:57,669  INFO     [etl.loaders.filegdb:145]  üì¶ Source 'RAA V√§rldsarv i Sverige' configured for GPKG - using GPKG loader exclusively
2025-07-25 01:29:57,670  INFO     [etl.loaders.gpkg_loader:166]  üì¶ Processing GeoPackage: raa_varldsarv_i_sverige.gpkg (Authority: 'RAA', Include Filter: ['varldsarv_sverige_polygon'])
2025-07-25 01:29:58,497  INFO     [etl.loaders.gpkg_loader:186]  Found 3 feature classes in raa_varldsarv_i_sverige.gpkg: ['main.varldsarv_sverige_linestring', 'main.varldsarv_sverige_point', 'main.varldsarv_sverige_polygon']
2025-07-25 01:29:58,498  INFO     [etl.loaders.gpkg_loader:197]  Normalized include filter for raa_varldsarv_i_sverige.gpkg: {'varldsarv_sverige_polygon'}
2025-07-25 01:29:58,500  INFO     [etl.loaders.gpkg_loader:212]  ‚è≠Ô∏è Excluding GPKG FC 'main.varldsarv_sverige_linestring' (not in include filter)
2025-07-25 01:29:58,501  INFO     [etl.loaders.gpkg_loader:212]  ‚è≠Ô∏è Excluding GPKG FC 'main.varldsarv_sverige_point' (not in include filter)
2025-07-25 01:29:58,502  INFO     [etl.loaders.gpkg_loader:209]  ‚úÖ Including GPKG FC 'main.varldsarv_sverige_polygon' (matches filter)
2025-07-25 01:29:58,502  INFO     [etl.loaders.gpkg_loader:216]  üì¶ After applying include filter: 1 feature classes remain
2025-07-25 01:29:58,523  INFO     [etl.loaders.gpkg_loader:242]  üì¶ Processing 1 valid feature classes from raa_varldsarv_i_sverige.gpkg
2025-07-25 01:29:58,524  INFO     [etl.loaders.gpkg_loader:138]  ‚úÖ GPKG FC 'main.varldsarv_sverige_polygon' (normalized: 'varldsarv_sverige_polygon') is in include filter. Proceeding.
2025-07-25 01:29:58,525  INFO     [etl.loaders.gpkg_loader:144]  Stripped 'main.' from 'main.varldsarv_sverige_polygon' ‚Üí 'varldsarv_sverige_polygon' for output naming
2025-07-25 01:29:58,547  INFO     [etl.loaders.gpkg_loader:94]  üì• Copying GPKG FC ('main.varldsarv_sverige_polygon') ‚Üí GDB:/'raa_varldsarv_sverige_polygon'
2025-07-25 01:29:59,356  INFO     [etl.loaders.gpkg_loader:35]  ‚úÖ SUCCESS: Copied GPKG FC 'main.varldsarv_sverige_polygon' to 'raa_varldsarv_sverige_polygon'
2025-07-25 01:29:59,559  INFO     [etl.loaders.filegdb:108]  üîÑ Processing source: Intr√§ffade skred, ras och √∂vriga jordr√∂relser (skreddatabas) (Authority: SGI)
2025-07-25 01:29:59,559  INFO     [etl.loaders.filegdb:135]  üîç Processing source 'Intr√§ffade skred, ras och √∂vriga jordr√∂relser (skreddatabas)': staged_data_type='shapefile_collection', normalized='shapefile_collection'
2025-07-25 01:29:59,561  INFO     [etl.loaders.filegdb:155]  üìê Handling shapefile collection source 'Intr√§ffade skred, ras och √∂vriga jordr√∂relser (skreddatabas)'
2025-07-25 01:29:59,566  INFO     [etl.loaders.shapefile_loader:103]  Found 1 item(s) to process for source 'Intr√§ffade skred, ras och √∂vriga jordr√∂relser (skreddatabas)'
2025-07-25 01:29:59,569  INFO     [etl.loaders.shapefile_loader:145]  üìê Found 1 shapefile(s) in item dir 'intraffade_skred_ras_och_ovriga_jordrorelser_skreddatabas'.
2025-07-25 01:29:59,591  INFO     [etl.loaders.shapefile_loader:180]  üì• Copying SHP ('SGI_Skreddatabas_ver2.shp') ‚Üí GDB:/'sgi_skreddatabas_ver2' (Authority: 'SGI')
2025-07-25 01:30:00,638  INFO     [etl.loaders.shapefile_loader:192]  ‚úÖ SUCCESS: Copied shapefile 'SGI_Skreddatabas_ver2.shp' to 'sgi_skreddatabas_ver2'
2025-07-25 01:30:00,804  INFO     [etl.loaders.filegdb:108]  üîÑ Processing source: Erosion (Authority: SGU)
2025-07-25 01:30:00,806  INFO     [etl.loaders.filegdb:135]  üîç Processing source 'Erosion': staged_data_type='geojson', normalized='geojson'
2025-07-25 01:30:00,808  INFO     [etl.loaders.filegdb:276]  ‚ÑπÔ∏è No JSON/GeoJSON files found for source 'Erosion'.
2025-07-25 01:30:00,809  INFO     [etl.loaders.filegdb:108]  üîÑ Processing source: Brunnar (Authority: SGU)
2025-07-25 01:30:00,810  INFO     [etl.loaders.filegdb:135]  üîç Processing source 'Brunnar': staged_data_type='geojson', normalized='geojson'
2025-07-25 01:30:00,813  INFO     [etl.loaders.filegdb:262]  üåç Found 1 JSON/GeoJSON file(s) for source 'Brunnar'.
2025-07-25 01:30:01,190  INFO     [etl.loaders.geojson_loader:53]  üîç Detected geometry types in brunnar.geojson: {'Point'}
2025-07-25 01:30:01,191  INFO     [etl.loaders.geojson_loader:71]  üîç Mapping Point ‚Üí POINT for brunnar.geojson
2025-07-25 01:30:01,209  INFO     [etl.loaders.geojson_loader:129]  üìç Detected geometry type: POINT for brunnar.geojson
2025-07-25 01:30:01,211  INFO     [etl.loaders.geojson_loader:142]  üì• Converting JSON/GeoJSON ('brunnar.geojson') ‚Üí GDB:/'sgu_brunnar_point' (Authority: 'SGU', Geom: POINT)
2025-07-25 01:30:05,056  INFO     [etl.loaders.geojson_loader:166]  ‚úÖ SUCCESS: Created FC 'sgu_brunnar_point' with 19579 records, geometry type: Point
2025-07-25 01:30:05,057  INFO     [etl.loaders.filegdb:108]  üîÑ Processing source: Jordskred och raviner (Authority: SGU)
2025-07-25 01:30:05,058  INFO     [etl.loaders.filegdb:135]  üîç Processing source 'Jordskred och raviner': staged_data_type='geojson', normalized='geojson'
2025-07-25 01:30:05,059  INFO     [etl.loaders.filegdb:262]  üåç Found 1 JSON/GeoJSON file(s) for source 'Jordskred och raviner'.
2025-07-25 01:30:05,062  INFO     [etl.loaders.geojson_loader:53]  üîç Detected geometry types in jordskred-raviner.geojson: {'LineString'}
2025-07-25 01:30:05,062  INFO     [etl.loaders.geojson_loader:71]  üîç Mapping LineString ‚Üí POLYLINE for jordskred-raviner.geojson
2025-07-25 01:30:05,063  INFO     [etl.loaders.geojson_loader:129]  üìç Detected geometry type: POLYLINE for jordskred-raviner.geojson
2025-07-25 01:30:05,063  INFO     [etl.loaders.geojson_loader:142]  üì• Converting JSON/GeoJSON ('jordskred-raviner.geojson') ‚Üí GDB:/'sgu_jordskred_raviner_polyline' (Authority: 'SGU', Geom: POLYLINE)
2025-07-25 01:30:06,149  INFO     [etl.loaders.geojson_loader:166]  ‚úÖ SUCCESS: Created FC 'sgu_jordskred_raviner_polyline' with 48 records, geometry type: Polyline
2025-07-25 01:30:06,150  INFO     [etl.loaders.filegdb:108]  üîÑ Processing source: Grus Krossberg (Authority: SGU)
2025-07-25 01:30:06,151  INFO     [etl.loaders.filegdb:135]  üîç Processing source 'Grus Krossberg': staged_data_type='geojson', normalized='geojson'
2025-07-25 01:30:06,151  WARNING  [etl.loaders.filegdb:250]  ‚ö†Ô∏è Staging directory not found for JSON/GeoJSON source 'Grus Krossberg': C:\Git\ETL-pipeline\data\staging\SGU\grus_krossberg
2025-07-25 01:30:06,152  INFO     [etl.loaders.filegdb:108]  üîÑ Processing source: Jordbruksblock (2024) (Authority: SJV)
2025-07-25 01:30:06,152  INFO     [etl.loaders.filegdb:135]  üîç Processing source 'Jordbruksblock (2024)': staged_data_type='geojson', normalized='geojson'
2025-07-25 01:30:06,153  INFO     [etl.loaders.filegdb:262]  üåç Found 1 JSON/GeoJSON file(s) for source 'Jordbruksblock (2024)'.
2025-07-25 01:30:09,499  INFO     [etl.loaders.geojson_loader:53]  üîç Detected geometry types in sjv_jordbruksblock_2024.geojson: {'Polygon'}
2025-07-25 01:30:09,500  INFO     [etl.loaders.geojson_loader:71]  üîç Mapping Polygon ‚Üí POLYGON for sjv_jordbruksblock_2024.geojson
2025-07-25 01:30:09,583  INFO     [etl.loaders.geojson_loader:129]  üìç Detected geometry type: POLYGON for sjv_jordbruksblock_2024.geojson
2025-07-25 01:30:09,586  INFO     [etl.loaders.geojson_loader:142]  üì• Converting JSON/GeoJSON ('sjv_jordbruksblock_2024.geojson') ‚Üí GDB:/'sjv_jordbruksblock_2024_polygon' (Authority: 'SJV', Geom: POLYGON)
2025-07-25 01:30:29,360  INFO     [etl.loaders.geojson_loader:166]  ‚úÖ SUCCESS: Created FC 'sjv_jordbruksblock_2024_polygon' with 18581 records, geometry type: Polygon
2025-07-25 01:30:29,361  INFO     [etl.loaders.filegdb:108]  üîÑ Processing source: Jordbruksskiften (senaste √•ret) (Authority: SJV)
2025-07-25 01:30:29,361  INFO     [etl.loaders.filegdb:135]  üîç Processing source 'Jordbruksskiften (senaste √•ret)': staged_data_type='geojson', normalized='geojson'
2025-07-25 01:30:29,362  WARNING  [etl.loaders.filegdb:250]  ‚ö†Ô∏è Staging directory not found for JSON/GeoJSON source 'Jordbruksskiften (senaste √•ret)': C:\Git\ETL-pipeline\data\staging\SJV\jordbruksskiften_senaste_aret
2025-07-25 01:30:29,362  INFO     [etl.loaders.filegdb:108]  üîÑ Processing source: Produktionsplatser f√∂r djurh√•llning (Authority: SJV)
2025-07-25 01:30:29,362  INFO     [etl.loaders.filegdb:135]  üîç Processing source 'Produktionsplatser f√∂r djurh√•llning': staged_data_type='geojson', normalized='geojson'
2025-07-25 01:30:29,362  WARNING  [etl.loaders.filegdb:250]  ‚ö†Ô∏è Staging directory not found for JSON/GeoJSON source 'Produktionsplatser f√∂r djurh√•llning': C:\Git\ETL-pipeline\data\staging\SJV\produktionsplatser_for_djurhallning
2025-07-25 01:30:29,363  INFO     [etl.loaders.filegdb:108]  üîÑ Processing source: √Ñngs- och betesmarksinventeringen (Authority: SJV)
2025-07-25 01:30:29,363  INFO     [etl.loaders.filegdb:135]  üîç Processing source '√Ñngs- och betesmarksinventeringen': staged_data_type='geojson', normalized='geojson'
2025-07-25 01:30:29,364  WARNING  [etl.loaders.filegdb:250]  ‚ö†Ô∏è Staging directory not found for JSON/GeoJSON source '√Ñngs- och betesmarksinventeringen': C:\Git\ETL-pipeline\data\staging\SJV\angs-_och_betesmarksinventeringen
2025-07-25 01:30:29,364  INFO     [etl.loaders.filegdb:108]  üîÑ Processing source: Naturv√§rden (Authority: SKS)
2025-07-25 01:30:29,365  INFO     [etl.loaders.filegdb:135]  üîç Processing source 'Naturv√§rden': staged_data_type='gpkg', normalized='gpkg'
2025-07-25 01:30:29,365  INFO     [etl.loaders.filegdb:145]  üì¶ Source 'Naturv√§rden' configured for GPKG - using GPKG loader exclusively
2025-07-25 01:30:29,365  WARNING  [etl.loaders.filegdb:237]  ‚ö†Ô∏è No GPKG file found for source 'Naturv√§rden' in dir C:\Git\ETL-pipeline\data\staging\SKS\naturvarden
2025-07-25 01:30:29,365  INFO     [etl.loaders.filegdb:108]  üîÑ Processing source: Ras och skred (Authority: SKS)
2025-07-25 01:30:29,367  INFO     [etl.loaders.filegdb:135]  üîç Processing source 'Ras och skred': staged_data_type='gpkg', normalized='gpkg'
2025-07-25 01:30:29,367  INFO     [etl.loaders.filegdb:145]  üì¶ Source 'Ras och skred' configured for GPKG - using GPKG loader exclusively
2025-07-25 01:30:29,368  WARNING  [etl.loaders.filegdb:198]  ‚ö†Ô∏è Staging directory not found for GPKG source 'Ras och skred': C:\Git\ETL-pipeline\data\staging\SKS\ras_och_skred
2025-07-25 01:30:29,368  INFO     [etl.loaders.filegdb:108]  üîÑ Processing source: Skogsstyrelsen - Biotopskydd (REST) (Authority: SKS)
2025-07-25 01:30:29,368  INFO     [etl.loaders.filegdb:135]  üîç Processing source 'Skogsstyrelsen - Biotopskydd (REST)': staged_data_type='geojson', normalized='geojson'
2025-07-25 01:30:29,370  INFO     [etl.loaders.filegdb:262]  üåç Found 1 JSON/GeoJSON file(s) for source 'Skogsstyrelsen - Biotopskydd (REST)'.
2025-07-25 01:30:29,379  INFO     [etl.loaders.geojson_loader:53]  üîç Detected geometry types in biotopskydd_skogsstyrelsen.geojson: {'Polygon'}
2025-07-25 01:30:29,380  INFO     [etl.loaders.geojson_loader:71]  üîç Mapping Polygon ‚Üí POLYGON for biotopskydd_skogsstyrelsen.geojson
2025-07-25 01:30:29,381  INFO     [etl.loaders.geojson_loader:129]  üìç Detected geometry type: POLYGON for biotopskydd_skogsstyrelsen.geojson
2025-07-25 01:30:29,382  INFO     [etl.loaders.geojson_loader:142]  üì• Converting JSON/GeoJSON ('biotopskydd_skogsstyrelsen.geojson') ‚Üí GDB:/'sks_biotopskydd_skogsstyrelsen_polygon' (Authority: 'SKS', Geom: POLYGON)
2025-07-25 01:30:30,558  INFO     [etl.loaders.geojson_loader:166]  ‚úÖ SUCCESS: Created FC 'sks_biotopskydd_skogsstyrelsen_polygon' with 125 records, geometry type: Polygon
2025-07-25 01:30:30,559  INFO     [etl.loaders.filegdb:108]  üîÑ Processing source: Utf√∂rda avverkningar (Authority: SKS)
2025-07-25 01:30:30,559  INFO     [etl.loaders.filegdb:135]  üîç Processing source 'Utf√∂rda avverkningar': staged_data_type='geojson', normalized='geojson'
2025-07-25 01:30:30,561  WARNING  [etl.loaders.filegdb:250]  ‚ö†Ô∏è Staging directory not found for JSON/GeoJSON source 'Utf√∂rda avverkningar': C:\Git\ETL-pipeline\data\staging\SKS\utforda_avverkningar
2025-07-25 01:30:30,561  INFO     [etl.loaders.filegdb:108]  üîÑ Processing source: Naturv√•rdsavtal (Authority: SKS)
2025-07-25 01:30:30,562  INFO     [etl.loaders.filegdb:135]  üîç Processing source 'Naturv√•rdsavtal': staged_data_type='geojson', normalized='geojson'
2025-07-25 01:30:30,563  INFO     [etl.loaders.filegdb:262]  üåç Found 1 JSON/GeoJSON file(s) for source 'Naturv√•rdsavtal'.
2025-07-25 01:30:30,573  INFO     [etl.loaders.geojson_loader:53]  üîç Detected geometry types in naturvardsavtal_skogsstyrelsen.geojson: {'Polygon', 'MultiPolygon'}
2025-07-25 01:30:30,574  WARNING  [etl.loaders.geojson_loader:79]  ‚ö†Ô∏è Mixed geometry types found in naturvardsavtal_skogsstyrelsen.geojson: {'Polygon', 'MultiPolygon'}. Using POLYGON as default.
2025-07-25 01:30:30,576  INFO     [etl.loaders.geojson_loader:129]  üìç Detected geometry type: POLYGON for naturvardsavtal_skogsstyrelsen.geojson
2025-07-25 01:30:30,577  INFO     [etl.loaders.geojson_loader:142]  üì• Converting JSON/GeoJSON ('naturvardsavtal_skogsstyrelsen.geojson') ‚Üí GDB:/'sks_naturvardsavtal_skogsstyrelsen_polygon' (Authority: 'SKS', Geom: POLYGON)
2025-07-25 01:30:31,650  INFO     [etl.loaders.geojson_loader:166]  ‚úÖ SUCCESS: Created FC 'sks_naturvardsavtal_skogsstyrelsen_polygon' with 59 records, geometry type: Polygon
2025-07-25 01:30:31,651  INFO     [etl.loaders.filegdb:108]  üîÑ Processing source: √Öterv√§tningsavtal (Authority: SKS)
2025-07-25 01:30:31,652  INFO     [etl.loaders.filegdb:135]  üîç Processing source '√Öterv√§tningsavtal': staged_data_type='geojson', normalized='geojson'
2025-07-25 01:30:31,653  INFO     [etl.loaders.filegdb:262]  üåç Found 1 JSON/GeoJSON file(s) for source '√Öterv√§tningsavtal'.
2025-07-25 01:30:31,654  INFO     [etl.loaders.geojson_loader:53]  üîç Detected geometry types in atervatningyta_skogsstyrelsen.geojson: {'Polygon'}
2025-07-25 01:30:31,654  INFO     [etl.loaders.geojson_loader:71]  üîç Mapping Polygon ‚Üí POLYGON for atervatningyta_skogsstyrelsen.geojson
2025-07-25 01:30:31,654  INFO     [etl.loaders.geojson_loader:129]  üìç Detected geometry type: POLYGON for atervatningyta_skogsstyrelsen.geojson
2025-07-25 01:30:31,655  INFO     [etl.loaders.geojson_loader:142]  üì• Converting JSON/GeoJSON ('atervatningyta_skogsstyrelsen.geojson') ‚Üí GDB:/'sks_atervatningyta_skogsstyrelsen_polygon' (Authority: 'SKS', Geom: POLYGON)
2025-07-25 01:30:32,680  INFO     [etl.loaders.geojson_loader:166]  ‚úÖ SUCCESS: Created FC 'sks_atervatningyta_skogsstyrelsen_polygon' with 3 records, geometry type: Polygon
2025-07-25 01:30:32,682  INFO     [etl.loaders.filegdb:108]  üîÑ Processing source: Nyckelbiotoper (Authority: SKS)
2025-07-25 01:30:32,683  INFO     [etl.loaders.filegdb:135]  üîç Processing source 'Nyckelbiotoper': staged_data_type='geojson', normalized='geojson'
2025-07-25 01:30:32,684  INFO     [etl.loaders.filegdb:262]  üåç Found 1 JSON/GeoJSON file(s) for source 'Nyckelbiotoper'.
2025-07-25 01:30:32,763  INFO     [etl.loaders.geojson_loader:53]  üîç Detected geometry types in nyckelbiotop_skogsstyrelsen.geojson: {'Polygon'}
2025-07-25 01:30:32,764  INFO     [etl.loaders.geojson_loader:71]  üîç Mapping Polygon ‚Üí POLYGON for nyckelbiotop_skogsstyrelsen.geojson
2025-07-25 01:30:32,768  INFO     [etl.loaders.geojson_loader:129]  üìç Detected geometry type: POLYGON for nyckelbiotop_skogsstyrelsen.geojson
2025-07-25 01:30:32,769  INFO     [etl.loaders.geojson_loader:142]  üì• Converting JSON/GeoJSON ('nyckelbiotop_skogsstyrelsen.geojson') ‚Üí GDB:/'sks_nyckelbiotop_skogsstyrelsen_polygon' (Authority: 'SKS', Geom: POLYGON)
2025-07-25 01:30:34,195  INFO     [etl.loaders.geojson_loader:166]  ‚úÖ SUCCESS: Created FC 'sks_nyckelbiotop_skogsstyrelsen_polygon' with 1293 records, geometry type: Polygon
2025-07-25 01:30:34,196  INFO     [etl.loaders.filegdb:108]  üîÑ Processing source: Sumpskogar (Authority: SKS)
2025-07-25 01:30:34,197  INFO     [etl.loaders.filegdb:135]  üîç Processing source 'Sumpskogar': staged_data_type='geojson', normalized='geojson'
2025-07-25 01:30:34,200  INFO     [etl.loaders.filegdb:262]  üåç Found 1 JSON/GeoJSON file(s) for source 'Sumpskogar'.
2025-07-25 01:30:34,459  INFO     [etl.loaders.geojson_loader:53]  üîç Detected geometry types in sumpskog_skogsstyrelsen.geojson: {'Polygon'}
2025-07-25 01:30:34,459  INFO     [etl.loaders.geojson_loader:71]  üîç Mapping Polygon ‚Üí POLYGON for sumpskog_skogsstyrelsen.geojson
2025-07-25 01:30:34,468  INFO     [etl.loaders.geojson_loader:129]  üìç Detected geometry type: POLYGON for sumpskog_skogsstyrelsen.geojson
2025-07-25 01:30:34,469  INFO     [etl.loaders.geojson_loader:142]  üì• Converting JSON/GeoJSON ('sumpskog_skogsstyrelsen.geojson') ‚Üí GDB:/'sks_sumpskog_skogsstyrelsen_polygon' (Authority: 'SKS', Geom: POLYGON)
2025-07-25 01:30:36,769  INFO     [etl.loaders.geojson_loader:166]  ‚úÖ SUCCESS: Created FC 'sks_sumpskog_skogsstyrelsen_polygon' with 2769 records, geometry type: Polygon
2025-07-25 01:30:36,771  INFO     [etl.loaders.filegdb:108]  üîÑ Processing source: Avverkningsanm√§lda omr√•den (Authority: SKS)
2025-07-25 01:30:36,772  INFO     [etl.loaders.filegdb:135]  üîç Processing source 'Avverkningsanm√§lda omr√•den': staged_data_type='geojson', normalized='geojson'
2025-07-25 01:30:36,776  INFO     [etl.loaders.filegdb:262]  üåç Found 1 JSON/GeoJSON file(s) for source 'Avverkningsanm√§lda omr√•den'.
2025-07-25 01:30:36,947  INFO     [etl.loaders.geojson_loader:53]  üîç Detected geometry types in avverkningsanmalan_skogsstyrelsen.geojson: {'Polygon'}
2025-07-25 01:30:36,948  INFO     [etl.loaders.geojson_loader:71]  üîç Mapping Polygon ‚Üí POLYGON for avverkningsanmalan_skogsstyrelsen.geojson
2025-07-25 01:30:36,953  INFO     [etl.loaders.geojson_loader:129]  üìç Detected geometry type: POLYGON for avverkningsanmalan_skogsstyrelsen.geojson
2025-07-25 01:30:36,954  INFO     [etl.loaders.geojson_loader:142]  üì• Converting JSON/GeoJSON ('avverkningsanmalan_skogsstyrelsen.geojson') ‚Üí GDB:/'sks_avverkningsanmalan_skogsstyrelsen_polygon' (Authority: 'SKS', Geom: POLYGON)
2025-07-25 01:30:39,502  INFO     [etl.loaders.geojson_loader:166]  ‚úÖ SUCCESS: Created FC 'sks_avverkningsanmalan_skogsstyrelsen_polygon' with 1337 records, geometry type: Polygon
2025-07-25 01:30:39,503  INFO     [etl.loaders.filegdb:108]  üîÑ Processing source: Gr√§ns f√∂r skogsskyddsbest√§mmelser (Authority: SKS)
2025-07-25 01:30:39,504  INFO     [etl.loaders.filegdb:135]  üîç Processing source 'Gr√§ns f√∂r skogsskyddsbest√§mmelser': staged_data_type='geojson', normalized='geojson'
2025-07-25 01:30:39,505  INFO     [etl.loaders.filegdb:262]  üåç Found 1 JSON/GeoJSON file(s) for source 'Gr√§ns f√∂r skogsskyddsbest√§mmelser'.
2025-07-25 01:30:39,531  INFO     [etl.loaders.geojson_loader:53]  üîç Detected geometry types in skogsskyddsbestammelser.geojson: {'MultiPolygon'}
2025-07-25 01:30:39,532  INFO     [etl.loaders.geojson_loader:71]  üîç Mapping MultiPolygon ‚Üí POLYGON for skogsskyddsbestammelser.geojson
2025-07-25 01:30:39,534  INFO     [etl.loaders.geojson_loader:129]  üìç Detected geometry type: POLYGON for skogsskyddsbestammelser.geojson
2025-07-25 01:30:39,537  INFO     [etl.loaders.geojson_loader:142]  üì• Converting JSON/GeoJSON ('skogsskyddsbestammelser.geojson') ‚Üí GDB:/'sks_skogsskyddsbestammelser_polygon' (Authority: 'SKS', Geom: POLYGON)
2025-07-25 01:30:40,678  INFO     [etl.loaders.geojson_loader:166]  ‚úÖ SUCCESS: Created FC 'sks_skogsskyddsbestammelser_polygon' with 1 records, geometry type: Polygon
2025-07-25 01:30:40,680  INFO     [etl.loaders.filegdb:108]  üîÑ Processing source: Nyckelbiotoper - storskogsbruket (Authority: SKS)
2025-07-25 01:30:40,681  INFO     [etl.loaders.filegdb:135]  üîç Processing source 'Nyckelbiotoper - storskogsbruket': staged_data_type='geojson', normalized='geojson'
2025-07-25 01:30:40,683  INFO     [etl.loaders.filegdb:262]  üåç Found 1 JSON/GeoJSON file(s) for source 'Nyckelbiotoper - storskogsbruket'.
2025-07-25 01:30:40,714  INFO     [etl.loaders.geojson_loader:53]  üîç Detected geometry types in storskogsbrukets_nyckelbiotoper.geojson: {'Polygon'}
2025-07-25 01:30:40,715  INFO     [etl.loaders.geojson_loader:71]  üîç Mapping Polygon ‚Üí POLYGON for storskogsbrukets_nyckelbiotoper.geojson
2025-07-25 01:30:40,717  INFO     [etl.loaders.geojson_loader:129]  üìç Detected geometry type: POLYGON for storskogsbrukets_nyckelbiotoper.geojson
2025-07-25 01:30:40,719  INFO     [etl.loaders.geojson_loader:142]  üì• Converting JSON/GeoJSON ('storskogsbrukets_nyckelbiotoper.geojson') ‚Üí GDB:/'sks_storskogsbrukets_nyckelbiotoper_polygon' (Authority: 'SKS', Geom: POLYGON)
2025-07-25 01:30:42,063  INFO     [etl.loaders.geojson_loader:166]  ‚úÖ SUCCESS: Created FC 'sks_storskogsbrukets_nyckelbiotoper_polygon' with 161 records, geometry type: Polygon
2025-07-25 01:30:42,066  INFO     [etl.loaders.filegdb:108]  üîÑ Processing source: Stamn√§t (Authority: SVK)
2025-07-25 01:30:42,066  INFO     [etl.loaders.filegdb:135]  üîç Processing source 'Stamn√§t': staged_data_type='shapefile_collection', normalized='shapefile_collection'
2025-07-25 01:30:42,068  INFO     [etl.loaders.filegdb:155]  üìê Handling shapefile collection source 'Stamn√§t'
2025-07-25 01:30:42,074  INFO     [etl.loaders.shapefile_loader:103]  Found 1 item(s) to process for source 'Stamn√§t'
2025-07-25 01:30:42,077  INFO     [etl.loaders.shapefile_loader:145]  üìê Found 4 shapefile(s) in item dir 'stamnat'.
2025-07-25 01:30:42,091  INFO     [etl.loaders.shapefile_loader:180]  üì• Copying SHP ('STATIONER.shp') ‚Üí GDB:/'svk_stationer' (Authority: 'SVK')
2025-07-25 01:30:42,996  INFO     [etl.loaders.shapefile_loader:192]  ‚úÖ SUCCESS: Copied shapefile 'STATIONER.shp' to 'svk_stationer'
2025-07-25 01:30:43,148  INFO     [etl.loaders.shapefile_loader:180]  üì• Copying SHP ('STATIONSOMRADEN.shp') ‚Üí GDB:/'svk_stationsomraden' (Authority: 'SVK')
2025-07-25 01:30:44,096  INFO     [etl.loaders.shapefile_loader:192]  ‚úÖ SUCCESS: Copied shapefile 'STATIONSOMRADEN.shp' to 'svk_stationsomraden'
2025-07-25 01:30:44,250  INFO     [etl.loaders.shapefile_loader:180]  üì• Copying SHP ('SVK_LEDNINGAR.shp') ‚Üí GDB:/'svk_ledningar' (Authority: 'SVK')
2025-07-25 01:30:45,283  INFO     [etl.loaders.shapefile_loader:192]  ‚úÖ SUCCESS: Copied shapefile 'SVK_LEDNINGAR.shp' to 'svk_ledningar'
2025-07-25 01:30:45,446  INFO     [etl.loaders.shapefile_loader:180]  üì• Copying SHP ('SVK_STOLPAR.shp') ‚Üí GDB:/'svk_stolpar' (Authority: 'SVK')
2025-07-25 01:30:49,459  INFO     [etl.loaders.shapefile_loader:192]  ‚úÖ SUCCESS: Copied shapefile 'SVK_STOLPAR.shp' to 'svk_stolpar'
2025-07-25 01:30:49,652  INFO     [etl.loaders.filegdb:108]  üîÑ Processing source: V√§gar (Authority: TRV)
2025-07-25 01:30:49,654  INFO     [etl.loaders.filegdb:135]  üîç Processing source 'V√§gar': staged_data_type='geojson', normalized='geojson'
2025-07-25 01:30:49,654  WARNING  [etl.loaders.filegdb:250]  ‚ö†Ô∏è Staging directory not found for JSON/GeoJSON source 'V√§gar': C:\Git\ETL-pipeline\data\staging\TRV\vagar
2025-07-25 01:30:49,655  INFO     [etl.loaders.filegdb:108]  üîÑ Processing source: √ñvrigt (Authority: TRV)
2025-07-25 01:30:49,656  INFO     [etl.loaders.filegdb:135]  üîç Processing source '√ñvrigt': staged_data_type='geojson', normalized='geojson'
2025-07-25 01:30:49,656  WARNING  [etl.loaders.filegdb:250]  ‚ö†Ô∏è Staging directory not found for JSON/GeoJSON source '√ñvrigt': C:\Git\ETL-pipeline\data\staging\TRV\ovrigt
2025-07-25 01:30:49,657  INFO     [etl.loaders.filegdb:83]  ‚úÖ FileGDB loading process completed
2025-07-25 01:30:49,658  INFO     [pipeline:623]  ‚úÖ Staging.gdb built successfully in 223.93 seconds
2025-07-25 01:30:49,659  ERROR    [pipeline:623]  ‚ùå AOI boundary not found: data\connections\municipality_boundary.shp
2025-07-25 01:30:49,659  INFO     [etl.utils.performance:481]  ‚è±Ô∏è  geoprocessing completed in 0.001s
2025-07-25 01:30:49,661  INFO     [pipeline:623]  üöö Starting SDE loading - Source: staging.gdb, SDE: data/connections/prod.sde
2025-07-25 01:30:52,626  DEBUG    [pipeline:623]  üìÑ Found standalone feature classes: 48
2025-07-25 01:30:52,649  INFO     [pipeline:623]  üìã Feature classes discovered: 48
2025-07-25 01:30:52,650  INFO     [pipeline:623]  üöÄ Starting parallel SDE loading with 2 workers
2025-07-25 01:30:52,651  ERROR    [etl.utils.performance:486]  ‚è±Ô∏è  sde_loading failed after 2.990s: 'ParallelProcessor' object has no attribute 'execute'
2025-07-25 01:30:52,651  ERROR    [etl.utils.performance:486]  ‚è±Ô∏è  pipeline_run failed after 529.244s: 'ParallelProcessor' object has no attribute 'execute'
