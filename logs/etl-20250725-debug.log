2025-07-25 01:22:03,402  INFO     [etl.mapping:95]  ‚öôÔ∏è  Loaded mapping settings: MappingSettings(default_schema='GNG', default_dataset_pattern='Underlag_{authority}', default_fc_pattern='{authority}_{source_name}', validate_datasets=True, create_missing_datasets=True, skip_unmappable_sources=False)
2025-07-25 01:22:03,402  INFO     [etl.mapping:117]  ‚úÖ Loaded 1 mappings from config\mappings.yaml
2025-07-25 01:22:03,403  INFO     [etl.mapping:64]  üó∫Ô∏è  Mapping manager initialized with 1 mappings
2025-07-25 01:22:03,403  INFO     [etl.monitoring:137]  üìä Metrics collector initialized (max_points=10000)
2025-07-25 01:22:03,406  INFO     [etl.monitoring:449]  üîç Pipeline monitor initialized
2025-07-25 01:22:03,406  INFO     [etl.utils.performance:367]  ‚ö° Parallel processor initialized: max_workers=2
2025-07-25 01:22:03,407  INFO     [etl.monitoring:465]  üöÄ Started pipeline run: pipeline_1753399323
2025-07-25 01:22:03,407  INFO     [pipeline:623]  üöÄ Starting ETL pipeline run - ID: pipeline_1753399323, Sources: config\sources.yaml
2025-07-25 01:22:03,409  INFO     [etl.utils.cleanup:35]  üìÅ Downloads folder is already empty
2025-07-25 01:22:03,410  INFO     [etl.utils.cleanup:77]  üìÅ Staging folder is already empty
2025-07-25 01:22:03,450  INFO     [etl.models:127]  ‚úÖ Loaded 53 sources from config\sources.yaml
2025-07-25 01:22:03,451  INFO     [pipeline:623]  üìã Found sources to process: 53
2025-07-25 01:22:03,451  INFO     [pipeline:623]  üöÄ Concurrent downloads enabled: REST=5, OGC=3, Files=4 workers
2025-07-25 01:22:03,451  INFO     [pipeline:623]  üöö F√∂rsvarsmakten - Rikst√§ckande geodata
2025-07-25 01:22:03,452  INFO     [etl.handlers.file:162]  üîó Single resource download mode for 'F√∂rsvarsmakten - Rikst√§ckande geodata' from URL: https://www.forsvarsmakten.se/siteassets/2-om-forsvarsmakten/samhallsplanering/geodata/rikstackande-geodata-forsvarsmakten.zip
2025-07-25 01:22:03,591  WARNING  [etl.utils.http:100]      HEAD request for Content-Disposition failed for https://www.forsvarsmakten.se/siteassets/2-om-forsvarsmakten/samhallsplanering/geodata/rikstackande-geodata-forsvarsmakten.zip: HTTP Error 403: Forbidden. Will fall back to URL basename.
2025-07-25 01:22:03,594  INFO     [etl.utils.http:110]      Derived filename by unquoting URL basename ('https://www.forsvarsmakten.se/siteassets/2-om-forsvarsmakten/samhallsplanering/geodata/rikstackande-geodata-forsvarsmakten.zip'): rikstackande-geodata-forsvarsmakten.zip
2025-07-25 01:22:03,597  DEBUG    [etl.handlers.file:247]  Attempting to download: https://www.forsvarsmakten.se/siteassets/2-om-forsvarsmakten/samhallsplanering/geodata/rikstackande-geodata-forsvarsmakten.zip 
    -> to local file: forsvarsmakten_-_rikstackande_geodata.zip 
    -> staging dir: data\staging\FM\forsvarsmakten_-_rikstackande_geodata
2025-07-25 01:22:03,606  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): www.forsvarsmakten.se:443
2025-07-25 01:22:03,679  DEBUG    [urllib3.connectionpool:544]  https://www.forsvarsmakten.se:443 "HEAD /siteassets/2-om-forsvarsmakten/samhallsplanering/geodata/rikstackande-geodata-forsvarsmakten.zip HTTP/1.1" 403 0
2025-07-25 01:22:03,680  INFO     [etl.utils.io:46]  ‚¨á forsvarsmakten_-_rikstackande_geodata.zip
2025-07-25 01:22:03,682  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): www.forsvarsmakten.se:443
2025-07-25 01:22:03,754  DEBUG    [urllib3.connectionpool:544]  https://www.forsvarsmakten.se:443 "GET /siteassets/2-om-forsvarsmakten/samhallsplanering/geodata/rikstackande-geodata-forsvarsmakten.zip HTTP/1.1" 200 1331177
2025-07-25 01:22:03,865  INFO     [etl.utils.io:82]  ‚úÖ forsvarsmakten_-_rikstackande_geodata.zip
2025-07-25 01:22:03,866  INFO     [etl.handlers.file:278]  Determined staged_data_type: 'shapefile_collection' for downloaded file 'forsvarsmakten_-_rikstackande_geodata.zip'
2025-07-25 01:22:03,866  INFO     [etl.utils.io:88]  üì¶ Extracting forsvarsmakten_-_rikstackande_geodata.zip ‚Üí C:\Git\ETL-pipeline\data\staging\FM\forsvarsmakten_-_rikstackande_geodata
2025-07-25 01:22:03,973  INFO     [etl.handlers.file:351]  ‚ûï Extracted and staged archive forsvarsmakten_-_rikstackande_geodata.zip to data\staging\FM\forsvarsmakten_-_rikstackande_geodata
2025-07-25 01:22:03,974  INFO     [pipeline:623]  üöö Naturv√•rdsverket - Naturv√•rdsregistret
2025-07-25 01:22:03,974  INFO     [etl.handlers.file:82]  üîó Multi-part download mode for 'Naturv√•rdsverket - Naturv√•rdsregistret' (19 archives from base URL 'https://geodata.naturvardsverket.se/nedladdning/naturvardsregistret/')‚Ä¶
2025-07-25 01:22:03,975  INFO     [etl.handlers.file:104]  üöÄ Starting concurrent download of 19 files
2025-07-25 01:22:03,975  INFO     [etl.utils.concurrent:86]  Initialized ConcurrentDownloadManager with 4 workers
2025-07-25 01:22:03,975  ERROR    [etl.handlers.file:73]  ‚ùå Failed to fetch source 'Naturv√•rdsverket - Naturv√•rdsregistret': ConcurrentFileDownloader.download_files_concurrent() got an unexpected keyword argument 'max_workers'
2025-07-25 01:22:03,975  INFO     [etl.utils.recovery:158]  üîÑ Attempting recovery from TypeError in download_source_Naturv√•rdsverket - Naturv√•rdsregistret: ConcurrentFileDownloader.download_files_concurrent() got an unexpected keyword argument 'max_workers'
2025-07-25 01:22:03,975  WARNING  [etl.utils.recovery:245]  ‚è≠Ô∏è Skipping failed operation: download_source_Naturv√•rdsverket - Naturv√•rdsregistret
2025-07-25 01:22:03,975  INFO     [etl.utils.recovery:214]  ‚úÖ Recovery successful using skip strategy
2025-07-25 01:22:03,976  INFO     [pipeline:623]  ‚úÖ Recovered from download error for Naturv√•rdsverket - Naturv√•rdsregistret
2025-07-25 01:22:03,976  INFO     [pipeline:623]  üöö Milj√∂riskomr√•de
2025-07-25 01:22:03,977  INFO     [etl.handlers.atom_feed:41]  üåê Reading Atom feed for source 'Milj√∂riskomr√•de' from URL: https://ext-dokument.lansstyrelsen.se/gemensamt/geodata/ATOM/ATOM_lst.LST_Miljoriskomrade.xml
2025-07-25 01:22:03,979  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): ext-dokument.lansstyrelsen.se:443
2025-07-25 01:22:04,136  DEBUG    [urllib3.connectionpool:544]  https://ext-dokument.lansstyrelsen.se:443 "HEAD /gemensamt/geodata/ATOM/ATOM_lst.LST_Miljoriskomrade.xml HTTP/1.1" 200 0
2025-07-25 01:22:04,137  INFO     [etl.utils.io:44]  ‚¨á miljoriskomrade_feed.xml (1.0 KB)
2025-07-25 01:22:04,139  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): ext-dokument.lansstyrelsen.se:443
2025-07-25 01:22:04,249  DEBUG    [urllib3.connectionpool:544]  https://ext-dokument.lansstyrelsen.se:443 "GET /gemensamt/geodata/ATOM/ATOM_lst.LST_Miljoriskomrade.xml HTTP/1.1" 200 1034
2025-07-25 01:22:04,251  INFO     [etl.utils.io:82]  ‚úÖ miljoriskomrade_feed.xml
2025-07-25 01:22:04,255  INFO     [etl.handlers.atom_feed:77]  Target staging directory for all content from Atom source 'Milj√∂riskomr√•de': data\staging\LST\miljoriskomrade
2025-07-25 01:22:04,256  INFO     [etl.handlers.atom_feed:105]  Found linked resource in Atom feed for 'Milj√∂riskomr√•de': https://ext-dokument.lansstyrelsen.se/gemensamt/geodata/ShapeExport/lst.LST_Miljoriskomrade.zip
2025-07-25 01:22:04,421  INFO     [etl.utils.http:110]      Derived filename by unquoting URL basename ('https://ext-dokument.lansstyrelsen.se/gemensamt/geodata/ShapeExport/lst.LST_Miljoriskomrade.zip'): lst.LST_Miljoriskomrade.zip
2025-07-25 01:22:04,421  INFO     [etl.handlers.atom_feed:157]  Attempting to download linked resource: https://ext-dokument.lansstyrelsen.se/gemensamt/geodata/ShapeExport/lst.LST_Miljoriskomrade.zip 
        -> to local file: lst_lst_miljoriskomrade.zip
2025-07-25 01:22:04,425  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): ext-dokument.lansstyrelsen.se:443
2025-07-25 01:22:04,538  DEBUG    [urllib3.connectionpool:544]  https://ext-dokument.lansstyrelsen.se:443 "HEAD /gemensamt/geodata/ShapeExport/lst.LST_Miljoriskomrade.zip HTTP/1.1" 200 0
2025-07-25 01:22:04,539  INFO     [etl.utils.io:44]  ‚¨á lst_lst_miljoriskomrade.zip (74.2 KB)
2025-07-25 01:22:04,542  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): ext-dokument.lansstyrelsen.se:443
2025-07-25 01:22:04,667  DEBUG    [urllib3.connectionpool:544]  https://ext-dokument.lansstyrelsen.se:443 "GET /gemensamt/geodata/ShapeExport/lst.LST_Miljoriskomrade.zip HTTP/1.1" 200 75966
2025-07-25 01:22:04,708  INFO     [etl.utils.io:82]  ‚úÖ lst_lst_miljoriskomrade.zip
2025-07-25 01:22:04,709  INFO     [etl.handlers.atom_feed:168]  Downloaded file 'lst_lst_miljoriskomrade.zip' is a ZIP archive. Extracting...
2025-07-25 01:22:04,709  INFO     [etl.utils.io:88]  üì¶ Extracting lst_lst_miljoriskomrade.zip ‚Üí C:\Git\ETL-pipeline\data\staging\LST\miljoriskomrade
2025-07-25 01:22:04,725  INFO     [etl.handlers.atom_feed:173]  ‚ûï Extracted and staged archive lst_lst_miljoriskomrade.zip into data\staging\LST\miljoriskomrade
2025-07-25 01:22:04,725  INFO     [etl.handlers.atom_feed:180]  Source 'Milj√∂riskomr√•de' expects a GPKG. Searching in extracted contents of lst_lst_miljoriskomrade.zip...
2025-07-25 01:22:04,727  INFO     [etl.handlers.atom_feed:197]  Renaming/moving extracted GPKG 'lst.LST_Miljoriskomrade.gpkg' to 'miljoriskomrade.gpkg'
2025-07-25 01:22:04,727  INFO     [etl.handlers.atom_feed:207]  ‚úÖ Successfully staged GPKG 'miljoriskomrade.gpkg' for source 'Milj√∂riskomr√•de'.
2025-07-25 01:22:04,728  INFO     [pipeline:623]  üöö Vindkraftskollen: Vindkraftverk
2025-07-25 01:22:04,728  INFO     [etl.handlers.atom_feed:41]  üåê Reading Atom feed for source 'Vindkraftskollen: Vindkraftverk' from URL: https://ext-dokument.lansstyrelsen.se/gemensamt/geodata/ATOM/ATOM_lst.vbk_vindkraftverk.xml
2025-07-25 01:22:04,730  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): ext-dokument.lansstyrelsen.se:443
2025-07-25 01:22:04,856  DEBUG    [urllib3.connectionpool:544]  https://ext-dokument.lansstyrelsen.se:443 "HEAD /gemensamt/geodata/ATOM/ATOM_lst.vbk_vindkraftverk.xml HTTP/1.1" 200 0
2025-07-25 01:22:04,857  INFO     [etl.utils.io:44]  ‚¨á vindkraftskollen_vindkraftverk_feed.xml (1.0 KB)
2025-07-25 01:22:04,858  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): ext-dokument.lansstyrelsen.se:443
2025-07-25 01:22:04,951  DEBUG    [urllib3.connectionpool:544]  https://ext-dokument.lansstyrelsen.se:443 "GET /gemensamt/geodata/ATOM/ATOM_lst.vbk_vindkraftverk.xml HTTP/1.1" 200 1037
2025-07-25 01:22:04,952  INFO     [etl.utils.io:82]  ‚úÖ vindkraftskollen_vindkraftverk_feed.xml
2025-07-25 01:22:04,954  INFO     [etl.handlers.atom_feed:77]  Target staging directory for all content from Atom source 'Vindkraftskollen: Vindkraftverk': data\staging\LST\vindkraftskollen_vindkraftverk
2025-07-25 01:22:04,954  INFO     [etl.handlers.atom_feed:105]  Found linked resource in Atom feed for 'Vindkraftskollen: Vindkraftverk': https://ext-dokument.lansstyrelsen.se/gemensamt/geodata/ShapeExport/lst.vbk_vindkraftverk.zip
2025-07-25 01:22:05,100  INFO     [etl.utils.http:110]      Derived filename by unquoting URL basename ('https://ext-dokument.lansstyrelsen.se/gemensamt/geodata/ShapeExport/lst.vbk_vindkraftverk.zip'): lst.vbk_vindkraftverk.zip
2025-07-25 01:22:05,102  INFO     [etl.handlers.atom_feed:157]  Attempting to download linked resource: https://ext-dokument.lansstyrelsen.se/gemensamt/geodata/ShapeExport/lst.vbk_vindkraftverk.zip 
        -> to local file: lst_vbk_vindkraftverk.zip
2025-07-25 01:22:05,105  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): ext-dokument.lansstyrelsen.se:443
2025-07-25 01:22:05,219  DEBUG    [urllib3.connectionpool:544]  https://ext-dokument.lansstyrelsen.se:443 "HEAD /gemensamt/geodata/ShapeExport/lst.vbk_vindkraftverk.zip HTTP/1.1" 200 0
2025-07-25 01:22:05,221  INFO     [etl.utils.io:44]  ‚¨á lst_vbk_vindkraftverk.zip (4.1 MB)
2025-07-25 01:22:05,223  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): ext-dokument.lansstyrelsen.se:443
2025-07-25 01:22:05,361  DEBUG    [urllib3.connectionpool:544]  https://ext-dokument.lansstyrelsen.se:443 "GET /gemensamt/geodata/ShapeExport/lst.vbk_vindkraftverk.zip HTTP/1.1" 200 4321083
2025-07-25 01:22:06,356  INFO     [etl.utils.io:82]  ‚úÖ lst_vbk_vindkraftverk.zip
2025-07-25 01:22:06,357  INFO     [etl.handlers.atom_feed:168]  Downloaded file 'lst_vbk_vindkraftverk.zip' is a ZIP archive. Extracting...
2025-07-25 01:22:06,357  INFO     [etl.utils.io:88]  üì¶ Extracting lst_vbk_vindkraftverk.zip ‚Üí C:\Git\ETL-pipeline\data\staging\LST\vindkraftskollen_vindkraftverk
2025-07-25 01:22:06,499  INFO     [etl.handlers.atom_feed:173]  ‚ûï Extracted and staged archive lst_vbk_vindkraftverk.zip into data\staging\LST\vindkraftskollen_vindkraftverk
2025-07-25 01:22:06,499  INFO     [etl.handlers.atom_feed:180]  Source 'Vindkraftskollen: Vindkraftverk' expects a GPKG. Searching in extracted contents of lst_vbk_vindkraftverk.zip...
2025-07-25 01:22:06,500  INFO     [etl.handlers.atom_feed:197]  Renaming/moving extracted GPKG 'lst.vbk_vindkraftverk.gpkg' to 'vindkraftskollen_vindkraftverk.gpkg'
2025-07-25 01:22:06,501  INFO     [etl.handlers.atom_feed:207]  ‚úÖ Successfully staged GPKG 'vindkraftskollen_vindkraftverk.gpkg' for source 'Vindkraftskollen: Vindkraftverk'.
2025-07-25 01:22:06,501  INFO     [pipeline:623]  üöö Vindkraftskollen: Projekteringsomr√•den
2025-07-25 01:22:06,502  INFO     [etl.handlers.atom_feed:41]  üåê Reading Atom feed for source 'Vindkraftskollen: Projekteringsomr√•den' from URL: https://ext-dokument.lansstyrelsen.se/gemensamt/geodata/ATOM/ATOM_lst.vbk_projekteringsomraden.xml
2025-07-25 01:22:06,503  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): ext-dokument.lansstyrelsen.se:443
2025-07-25 01:22:06,631  DEBUG    [urllib3.connectionpool:544]  https://ext-dokument.lansstyrelsen.se:443 "HEAD /gemensamt/geodata/ATOM/ATOM_lst.vbk_projekteringsomraden.xml HTTP/1.1" 200 0
2025-07-25 01:22:06,632  INFO     [etl.utils.io:44]  ‚¨á vindkraftskollen_projekteringsomraden_feed.xml (1.0 KB)
2025-07-25 01:22:06,635  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): ext-dokument.lansstyrelsen.se:443
2025-07-25 01:22:06,752  DEBUG    [urllib3.connectionpool:544]  https://ext-dokument.lansstyrelsen.se:443 "GET /gemensamt/geodata/ATOM/ATOM_lst.vbk_projekteringsomraden.xml HTTP/1.1" 200 1049
2025-07-25 01:22:06,754  INFO     [etl.utils.io:82]  ‚úÖ vindkraftskollen_projekteringsomraden_feed.xml
2025-07-25 01:22:06,757  INFO     [etl.handlers.atom_feed:77]  Target staging directory for all content from Atom source 'Vindkraftskollen: Projekteringsomr√•den': data\staging\LST\vindkraftskollen_projekteringsomraden
2025-07-25 01:22:06,757  INFO     [etl.handlers.atom_feed:105]  Found linked resource in Atom feed for 'Vindkraftskollen: Projekteringsomr√•den': https://ext-dokument.lansstyrelsen.se/gemensamt/geodata/ShapeExport/lst.vbk_projekteringsomraden.zip
2025-07-25 01:22:06,882  INFO     [etl.utils.http:110]      Derived filename by unquoting URL basename ('https://ext-dokument.lansstyrelsen.se/gemensamt/geodata/ShapeExport/lst.vbk_projekteringsomraden.zip'): lst.vbk_projekteringsomraden.zip
2025-07-25 01:22:06,882  INFO     [etl.handlers.atom_feed:157]  Attempting to download linked resource: https://ext-dokument.lansstyrelsen.se/gemensamt/geodata/ShapeExport/lst.vbk_projekteringsomraden.zip 
        -> to local file: lst_vbk_projekteringsomraden.zip
2025-07-25 01:22:06,884  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): ext-dokument.lansstyrelsen.se:443
2025-07-25 01:22:06,993  DEBUG    [urllib3.connectionpool:544]  https://ext-dokument.lansstyrelsen.se:443 "HEAD /gemensamt/geodata/ShapeExport/lst.vbk_projekteringsomraden.zip HTTP/1.1" 200 0
2025-07-25 01:22:06,993  INFO     [etl.utils.io:44]  ‚¨á lst_vbk_projekteringsomraden.zip (4.5 MB)
2025-07-25 01:22:06,995  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): ext-dokument.lansstyrelsen.se:443
2025-07-25 01:22:07,113  DEBUG    [urllib3.connectionpool:544]  https://ext-dokument.lansstyrelsen.se:443 "GET /gemensamt/geodata/ShapeExport/lst.vbk_projekteringsomraden.zip HTTP/1.1" 200 4735498
2025-07-25 01:22:07,434  INFO     [etl.utils.io:82]  ‚úÖ lst_vbk_projekteringsomraden.zip
2025-07-25 01:22:07,435  INFO     [etl.handlers.atom_feed:168]  Downloaded file 'lst_vbk_projekteringsomraden.zip' is a ZIP archive. Extracting...
2025-07-25 01:22:07,435  INFO     [etl.utils.io:88]  üì¶ Extracting lst_vbk_projekteringsomraden.zip ‚Üí C:\Git\ETL-pipeline\data\staging\LST\vindkraftskollen_projekteringsomraden
2025-07-25 01:22:07,520  INFO     [etl.handlers.atom_feed:173]  ‚ûï Extracted and staged archive lst_vbk_projekteringsomraden.zip into data\staging\LST\vindkraftskollen_projekteringsomraden
2025-07-25 01:22:07,520  INFO     [etl.handlers.atom_feed:180]  Source 'Vindkraftskollen: Projekteringsomr√•den' expects a GPKG. Searching in extracted contents of lst_vbk_projekteringsomraden.zip...
2025-07-25 01:22:07,522  INFO     [etl.handlers.atom_feed:197]  Renaming/moving extracted GPKG 'lst.vbk_projekteringsomraden.gpkg' to 'vindkraftskollen_projekteringsomraden.gpkg'
2025-07-25 01:22:07,523  INFO     [etl.handlers.atom_feed:207]  ‚úÖ Successfully staged GPKG 'vindkraftskollen_projekteringsomraden.gpkg' for source 'Vindkraftskollen: Projekteringsomr√•den'.
2025-07-25 01:22:07,524  INFO     [pipeline:623]  üöö Potentiellt f√∂rorenade omr√•den
2025-07-25 01:22:07,525  INFO     [etl.handlers.file:162]  üîó Single resource download mode for 'Potentiellt f√∂rorenade omr√•den' from URL: https://ext-dokument.lansstyrelsen.se/Gemensamt/Geodata/Datadistribution/SWEREF99TM/EBH_Potentiellt_fororenade_omraden.zip
2025-07-25 01:22:07,683  INFO     [etl.utils.http:110]      Derived filename by unquoting URL basename ('https://ext-dokument.lansstyrelsen.se/Gemensamt/Geodata/Datadistribution/SWEREF99TM/EBH_Potentiellt_fororenade_omraden.zip'): EBH_Potentiellt_fororenade_omraden.zip
2025-07-25 01:22:07,685  DEBUG    [etl.handlers.file:247]  Attempting to download: https://ext-dokument.lansstyrelsen.se/Gemensamt/Geodata/Datadistribution/SWEREF99TM/EBH_Potentiellt_fororenade_omraden.zip 
    -> to local file: potentiellt_fororenade_omraden.zip 
    -> staging dir: data\staging\LST\potentiellt_fororenade_omraden
2025-07-25 01:22:07,689  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): ext-dokument.lansstyrelsen.se:443
2025-07-25 01:22:07,808  DEBUG    [urllib3.connectionpool:544]  https://ext-dokument.lansstyrelsen.se:443 "HEAD /Gemensamt/Geodata/Datadistribution/SWEREF99TM/EBH_Potentiellt_fororenade_omraden.zip HTTP/1.1" 200 0
2025-07-25 01:22:07,809  INFO     [etl.utils.io:44]  ‚¨á potentiellt_fororenade_omraden.zip (5.0 MB)
2025-07-25 01:22:07,810  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): ext-dokument.lansstyrelsen.se:443
2025-07-25 01:22:07,907  DEBUG    [urllib3.connectionpool:544]  https://ext-dokument.lansstyrelsen.se:443 "GET /Gemensamt/Geodata/Datadistribution/SWEREF99TM/EBH_Potentiellt_fororenade_omraden.zip HTTP/1.1" 200 5250357
2025-07-25 01:22:08,659  INFO     [etl.utils.io:82]  ‚úÖ potentiellt_fororenade_omraden.zip
2025-07-25 01:22:08,660  INFO     [etl.handlers.file:278]  Determined staged_data_type: 'shapefile_collection' for downloaded file 'potentiellt_fororenade_omraden.zip'
2025-07-25 01:22:08,660  INFO     [etl.utils.io:88]  üì¶ Extracting potentiellt_fororenade_omraden.zip ‚Üí C:\Git\ETL-pipeline\data\staging\LST\potentiellt_fororenade_omraden
2025-07-25 01:22:08,915  INFO     [etl.handlers.file:351]  ‚ûï Extracted and staged archive potentiellt_fororenade_omraden.zip to data\staging\LST\potentiellt_fororenade_omraden
2025-07-25 01:22:08,915  INFO     [pipeline:623]  üöö Riksintressen
2025-07-25 01:22:08,916  INFO     [etl.handlers.rest_api:68]  üöÄ Initializing RestApiDownloadHandler for source: Riksintressen
2025-07-25 01:22:08,916  INFO     [etl.handlers.rest_api:321]  üåê Processing REST API source: 'Riksintressen' from URL: https://ext-geodata-nationella.lansstyrelsen.se/arcgis/rest/services/LST/lst_lst_riksintressen_4/MapServer
2025-07-25 01:22:08,918  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): ext-geodata-nationella.lansstyrelsen.se:443
2025-07-25 01:22:09,048  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-nationella.lansstyrelsen.se:443 "GET /arcgis/rest/services/LST/lst_lst_riksintressen_4/MapServer?f=json HTTP/1.1" 200 1106
2025-07-25 01:22:09,049  INFO     [etl.handlers.rest_api:346]  Found explicit layer_ids in config: [0] for source 'Riksintressen'. Processing only these.
2025-07-25 01:22:09,050  INFO     [etl.handlers.rest_api:427]  Source 'Riksintressen': Will attempt to query 1 layer(s): ['0']
2025-07-25 01:22:09,050  INFO     [etl.handlers.rest_api:659]  üöö lst_riksintresse_rorligt_friluftsliv_mb4kap_1plus2
2025-07-25 01:22:09,050  DEBUG    [etl.handlers.rest_api:660]  Querying Layer ID: 0 (Sanitized Name: lst_riksintresse_rorligt_friluftsliv_mb4kap_1plus2, Original: LST_Riksintresse_Rorligt_Friluftsliv_MB4kap_1plus2) from https://ext-geodata-nationella.lansstyrelsen.se/arcgis/rest/services/LST/lst_lst_riksintressen_4/MapServer/0/query
2025-07-25 01:22:09,050  DEBUG    [etl.handlers.rest_api:530]  maxRecordCount not found in layer metadata, using default: 5000
2025-07-25 01:22:09,050  DEBUG    [etl.handlers.rest_api:199]  Applying BBOX: 586206,6551160,647910,6610992 (SRID: 3006)
2025-07-25 01:22:09,051  DEBUG    [etl.handlers.rest_api:565]  Fetching page 1 for layer lst_riksintresse_rorligt_friluftsliv_mb4kap_1plus2 (offset 0, limit 5000)
2025-07-25 01:22:09,179  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-nationella.lansstyrelsen.se:443 "GET /arcgis/rest/services/LST/lst_lst_riksintressen_4/MapServer/0/query?where=1%3D1&outFields=%2A&returnGeometry=true&f=geojson&geometry=586206%2C6551160%2C647910%2C6610992&geometryType=esriGeometryEnvelope&inSR=3006&spatialRel=esriSpatialRelIntersects&resultOffset=0&resultRecordCount=5000 HTTP/1.1" 200 None
2025-07-25 01:22:09,290  DEBUG    [etl.handlers.rest_api:279]  üèÅ All features likely retrieved for layer lst_riksintresse_rorligt_friluftsliv_mb4kap_1plus2 (less than page limit or server maxRecordCount is 0).
2025-07-25 01:22:09,361  INFO     [etl.handlers.rest_api:298]  ‚úÖ lst_riksintresse_rorligt_friluftsliv_mb4kap_1plus2: 6 features
2025-07-25 01:22:09,361  DEBUG    [etl.handlers.rest_api:299]  üíæ Successfully saved 6 features for layer lst_riksintresse_rorligt_friluftsliv_mb4kap_1plus2 to C:\Git\ETL-pipeline\data\staging\LST\riksintressen\lst_riksintresse_rorligt_friluftsliv_mb4kap_1plus2.geojson
2025-07-25 01:22:09,362  INFO     [pipeline:623]  üöö Riksintressen - Vindbruk
2025-07-25 01:22:09,362  INFO     [etl.handlers.rest_api:68]  üöÄ Initializing RestApiDownloadHandler for source: Riksintressen - Vindbruk
2025-07-25 01:22:09,362  INFO     [etl.handlers.rest_api:321]  üåê Processing REST API source: 'Riksintressen - Vindbruk' from URL: https://ext-geodata-nationella.lansstyrelsen.se/arcgis/rest/services/LST/lst_lst_riksintressen_vindbruk_4/MapServer
2025-07-25 01:22:09,386  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-nationella.lansstyrelsen.se:443 "GET /arcgis/rest/services/LST/lst_lst_riksintressen_vindbruk_4/MapServer?f=json HTTP/1.1" 200 123
2025-07-25 01:22:09,386  WARNING  [etl.handlers.rest_api:419]  ‚ö†Ô∏è No layers identified or specified to query for source 'Riksintressen - Vindbruk'. Check service metadata and `layer_ids` config.
2025-07-25 01:22:09,388  INFO     [pipeline:623]  üöö LstD F√∂reskrifter
2025-07-25 01:22:09,388  INFO     [etl.handlers.rest_api:68]  üöÄ Initializing RestApiDownloadHandler for source: LstD F√∂reskrifter
2025-07-25 01:22:09,389  INFO     [etl.handlers.rest_api:321]  üåê Processing REST API source: 'LstD F√∂reskrifter' from URL: https://ext-geodata-lokala-visning.lansstyrelsen.se/arcgis/rest/services/LSTD/LstD_Foreskrifter_EXT/MapServer
2025-07-25 01:22:09,390  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): ext-geodata-lokala-visning.lansstyrelsen.se:443
2025-07-25 01:22:09,567  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-lokala-visning.lansstyrelsen.se:443 "GET /arcgis/rest/services/LSTD/LstD_Foreskrifter_EXT/MapServer?f=json HTTP/1.1" 200 None
2025-07-25 01:22:09,568  INFO     [etl.handlers.rest_api:380]  No explicit layer_ids in config for source 'LstD F√∂reskrifter'. Discovering all layers from service metadata.
2025-07-25 01:22:09,569  INFO     [etl.handlers.rest_api:427]  Source 'LstD F√∂reskrifter': Will attempt to query 1 layer(s): ['0']
2025-07-25 01:22:09,569  INFO     [etl.handlers.rest_api:659]  üöö lstd_sjotrafikforeskrifter
2025-07-25 01:22:09,569  DEBUG    [etl.handlers.rest_api:660]  Querying Layer ID: 0 (Sanitized Name: lstd_sjotrafikforeskrifter, Original: LstD Sj√∂trafikf√∂reskrifter) from https://ext-geodata-lokala-visning.lansstyrelsen.se/arcgis/rest/services/LSTD/LstD_Foreskrifter_EXT/MapServer/0/query
2025-07-25 01:22:09,569  DEBUG    [etl.handlers.rest_api:530]  maxRecordCount not found in layer metadata, using default: 5000
2025-07-25 01:22:09,569  DEBUG    [etl.handlers.rest_api:199]  Applying BBOX: 586206,6551160,647910,6610992 (SRID: 3006)
2025-07-25 01:22:09,571  DEBUG    [etl.handlers.rest_api:565]  Fetching page 1 for layer lstd_sjotrafikforeskrifter (offset 0, limit 5000)
2025-07-25 01:22:10,696  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-lokala-visning.lansstyrelsen.se:443 "GET /arcgis/rest/services/LSTD/LstD_Foreskrifter_EXT/MapServer/0/query?where=1%3D1&outFields=%2A&returnGeometry=true&f=geojson&geometry=586206%2C6551160%2C647910%2C6610992&geometryType=esriGeometryEnvelope&inSR=3006&spatialRel=esriSpatialRelIntersects&resultOffset=0&resultRecordCount=5000 HTTP/1.1" 200 None
2025-07-25 01:22:11,991  DEBUG    [etl.handlers.rest_api:279]  üèÅ All features likely retrieved for layer lstd_sjotrafikforeskrifter (less than page limit or server maxRecordCount is 0).
2025-07-25 01:22:12,207  INFO     [etl.handlers.rest_api:298]  ‚úÖ lstd_sjotrafikforeskrifter: 61 features
2025-07-25 01:22:12,207  DEBUG    [etl.handlers.rest_api:299]  üíæ Successfully saved 61 features for layer lstd_sjotrafikforeskrifter to C:\Git\ETL-pipeline\data\staging\LSTD\lstd_foreskrifter\lstd_sjotrafikforeskrifter.geojson
2025-07-25 01:22:12,209  INFO     [pipeline:623]  üöö LstD Fysisk planering
2025-07-25 01:22:12,210  INFO     [etl.handlers.rest_api:68]  üöÄ Initializing RestApiDownloadHandler for source: LstD Fysisk planering
2025-07-25 01:22:12,210  INFO     [etl.handlers.rest_api:321]  üåê Processing REST API source: 'LstD Fysisk planering' from URL: https://ext-geodata-lokala-visning.lansstyrelsen.se/arcgis/rest/services/LSTD/LstD_Fysisk_planering_EXT/MapServer
2025-07-25 01:22:12,249  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-lokala-visning.lansstyrelsen.se:443 "GET /arcgis/rest/services/LSTD/LstD_Fysisk_planering_EXT/MapServer?f=json HTTP/1.1" 200 None
2025-07-25 01:22:12,249  WARNING  [etl.handlers.rest_api:419]  ‚ö†Ô∏è No layers identified or specified to query for source 'LstD Fysisk planering'. Check service metadata and `layer_ids` config.
2025-07-25 01:22:12,250  INFO     [pipeline:623]  üöö LstD Ett rikt odlingslandskap
2025-07-25 01:22:12,250  INFO     [etl.handlers.rest_api:68]  üöÄ Initializing RestApiDownloadHandler for source: LstD Ett rikt odlingslandskap
2025-07-25 01:22:12,250  INFO     [etl.handlers.rest_api:321]  üåê Processing REST API source: 'LstD Ett rikt odlingslandskap' from URL: https://ext-geodata-lokala-visning.lansstyrelsen.se/arcgis/rest/services/LSTD/LstD_GI_Ett_rikt_odlingslandskap_EXT/MapServer
2025-07-25 01:22:13,027  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-lokala-visning.lansstyrelsen.se:443 "GET /arcgis/rest/services/LSTD/LstD_GI_Ett_rikt_odlingslandskap_EXT/MapServer?f=json HTTP/1.1" 200 None
2025-07-25 01:22:13,028  INFO     [etl.handlers.rest_api:346]  Found explicit layer_ids in config: [2, 3, 4, 5, 6] for source 'LstD Ett rikt odlingslandskap'. Processing only these.
2025-07-25 01:22:13,029  INFO     [etl.handlers.rest_api:427]  Source 'LstD Ett rikt odlingslandskap': Will attempt to query 5 layer(s): ['2', '3', '4', '5', '6']
2025-07-25 01:22:13,029  INFO     [etl.handlers.rest_api:447]  üöÄ Starting concurrent download of 5 layers
2025-07-25 01:22:13,029  INFO     [etl.utils.concurrent:86]  Initialized ConcurrentDownloadManager with 5 workers
2025-07-25 01:22:13,030  INFO     [etl.utils.concurrent:261]  Starting concurrent download of 5 layers
2025-07-25 01:22:13,030  INFO     [etl.utils.concurrent:121]  Starting concurrent execution of 5 tasks with 5 workers
2025-07-25 01:22:13,038  INFO     [etl.utils.concurrent:215]  Concurrent execution completed: 0/5 successful (0.0%), avg=0.00s, max=0.00s, total=0.00s
2025-07-25 01:22:13,039  INFO     [etl.handlers.rest_api:480]  üèÅ Concurrent downloads completed: 0 successful, 5 failed
2025-07-25 01:22:13,039  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_LstD GI Betesmark - Exempelanalys - Spridningsl√§nkar mellan kluster - Under 500 m - name 'time' is not defined
2025-07-25 01:22:13,039  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_LstD GI Jordbruksmark - Tv√§rvillkorselement - Ytor - name 'time' is not defined
2025-07-25 01:22:13,039  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_LstD GI V√§rdetrakter naturbetesmark - name 'time' is not defined
2025-07-25 01:22:13,039  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_LstD GI Betesmark - Exempelanalys - Kluster av betesmarker - Buffert 250 m - name 'time' is not defined
2025-07-25 01:22:13,039  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_LstD GI Jordbruksmark - √Ökerholmar - name 'time' is not defined
2025-07-25 01:22:13,039  INFO     [pipeline:623]  üöö LstD Friluftsliv
2025-07-25 01:22:13,041  INFO     [etl.handlers.rest_api:68]  üöÄ Initializing RestApiDownloadHandler for source: LstD Friluftsliv
2025-07-25 01:22:13,041  INFO     [etl.handlers.rest_api:321]  üåê Processing REST API source: 'LstD Friluftsliv' from URL: https://ext-geodata-lokala-visning.lansstyrelsen.se/arcgis/rest/services/LSTD/LstD_GI_Friluftsliv_EXT/MapServer
2025-07-25 01:22:13,083  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-lokala-visning.lansstyrelsen.se:443 "GET /arcgis/rest/services/LSTD/LstD_GI_Friluftsliv_EXT/MapServer?f=json HTTP/1.1" 200 None
2025-07-25 01:22:13,084  INFO     [etl.handlers.rest_api:346]  Found explicit layer_ids in config: [0, 1, 2, 3, 4] for source 'LstD Friluftsliv'. Processing only these.
2025-07-25 01:22:13,085  WARNING  [etl.handlers.rest_api:364]  Layer ID '0' specified in config for source 'LstD Friluftsliv' was not found in the service's layer metadata list. Will attempt to query it using this ID and a placeholder name.
2025-07-25 01:22:13,085  WARNING  [etl.handlers.rest_api:364]  Layer ID '1' specified in config for source 'LstD Friluftsliv' was not found in the service's layer metadata list. Will attempt to query it using this ID and a placeholder name.
2025-07-25 01:22:13,085  WARNING  [etl.handlers.rest_api:364]  Layer ID '2' specified in config for source 'LstD Friluftsliv' was not found in the service's layer metadata list. Will attempt to query it using this ID and a placeholder name.
2025-07-25 01:22:13,085  WARNING  [etl.handlers.rest_api:364]  Layer ID '3' specified in config for source 'LstD Friluftsliv' was not found in the service's layer metadata list. Will attempt to query it using this ID and a placeholder name.
2025-07-25 01:22:13,085  WARNING  [etl.handlers.rest_api:364]  Layer ID '4' specified in config for source 'LstD Friluftsliv' was not found in the service's layer metadata list. Will attempt to query it using this ID and a placeholder name.
2025-07-25 01:22:13,085  INFO     [etl.handlers.rest_api:427]  Source 'LstD Friluftsliv': Will attempt to query 5 layer(s): ['0', '1', '2', '3', '4']
2025-07-25 01:22:13,085  INFO     [etl.handlers.rest_api:447]  üöÄ Starting concurrent download of 5 layers
2025-07-25 01:22:13,085  INFO     [etl.utils.concurrent:261]  Starting concurrent download of 5 layers
2025-07-25 01:22:13,086  INFO     [etl.utils.concurrent:121]  Starting concurrent execution of 5 tasks with 5 workers
2025-07-25 01:22:13,091  INFO     [etl.utils.concurrent:215]  Concurrent execution completed: 0/5 successful (0.0%), avg=0.00s, max=0.00s, total=0.00s
2025-07-25 01:22:13,093  INFO     [etl.handlers.rest_api:480]  üèÅ Concurrent downloads completed: 0 successful, 5 failed
2025-07-25 01:22:13,093  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_layer_0_cfg_only - name 'time' is not defined
2025-07-25 01:22:13,093  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_layer_1_cfg_only - name 'time' is not defined
2025-07-25 01:22:13,093  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_layer_2_cfg_only - name 'time' is not defined
2025-07-25 01:22:13,093  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_layer_3_cfg_only - name 'time' is not defined
2025-07-25 01:22:13,094  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_layer_4_cfg_only - name 'time' is not defined
2025-07-25 01:22:13,094  INFO     [pipeline:623]  üöö LstD God bebyggd milj√∂
2025-07-25 01:22:13,095  INFO     [etl.handlers.rest_api:68]  üöÄ Initializing RestApiDownloadHandler for source: LstD God bebyggd milj√∂
2025-07-25 01:22:13,095  INFO     [etl.handlers.rest_api:321]  üåê Processing REST API source: 'LstD God bebyggd milj√∂' from URL: https://ext-geodata-lokala-visning.lansstyrelsen.se/arcgis/rest/services/LSTD/LstD_GI_God_bebyggd_miljo_EXT/MapServer
2025-07-25 01:22:14,191  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-lokala-visning.lansstyrelsen.se:443 "GET /arcgis/rest/services/LSTD/LstD_GI_God_bebyggd_miljo_EXT/MapServer?f=json HTTP/1.1" 200 None
2025-07-25 01:22:14,192  INFO     [etl.handlers.rest_api:380]  No explicit layer_ids in config for source 'LstD God bebyggd milj√∂'. Discovering all layers from service metadata.
2025-07-25 01:22:14,192  INFO     [etl.handlers.rest_api:427]  Source 'LstD God bebyggd milj√∂': Will attempt to query 1 layer(s): ['0']
2025-07-25 01:22:14,192  INFO     [etl.handlers.rest_api:659]  üöö lstd_gi_opaverkade_omraden_-_avgransning
2025-07-25 01:22:14,192  DEBUG    [etl.handlers.rest_api:660]  Querying Layer ID: 0 (Sanitized Name: lstd_gi_opaverkade_omraden_-_avgransning, Original: LstD GI Op√•verkade omr√•den - Avgr√§nsning) from https://ext-geodata-lokala-visning.lansstyrelsen.se/arcgis/rest/services/LSTD/LstD_GI_God_bebyggd_miljo_EXT/MapServer/0/query
2025-07-25 01:22:14,192  DEBUG    [etl.handlers.rest_api:530]  maxRecordCount not found in layer metadata, using default: 5000
2025-07-25 01:22:14,192  DEBUG    [etl.handlers.rest_api:199]  Applying BBOX: 586206,6551160,647910,6610992 (SRID: 3006)
2025-07-25 01:22:14,193  DEBUG    [etl.handlers.rest_api:565]  Fetching page 1 for layer lstd_gi_opaverkade_omraden_-_avgransning (offset 0, limit 5000)
2025-07-25 01:22:15,086  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-lokala-visning.lansstyrelsen.se:443 "GET /arcgis/rest/services/LSTD/LstD_GI_God_bebyggd_miljo_EXT/MapServer/0/query?where=1%3D1&outFields=%2A&returnGeometry=true&f=geojson&geometry=586206%2C6551160%2C647910%2C6610992&geometryType=esriGeometryEnvelope&inSR=3006&spatialRel=esriSpatialRelIntersects&resultOffset=0&resultRecordCount=5000 HTTP/1.1" 200 None
2025-07-25 01:22:15,176  DEBUG    [etl.handlers.rest_api:279]  üèÅ All features likely retrieved for layer lstd_gi_opaverkade_omraden_-_avgransning (less than page limit or server maxRecordCount is 0).
2025-07-25 01:22:15,201  INFO     [etl.handlers.rest_api:298]  ‚úÖ lstd_gi_opaverkade_omraden_-_avgransning: 10 features
2025-07-25 01:22:15,202  DEBUG    [etl.handlers.rest_api:299]  üíæ Successfully saved 10 features for layer lstd_gi_opaverkade_omraden_-_avgransning to C:\Git\ETL-pipeline\data\staging\LSTD\lstd_god_bebyggd_miljo\lstd_gi_opaverkade_omraden_-_avgransning.geojson
2025-07-25 01:22:15,202  INFO     [pipeline:623]  üöö LstD Hav i balans
2025-07-25 01:22:15,202  INFO     [etl.handlers.rest_api:68]  üöÄ Initializing RestApiDownloadHandler for source: LstD Hav i balans
2025-07-25 01:22:15,203  INFO     [etl.handlers.rest_api:321]  üåê Processing REST API source: 'LstD Hav i balans' from URL: https://ext-geodata-lokala-visning.lansstyrelsen.se/arcgis/rest/services/LSTD/LstD_GI_Hav_i_balans_EXT/MapServer
2025-07-25 01:22:15,272  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-lokala-visning.lansstyrelsen.se:443 "GET /arcgis/rest/services/LSTD/LstD_GI_Hav_i_balans_EXT/MapServer?f=json HTTP/1.1" 200 None
2025-07-25 01:22:15,274  INFO     [etl.handlers.rest_api:380]  No explicit layer_ids in config for source 'LstD Hav i balans'. Discovering all layers from service metadata.
2025-07-25 01:22:15,274  INFO     [etl.handlers.rest_api:427]  Source 'LstD Hav i balans': Will attempt to query 1 layer(s): ['0']
2025-07-25 01:22:15,274  INFO     [etl.handlers.rest_api:659]  üöö lstd_gi_marina_naturvarden_-_inventering
2025-07-25 01:22:15,274  DEBUG    [etl.handlers.rest_api:660]  Querying Layer ID: 0 (Sanitized Name: lstd_gi_marina_naturvarden_-_inventering, Original: LstD GI Marina naturv√§rden - Inventering) from https://ext-geodata-lokala-visning.lansstyrelsen.se/arcgis/rest/services/LSTD/LstD_GI_Hav_i_balans_EXT/MapServer/0/query
2025-07-25 01:22:15,274  DEBUG    [etl.handlers.rest_api:530]  maxRecordCount not found in layer metadata, using default: 5000
2025-07-25 01:22:15,274  DEBUG    [etl.handlers.rest_api:199]  Applying BBOX: 586206,6551160,647910,6610992 (SRID: 3006)
2025-07-25 01:22:15,276  DEBUG    [etl.handlers.rest_api:565]  Fetching page 1 for layer lstd_gi_marina_naturvarden_-_inventering (offset 0, limit 5000)
2025-07-25 01:22:16,032  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-lokala-visning.lansstyrelsen.se:443 "GET /arcgis/rest/services/LSTD/LstD_GI_Hav_i_balans_EXT/MapServer/0/query?where=1%3D1&outFields=%2A&returnGeometry=true&f=geojson&geometry=586206%2C6551160%2C647910%2C6610992&geometryType=esriGeometryEnvelope&inSR=3006&spatialRel=esriSpatialRelIntersects&resultOffset=0&resultRecordCount=5000 HTTP/1.1" 200 58
2025-07-25 01:22:16,034  DEBUG    [etl.handlers.rest_api:253]  ‚ÑπÔ∏è No features returned for layer lstd_gi_marina_naturvarden_-_inventering with current parameters.
2025-07-25 01:22:16,034  INFO     [etl.handlers.rest_api:693]  ‚ÑπÔ∏è lstd_gi_marina_naturvarden_-_inventering: no features
2025-07-25 01:22:16,034  INFO     [pipeline:623]  üöö LstD Levande sj√∂ar och vattendrag
2025-07-25 01:22:16,037  INFO     [etl.handlers.rest_api:68]  üöÄ Initializing RestApiDownloadHandler for source: LstD Levande sj√∂ar och vattendrag
2025-07-25 01:22:16,037  INFO     [etl.handlers.rest_api:321]  üåê Processing REST API source: 'LstD Levande sj√∂ar och vattendrag' from URL: https://ext-geodata-lokala-visning.lansstyrelsen.se/arcgis/rest/services/LSTD/LstD_GI_Levande_sjoar_och_vattendrag_EXT/MapServer
2025-07-25 01:22:16,370  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-lokala-visning.lansstyrelsen.se:443 "GET /arcgis/rest/services/LSTD/LstD_GI_Levande_sjoar_och_vattendrag_EXT/MapServer?f=json HTTP/1.1" 200 None
2025-07-25 01:22:16,371  INFO     [etl.handlers.rest_api:346]  Found explicit layer_ids in config: [2, 3, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17] for source 'LstD Levande sj√∂ar och vattendrag'. Processing only these.
2025-07-25 01:22:16,371  INFO     [etl.handlers.rest_api:427]  Source 'LstD Levande sj√∂ar och vattendrag': Will attempt to query 13 layer(s): ['2', '3', '7', '8', '9', '10', '11', '12', '13', '14', '15', '16', '17']
2025-07-25 01:22:16,371  INFO     [etl.handlers.rest_api:447]  üöÄ Starting concurrent download of 13 layers
2025-07-25 01:22:16,371  INFO     [etl.utils.concurrent:261]  Starting concurrent download of 13 layers
2025-07-25 01:22:16,372  INFO     [etl.utils.concurrent:121]  Starting concurrent execution of 13 tasks with 5 workers
2025-07-25 01:22:16,377  INFO     [etl.utils.concurrent:215]  Concurrent execution completed: 0/13 successful (0.0%), avg=0.00s, max=0.00s, total=0.00s
2025-07-25 01:22:16,377  INFO     [etl.handlers.rest_api:480]  üèÅ Concurrent downloads completed: 0 successful, 13 failed
2025-07-25 01:22:16,378  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_LstD GI S√∂tvatten - Tjockskalig m√•larmussla - name 'time' is not defined
2025-07-25 01:22:16,378  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_LstD GI S√∂tvatten - Kortskottsv√§xter - name 'time' is not defined
2025-07-25 01:22:16,378  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_LstD GI Ansvarsomr√•de s√∂tvatten L√§nsstyrelsen i S√∂dermanlands l√§n - name 'time' is not defined
2025-07-25 01:22:16,378  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_LstD GI V√§rdetrakter Hj√§lmar-, M√§lar- och kustmynnande vattendrag (inkl M√§laren och Hj√§lmaren) - name 'time' is not defined
2025-07-25 01:22:16,378  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_LstD GI V√§rdetrakter Kila√•ns avrinningsomr√•de - name 'time' is not defined
2025-07-25 01:22:16,378  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_LstD GI V√§rdetrakter klarvattensj√∂ar med kortskottsv√§xter - name 'time' is not defined
2025-07-25 01:22:16,378  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_LstD GI V√§rdetrakter malens rike - name 'time' is not defined
2025-07-25 01:22:16,378  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_LstD GI V√§rdetrakter n√§tverk f√∂r tjockskalig m√•larmussla - name 'time' is not defined
2025-07-25 01:22:16,378  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_LstD GI S√∂tvatten - Klarvattensj√∂ar och kortskottsv√§xter - name 'time' is not defined
2025-07-25 01:22:16,378  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_LstD GI S√∂tvatten - Sj√∂ar med r√∂dlistade arter - name 'time' is not defined
2025-07-25 01:22:16,379  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_LstD GI S√∂tvatten - Sj√∂ar med konnektivitetsarter - name 'time' is not defined
2025-07-25 01:22:16,379  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_LstD GI S√∂tvatten - Fosforbeting totalt i kg (omr√•de) - name 'time' is not defined
2025-07-25 01:22:16,379  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_LstD GI S√∂tvatten - Fosforbeting per arealenhet - name 'time' is not defined
2025-07-25 01:22:16,379  INFO     [pipeline:623]  üöö LstD Levande skogar
2025-07-25 01:22:16,380  INFO     [etl.handlers.rest_api:68]  üöÄ Initializing RestApiDownloadHandler for source: LstD Levande skogar
2025-07-25 01:22:16,380  INFO     [etl.handlers.rest_api:321]  üåê Processing REST API source: 'LstD Levande skogar' from URL: https://ext-geodata-lokala-visning.lansstyrelsen.se/arcgis/rest/services/LSTD/LstD_GI_Levande_skogar_EXT/MapServer
2025-07-25 01:22:16,414  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-lokala-visning.lansstyrelsen.se:443 "GET /arcgis/rest/services/LSTD/LstD_GI_Levande_skogar_EXT/MapServer?f=json HTTP/1.1" 200 None
2025-07-25 01:22:16,415  INFO     [etl.handlers.rest_api:346]  Found explicit layer_ids in config: [0] for source 'LstD Levande skogar'. Processing only these.
2025-07-25 01:22:16,415  INFO     [etl.handlers.rest_api:427]  Source 'LstD Levande skogar': Will attempt to query 1 layer(s): ['0']
2025-07-25 01:22:16,415  INFO     [etl.handlers.rest_api:659]  üöö lstd_gi_vardekarnor_adellovmiljoer_inkl_skyddsvarda_trad
2025-07-25 01:22:16,416  DEBUG    [etl.handlers.rest_api:660]  Querying Layer ID: 0 (Sanitized Name: lstd_gi_vardekarnor_adellovmiljoer_inkl_skyddsvarda_trad, Original: LstD GI V√§rdek√§rnor √§dell√∂vmilj√∂er inkl skyddsv√§rda tr√§d) from https://ext-geodata-lokala-visning.lansstyrelsen.se/arcgis/rest/services/LSTD/LstD_GI_Levande_skogar_EXT/MapServer/0/query
2025-07-25 01:22:16,416  DEBUG    [etl.handlers.rest_api:530]  maxRecordCount not found in layer metadata, using default: 5000
2025-07-25 01:22:16,416  DEBUG    [etl.handlers.rest_api:199]  Applying BBOX: 586206,6551160,647910,6610992 (SRID: 3006)
2025-07-25 01:22:16,418  DEBUG    [etl.handlers.rest_api:565]  Fetching page 1 for layer lstd_gi_vardekarnor_adellovmiljoer_inkl_skyddsvarda_trad (offset 0, limit 5000)
2025-07-25 01:22:18,656  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-lokala-visning.lansstyrelsen.se:443 "GET /arcgis/rest/services/LSTD/LstD_GI_Levande_skogar_EXT/MapServer/0/query?where=1%3D1&outFields=%2A&returnGeometry=true&f=geojson&geometry=586206%2C6551160%2C647910%2C6610992&geometryType=esriGeometryEnvelope&inSR=3006&spatialRel=esriSpatialRelIntersects&resultOffset=0&resultRecordCount=5000 HTTP/1.1" 200 None
2025-07-25 01:22:19,757  DEBUG    [etl.handlers.rest_api:270]  ‚ö†Ô∏è Exceeded transfer limit for layer lstd_gi_vardekarnor_adellovmiljoer_inkl_skyddsvarda_trad, fetching next page.
2025-07-25 01:22:19,757  DEBUG    [etl.handlers.rest_api:565]  Fetching page 2 for layer lstd_gi_vardekarnor_adellovmiljoer_inkl_skyddsvarda_trad (offset 2000, limit 5000)
2025-07-25 01:22:21,828  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-lokala-visning.lansstyrelsen.se:443 "GET /arcgis/rest/services/LSTD/LstD_GI_Levande_skogar_EXT/MapServer/0/query?where=1%3D1&outFields=%2A&returnGeometry=true&f=geojson&geometry=586206%2C6551160%2C647910%2C6610992&geometryType=esriGeometryEnvelope&inSR=3006&spatialRel=esriSpatialRelIntersects&resultOffset=2000&resultRecordCount=5000 HTTP/1.1" 200 None
2025-07-25 01:22:31,008  DEBUG    [etl.handlers.rest_api:279]  üèÅ All features likely retrieved for layer lstd_gi_vardekarnor_adellovmiljoer_inkl_skyddsvarda_trad (less than page limit or server maxRecordCount is 0).
2025-07-25 01:22:33,675  INFO     [etl.handlers.rest_api:298]  ‚úÖ lstd_gi_vardekarnor_adellovmiljoer_inkl_skyddsvarda_trad: 2783 features
2025-07-25 01:22:33,675  DEBUG    [etl.handlers.rest_api:299]  üíæ Successfully saved 2783 features for layer lstd_gi_vardekarnor_adellovmiljoer_inkl_skyddsvarda_trad to C:\Git\ETL-pipeline\data\staging\LSTD\lstd_levande_skogar\lstd_gi_vardekarnor_adellovmiljoer_inkl_skyddsvarda_trad.geojson
2025-07-25 01:22:33,692  INFO     [pipeline:623]  üöö LstD Klimat
2025-07-25 01:22:33,692  INFO     [etl.handlers.rest_api:68]  üöÄ Initializing RestApiDownloadHandler for source: LstD Klimat
2025-07-25 01:22:33,692  INFO     [etl.handlers.rest_api:321]  üåê Processing REST API source: 'LstD Klimat' from URL: https://ext-geodata-lokala-visning.lansstyrelsen.se/arcgis/rest/services/LSTD/LstD_Klimat_EXT/MapServer
2025-07-25 01:22:33,767  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-lokala-visning.lansstyrelsen.se:443 "GET /arcgis/rest/services/LSTD/LstD_Klimat_EXT/MapServer?f=json HTTP/1.1" 200 None
2025-07-25 01:22:33,769  INFO     [etl.handlers.rest_api:346]  Found explicit layer_ids in config: [2, 3, 4, 5, 6] for source 'LstD Klimat'. Processing only these.
2025-07-25 01:22:33,769  INFO     [etl.handlers.rest_api:427]  Source 'LstD Klimat': Will attempt to query 5 layer(s): ['2', '3', '4', '5', '6']
2025-07-25 01:22:33,770  INFO     [etl.handlers.rest_api:447]  üöÄ Starting concurrent download of 5 layers
2025-07-25 01:22:33,770  INFO     [etl.utils.concurrent:261]  Starting concurrent download of 5 layers
2025-07-25 01:22:33,771  INFO     [etl.utils.concurrent:121]  Starting concurrent execution of 5 tasks with 5 workers
2025-07-25 01:22:33,776  INFO     [etl.utils.concurrent:215]  Concurrent execution completed: 0/5 successful (0.0%), avg=0.00s, max=0.00s, total=0.00s
2025-07-25 01:22:33,776  INFO     [etl.handlers.rest_api:480]  üèÅ Concurrent downloads completed: 0 successful, 5 failed
2025-07-25 01:22:33,776  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_LstD Klimatanpassning - Rekommenderad l√§gsta grundl√§ggningsniv√• f√∂r ny bebyggelse - M√§laren - name 'time' is not defined
2025-07-25 01:22:33,777  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_LstD Klimatanpassning - Kust√∂versv√§mning - HHW10 2012 - name 'time' is not defined
2025-07-25 01:22:33,777  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_LstD Klimatanpassning - Kust√∂versv√§mning - HHW100 2012 - name 'time' is not defined
2025-07-25 01:22:33,777  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_LstD Klimatanpassning - Kust√∂versv√§mning - HHW10 2100 - name 'time' is not defined
2025-07-25 01:22:33,777  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_LstD Klimatanpassning - Kust√∂versv√§mning - HHW100 2100 - name 'time' is not defined
2025-07-25 01:22:33,777  INFO     [pipeline:623]  üöö LstD Kulturmilj√∂
2025-07-25 01:22:33,778  INFO     [etl.handlers.rest_api:68]  üöÄ Initializing RestApiDownloadHandler for source: LstD Kulturmilj√∂
2025-07-25 01:22:33,778  INFO     [etl.handlers.rest_api:321]  üåê Processing REST API source: 'LstD Kulturmilj√∂' from URL: https://ext-geodata-lokala-visning.lansstyrelsen.se/arcgis/rest/services/LSTD/LstD_Kulturmiljo_EXT/MapServer
2025-07-25 01:22:33,815  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-lokala-visning.lansstyrelsen.se:443 "GET /arcgis/rest/services/LSTD/LstD_Kulturmiljo_EXT/MapServer?f=json HTTP/1.1" 200 None
2025-07-25 01:22:33,816  INFO     [etl.handlers.rest_api:346]  Found explicit layer_ids in config: [1] for source 'LstD Kulturmilj√∂'. Processing only these.
2025-07-25 01:22:33,816  INFO     [etl.handlers.rest_api:427]  Source 'LstD Kulturmilj√∂': Will attempt to query 1 layer(s): ['1']
2025-07-25 01:22:33,817  INFO     [etl.handlers.rest_api:659]  üöö lstd_anmalningsplikt_enligt_kml_3_6
2025-07-25 01:22:33,817  DEBUG    [etl.handlers.rest_api:660]  Querying Layer ID: 1 (Sanitized Name: lstd_anmalningsplikt_enligt_kml_3_6, Original: LstD Anm√§lningsplikt enligt KML 3_6) from https://ext-geodata-lokala-visning.lansstyrelsen.se/arcgis/rest/services/LSTD/LstD_Kulturmiljo_EXT/MapServer/1/query
2025-07-25 01:22:33,817  DEBUG    [etl.handlers.rest_api:530]  maxRecordCount not found in layer metadata, using default: 5000
2025-07-25 01:22:33,817  DEBUG    [etl.handlers.rest_api:199]  Applying BBOX: 586206,6551160,647910,6610992 (SRID: 3006)
2025-07-25 01:22:33,818  DEBUG    [etl.handlers.rest_api:565]  Fetching page 1 for layer lstd_anmalningsplikt_enligt_kml_3_6 (offset 0, limit 5000)
2025-07-25 01:22:35,792  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-lokala-visning.lansstyrelsen.se:443 "GET /arcgis/rest/services/LSTD/LstD_Kulturmiljo_EXT/MapServer/1/query?where=1%3D1&outFields=%2A&returnGeometry=true&f=geojson&geometry=586206%2C6551160%2C647910%2C6610992&geometryType=esriGeometryEnvelope&inSR=3006&spatialRel=esriSpatialRelIntersects&resultOffset=0&resultRecordCount=5000 HTTP/1.1" 200 1348
2025-07-25 01:22:35,795  DEBUG    [etl.handlers.rest_api:279]  üèÅ All features likely retrieved for layer lstd_anmalningsplikt_enligt_kml_3_6 (less than page limit or server maxRecordCount is 0).
2025-07-25 01:22:35,811  INFO     [etl.handlers.rest_api:298]  ‚úÖ lstd_anmalningsplikt_enligt_kml_3_6: 68 features
2025-07-25 01:22:35,812  DEBUG    [etl.handlers.rest_api:299]  üíæ Successfully saved 68 features for layer lstd_anmalningsplikt_enligt_kml_3_6 to C:\Git\ETL-pipeline\data\staging\LSTD\lstd_kulturmiljo\lstd_anmalningsplikt_enligt_kml_3_6.geojson
2025-07-25 01:22:35,812  INFO     [pipeline:623]  üöö LstD Markavvattning
2025-07-25 01:22:35,813  INFO     [etl.handlers.rest_api:68]  üöÄ Initializing RestApiDownloadHandler for source: LstD Markavvattning
2025-07-25 01:22:35,813  INFO     [etl.handlers.rest_api:321]  üåê Processing REST API source: 'LstD Markavvattning' from URL: https://ext-geodata-lokala-visning.lansstyrelsen.se/arcgis/rest/services/LSTD/LstD_Markavvattning_EXT/MapServer
2025-07-25 01:22:35,851  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-lokala-visning.lansstyrelsen.se:443 "GET /arcgis/rest/services/LSTD/LstD_Markavvattning_EXT/MapServer?f=json HTTP/1.1" 200 None
2025-07-25 01:22:35,853  INFO     [etl.handlers.rest_api:346]  Found explicit layer_ids in config: [2, 3, 4, 5, 6] for source 'LstD Markavvattning'. Processing only these.
2025-07-25 01:22:35,853  INFO     [etl.handlers.rest_api:427]  Source 'LstD Markavvattning': Will attempt to query 5 layer(s): ['2', '3', '4', '5', '6']
2025-07-25 01:22:35,853  INFO     [etl.handlers.rest_api:447]  üöÄ Starting concurrent download of 5 layers
2025-07-25 01:22:35,853  INFO     [etl.utils.concurrent:261]  Starting concurrent download of 5 layers
2025-07-25 01:22:35,854  INFO     [etl.utils.concurrent:121]  Starting concurrent execution of 5 tasks with 5 workers
2025-07-25 01:22:35,860  INFO     [etl.utils.concurrent:215]  Concurrent execution completed: 0/5 successful (0.0%), avg=0.00s, max=0.00s, total=0.00s
2025-07-25 01:22:35,861  INFO     [etl.handlers.rest_api:480]  üèÅ Concurrent downloads completed: 0 successful, 5 failed
2025-07-25 01:22:35,861  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_LstD Markavvattningsf√∂retag - B√•tnadsomr√•de - Yta - name 'time' is not defined
2025-07-25 01:22:35,861  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_LstD Lantbruksn√§mnden Markavvattning - Dikningsregister - name 'time' is not defined
2025-07-25 01:22:35,861  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_LstD Lantbruksn√§mnden Markavvattning - T√§ckdikningsregister - name 'time' is not defined
2025-07-25 01:22:35,861  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_LstD Lantbruksn√§mnden Markavvattning - Blandat arkivmaterial - name 'time' is not defined
2025-07-25 01:22:35,861  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_LstD LM Markavvattning - Vattenf√∂rr√§ttningar f√∂re 1935 - name 'time' is not defined
2025-07-25 01:22:35,861  INFO     [pipeline:623]  üöö LstD Markstabilitet
2025-07-25 01:22:35,862  INFO     [etl.handlers.rest_api:68]  üöÄ Initializing RestApiDownloadHandler for source: LstD Markstabilitet
2025-07-25 01:22:35,863  INFO     [etl.handlers.rest_api:321]  üåê Processing REST API source: 'LstD Markstabilitet' from URL: https://ext-geodata-lokala-visning.lansstyrelsen.se/arcgis/rest/services/LSTD/LstD_Markstabilitet_EXT/MapServer
2025-07-25 01:22:36,812  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-lokala-visning.lansstyrelsen.se:443 "GET /arcgis/rest/services/LSTD/LstD_Markstabilitet_EXT/MapServer?f=json HTTP/1.1" 200 None
2025-07-25 01:22:36,813  INFO     [etl.handlers.rest_api:380]  No explicit layer_ids in config for source 'LstD Markstabilitet'. Discovering all layers from service metadata.
2025-07-25 01:22:36,813  INFO     [etl.handlers.rest_api:427]  Source 'LstD Markstabilitet': Will attempt to query 1 layer(s): ['0']
2025-07-25 01:22:36,813  INFO     [etl.handlers.rest_api:659]  üöö lstd_msb_oversiktlig_stabilitetskartering_-_90-talet_-_finkorniga_jordarter
2025-07-25 01:22:36,814  DEBUG    [etl.handlers.rest_api:660]  Querying Layer ID: 0 (Sanitized Name: lstd_msb_oversiktlig_stabilitetskartering_-_90-talet_-_finkorniga_jordarter, Original: LstD MSB √ñversiktlig stabilitetskartering - 90-talet - Finkorniga jordarter) from https://ext-geodata-lokala-visning.lansstyrelsen.se/arcgis/rest/services/LSTD/LstD_Markstabilitet_EXT/MapServer/0/query
2025-07-25 01:22:36,814  DEBUG    [etl.handlers.rest_api:530]  maxRecordCount not found in layer metadata, using default: 5000
2025-07-25 01:22:36,814  DEBUG    [etl.handlers.rest_api:199]  Applying BBOX: 586206,6551160,647910,6610992 (SRID: 3006)
2025-07-25 01:22:36,816  DEBUG    [etl.handlers.rest_api:565]  Fetching page 1 for layer lstd_msb_oversiktlig_stabilitetskartering_-_90-talet_-_finkorniga_jordarter (offset 0, limit 5000)
2025-07-25 01:22:37,668  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-lokala-visning.lansstyrelsen.se:443 "GET /arcgis/rest/services/LSTD/LstD_Markstabilitet_EXT/MapServer/0/query?where=1%3D1&outFields=%2A&returnGeometry=true&f=geojson&geometry=586206%2C6551160%2C647910%2C6610992&geometryType=esriGeometryEnvelope&inSR=3006&spatialRel=esriSpatialRelIntersects&resultOffset=0&resultRecordCount=5000 HTTP/1.1" 200 None
2025-07-25 01:22:38,223  DEBUG    [etl.handlers.rest_api:279]  üèÅ All features likely retrieved for layer lstd_msb_oversiktlig_stabilitetskartering_-_90-talet_-_finkorniga_jordarter (less than page limit or server maxRecordCount is 0).
2025-07-25 01:22:38,366  INFO     [etl.handlers.rest_api:298]  ‚úÖ lstd_msb_oversiktlig_stabilitetskartering_-_90-talet_-_finkorniga_jordarter: 52 features
2025-07-25 01:22:38,366  DEBUG    [etl.handlers.rest_api:299]  üíæ Successfully saved 52 features for layer lstd_msb_oversiktlig_stabilitetskartering_-_90-talet_-_finkorniga_jordarter to C:\Git\ETL-pipeline\data\staging\LSTD\lstd_markstabilitet\lstd_msb_oversiktlig_stabilitetskartering_-_90-talet_-_finkorniga_jordarter.geojson
2025-07-25 01:22:38,367  INFO     [pipeline:623]  üöö LstD Naturkartl√§ggning
2025-07-25 01:22:38,368  INFO     [etl.handlers.rest_api:68]  üöÄ Initializing RestApiDownloadHandler for source: LstD Naturkartl√§ggning
2025-07-25 01:22:38,368  INFO     [etl.handlers.rest_api:321]  üåê Processing REST API source: 'LstD Naturkartl√§ggning' from URL: https://ext-geodata-lokala-visning.lansstyrelsen.se/arcgis/rest/services/LSTD/LstD_Naturkartlaggning_EXT/MapServer
2025-07-25 01:22:39,359  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-lokala-visning.lansstyrelsen.se:443 "GET /arcgis/rest/services/LSTD/LstD_Naturkartlaggning_EXT/MapServer?f=json HTTP/1.1" 200 None
2025-07-25 01:22:39,360  INFO     [etl.handlers.rest_api:380]  No explicit layer_ids in config for source 'LstD Naturkartl√§ggning'. Discovering all layers from service metadata.
2025-07-25 01:22:39,360  INFO     [etl.handlers.rest_api:427]  Source 'LstD Naturkartl√§ggning': Will attempt to query 1 layer(s): ['0']
2025-07-25 01:22:39,361  INFO     [etl.handlers.rest_api:659]  üöö lstd_sormlands_natur_-_naturvardsprogram_1991
2025-07-25 01:22:39,361  DEBUG    [etl.handlers.rest_api:660]  Querying Layer ID: 0 (Sanitized Name: lstd_sormlands_natur_-_naturvardsprogram_1991, Original: LstD S√∂rmlands natur - Naturv√•rdsprogram 1991) from https://ext-geodata-lokala-visning.lansstyrelsen.se/arcgis/rest/services/LSTD/LstD_Naturkartlaggning_EXT/MapServer/0/query
2025-07-25 01:22:39,361  DEBUG    [etl.handlers.rest_api:530]  maxRecordCount not found in layer metadata, using default: 5000
2025-07-25 01:22:39,361  DEBUG    [etl.handlers.rest_api:199]  Applying BBOX: 586206,6551160,647910,6610992 (SRID: 3006)
2025-07-25 01:22:39,364  DEBUG    [etl.handlers.rest_api:565]  Fetching page 1 for layer lstd_sormlands_natur_-_naturvardsprogram_1991 (offset 0, limit 5000)
2025-07-25 01:22:40,134  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-lokala-visning.lansstyrelsen.se:443 "GET /arcgis/rest/services/LSTD/LstD_Naturkartlaggning_EXT/MapServer/0/query?where=1%3D1&outFields=%2A&returnGeometry=true&f=geojson&geometry=586206%2C6551160%2C647910%2C6610992&geometryType=esriGeometryEnvelope&inSR=3006&spatialRel=esriSpatialRelIntersects&resultOffset=0&resultRecordCount=5000 HTTP/1.1" 200 None
2025-07-25 01:22:41,104  DEBUG    [etl.handlers.rest_api:279]  üèÅ All features likely retrieved for layer lstd_sormlands_natur_-_naturvardsprogram_1991 (less than page limit or server maxRecordCount is 0).
2025-07-25 01:22:41,279  INFO     [etl.handlers.rest_api:298]  ‚úÖ lstd_sormlands_natur_-_naturvardsprogram_1991: 245 features
2025-07-25 01:22:41,280  DEBUG    [etl.handlers.rest_api:299]  üíæ Successfully saved 245 features for layer lstd_sormlands_natur_-_naturvardsprogram_1991 to C:\Git\ETL-pipeline\data\staging\LSTD\lstd_naturkartlaggning\lstd_sormlands_natur_-_naturvardsprogram_1991.geojson
2025-07-25 01:22:41,281  INFO     [pipeline:623]  üöö LstD Skog och tr√§d
2025-07-25 01:22:41,282  INFO     [etl.handlers.rest_api:68]  üöÄ Initializing RestApiDownloadHandler for source: LstD Skog och tr√§d
2025-07-25 01:22:41,282  INFO     [etl.handlers.rest_api:321]  üåê Processing REST API source: 'LstD Skog och tr√§d' from URL: https://ext-geodata-lokala-visning.lansstyrelsen.se/arcgis/rest/services/LSTD/LstD_Skog_och_trad_EXT/MapServer
2025-07-25 01:22:42,440  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-lokala-visning.lansstyrelsen.se:443 "GET /arcgis/rest/services/LSTD/LstD_Skog_och_trad_EXT/MapServer?f=json HTTP/1.1" 200 None
2025-07-25 01:22:42,441  INFO     [etl.handlers.rest_api:380]  No explicit layer_ids in config for source 'LstD Skog och tr√§d'. Discovering all layers from service metadata.
2025-07-25 01:22:42,442  INFO     [etl.handlers.rest_api:427]  Source 'LstD Skog och tr√§d': Will attempt to query 3 layer(s): ['0', '1', '2']
2025-07-25 01:22:42,443  INFO     [etl.handlers.rest_api:447]  üöÄ Starting concurrent download of 3 layers
2025-07-25 01:22:42,443  INFO     [etl.utils.concurrent:261]  Starting concurrent download of 3 layers
2025-07-25 01:22:42,443  INFO     [etl.utils.concurrent:121]  Starting concurrent execution of 3 tasks with 5 workers
2025-07-25 01:22:42,448  INFO     [etl.utils.concurrent:215]  Concurrent execution completed: 0/3 successful (0.0%), avg=0.00s, max=0.00s, total=0.00s
2025-07-25 01:22:42,449  INFO     [etl.handlers.rest_api:480]  üèÅ Concurrent downloads completed: 0 successful, 3 failed
2025-07-25 01:22:42,449  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_LstD All√©inventering - name 'time' is not defined
2025-07-25 01:22:42,449  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_LstD K√§llskogar (extern) - name 'time' is not defined
2025-07-25 01:22:42,449  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_LstD Skogliga v√§rdetrakter - name 'time' is not defined
2025-07-25 01:22:42,450  INFO     [pipeline:623]  üöö LstD GI V√§rdetrakter v√•tmark
2025-07-25 01:22:42,451  INFO     [etl.handlers.rest_api:68]  üöÄ Initializing RestApiDownloadHandler for source: LstD GI V√§rdetrakter v√•tmark
2025-07-25 01:22:42,451  INFO     [etl.handlers.rest_api:321]  üåê Processing REST API source: 'LstD GI V√§rdetrakter v√•tmark' from URL: https://ext-geodata-lokala-visning.lansstyrelsen.se/arcgis/rest/services/LSTD/LstD_GI_Myllrande_vatmarker_EXT/MapServer
2025-07-25 01:22:42,491  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-lokala-visning.lansstyrelsen.se:443 "GET /arcgis/rest/services/LSTD/LstD_GI_Myllrande_vatmarker_EXT/MapServer?f=json HTTP/1.1" 200 None
2025-07-25 01:22:42,492  INFO     [etl.handlers.rest_api:380]  No explicit layer_ids in config for source 'LstD GI V√§rdetrakter v√•tmark'. Discovering all layers from service metadata.
2025-07-25 01:22:42,493  INFO     [etl.handlers.rest_api:427]  Source 'LstD GI V√§rdetrakter v√•tmark': Will attempt to query 1 layer(s): ['0']
2025-07-25 01:22:42,493  INFO     [etl.handlers.rest_api:659]  üöö lstd_gi_vardetrakter_vatmark
2025-07-25 01:22:42,494  DEBUG    [etl.handlers.rest_api:660]  Querying Layer ID: 0 (Sanitized Name: lstd_gi_vardetrakter_vatmark, Original: LstD GI V√§rdetrakter v√•tmark) from https://ext-geodata-lokala-visning.lansstyrelsen.se/arcgis/rest/services/LSTD/LstD_GI_Myllrande_vatmarker_EXT/MapServer/0/query
2025-07-25 01:22:42,494  DEBUG    [etl.handlers.rest_api:530]  maxRecordCount not found in layer metadata, using default: 5000
2025-07-25 01:22:42,494  DEBUG    [etl.handlers.rest_api:199]  Applying BBOX: 586206,6551160,647910,6610992 (SRID: 3006)
2025-07-25 01:22:42,495  DEBUG    [etl.handlers.rest_api:565]  Fetching page 1 for layer lstd_gi_vardetrakter_vatmark (offset 0, limit 5000)
2025-07-25 01:22:44,054  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-lokala-visning.lansstyrelsen.se:443 "GET /arcgis/rest/services/LSTD/LstD_GI_Myllrande_vatmarker_EXT/MapServer/0/query?where=1%3D1&outFields=%2A&returnGeometry=true&f=geojson&geometry=586206%2C6551160%2C647910%2C6610992&geometryType=esriGeometryEnvelope&inSR=3006&spatialRel=esriSpatialRelIntersects&resultOffset=0&resultRecordCount=5000 HTTP/1.1" 200 None
2025-07-25 01:22:44,104  DEBUG    [etl.handlers.rest_api:279]  üèÅ All features likely retrieved for layer lstd_gi_vardetrakter_vatmark (less than page limit or server maxRecordCount is 0).
2025-07-25 01:22:44,114  INFO     [etl.handlers.rest_api:298]  ‚úÖ lstd_gi_vardetrakter_vatmark: 7 features
2025-07-25 01:22:44,114  DEBUG    [etl.handlers.rest_api:299]  üíæ Successfully saved 7 features for layer lstd_gi_vardetrakter_vatmark to C:\Git\ETL-pipeline\data\staging\LSTD\lstd_gi_vardetrakter_vatmark\lstd_gi_vardetrakter_vatmark.geojson
2025-07-25 01:22:44,114  INFO     [pipeline:623]  üöö LstD Strandskydd
2025-07-25 01:22:44,115  INFO     [etl.handlers.rest_api:68]  üöÄ Initializing RestApiDownloadHandler for source: LstD Strandskydd
2025-07-25 01:22:44,115  INFO     [etl.handlers.rest_api:321]  üåê Processing REST API source: 'LstD Strandskydd' from URL: https://ext-geodata-lokala-visning.lansstyrelsen.se/arcgis/rest/services/LSTD/LstD_Strandskydd_EXT/MapServer
2025-07-25 01:22:44,162  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-lokala-visning.lansstyrelsen.se:443 "GET /arcgis/rest/services/LSTD/LstD_Strandskydd_EXT/MapServer?f=json HTTP/1.1" 200 None
2025-07-25 01:22:44,163  INFO     [etl.handlers.rest_api:380]  No explicit layer_ids in config for source 'LstD Strandskydd'. Discovering all layers from service metadata.
2025-07-25 01:22:44,163  INFO     [etl.handlers.rest_api:427]  Source 'LstD Strandskydd': Will attempt to query 4 layer(s): ['0', '1', '2', '3']
2025-07-25 01:22:44,163  INFO     [etl.handlers.rest_api:447]  üöÄ Starting concurrent download of 4 layers
2025-07-25 01:22:44,163  INFO     [etl.utils.concurrent:261]  Starting concurrent download of 4 layers
2025-07-25 01:22:44,163  INFO     [etl.utils.concurrent:121]  Starting concurrent execution of 4 tasks with 5 workers
2025-07-25 01:22:44,166  INFO     [etl.utils.concurrent:215]  Concurrent execution completed: 0/4 successful (0.0%), avg=0.00s, max=0.00s, total=0.00s
2025-07-25 01:22:44,166  INFO     [etl.handlers.rest_api:480]  üèÅ Concurrent downloads completed: 0 successful, 4 failed
2025-07-25 01:22:44,166  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_LstD LM Strandskydd - Generellt - name 'time' is not defined
2025-07-25 01:22:44,166  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_LstD Strandskydd - Upph√§vt i enskilda fall - name 'time' is not defined
2025-07-25 01:22:44,166  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_LstD Strandskydd - Utvidgat - name 'time' is not defined
2025-07-25 01:22:44,166  ERROR    [etl.handlers.rest_api:490]  ‚ùå Layer download failed: layer_LstD Strandskydd - Utvidgat - Kartblad M√§laren Str√§ngn√§s - name 'time' is not defined
2025-07-25 01:22:44,166  INFO     [pipeline:623]  üöö Skyddsrum
2025-07-25 01:22:44,167  INFO     [etl.handlers.file:162]  üîó Single resource download mode for 'Skyddsrum' from URL: https://inspire.msb.se/nedladdning/filer/shape/Skyddsrum.zip
2025-07-25 01:22:44,297  INFO     [etl.utils.http:110]      Derived filename by unquoting URL basename ('https://inspire.msb.se/nedladdning/filer/shape/Skyddsrum.zip'): Skyddsrum.zip
2025-07-25 01:22:44,299  DEBUG    [etl.handlers.file:247]  Attempting to download: https://inspire.msb.se/nedladdning/filer/shape/Skyddsrum.zip 
    -> to local file: skyddsrum.zip 
    -> staging dir: data\staging\MSB\skyddsrum
2025-07-25 01:22:44,300  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): inspire.msb.se:443
2025-07-25 01:22:44,408  DEBUG    [urllib3.connectionpool:544]  https://inspire.msb.se:443 "HEAD /nedladdning/filer/shape/Skyddsrum.zip HTTP/1.1" 200 0
2025-07-25 01:22:44,408  INFO     [etl.utils.io:44]  ‚¨á skyddsrum.zip (3.1 MB)
2025-07-25 01:22:44,409  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): inspire.msb.se:443
2025-07-25 01:22:44,506  DEBUG    [urllib3.connectionpool:544]  https://inspire.msb.se:443 "GET /nedladdning/filer/shape/Skyddsrum.zip HTTP/1.1" 200 3243792
2025-07-25 01:22:44,676  INFO     [etl.utils.io:82]  ‚úÖ skyddsrum.zip
2025-07-25 01:22:44,677  INFO     [etl.handlers.file:278]  Determined staged_data_type: 'shapefile_collection' for downloaded file 'skyddsrum.zip'
2025-07-25 01:22:44,677  INFO     [etl.utils.io:88]  üì¶ Extracting skyddsrum.zip ‚Üí C:\Git\ETL-pipeline\data\staging\MSB\skyddsrum
2025-07-25 01:22:44,927  INFO     [etl.handlers.file:351]  ‚ûï Extracted and staged archive skyddsrum.zip to data\staging\MSB\skyddsrum
2025-07-25 01:22:44,928  INFO     [pipeline:623]  üöö Riksintresse Kulturmilj√∂v√•rd MB3kap6
2025-07-25 01:22:44,928  INFO     [etl.handlers.atom_feed:41]  üåê Reading Atom feed for source 'Riksintresse Kulturmilj√∂v√•rd MB3kap6' from URL: https://ext-dokument.lansstyrelsen.se/gemensamt/geodata/ATOM/ATOM_raa.RAA_RI_kulturmiljovard_MB3kap6.xml
2025-07-25 01:22:44,930  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): ext-dokument.lansstyrelsen.se:443
2025-07-25 01:22:45,060  DEBUG    [urllib3.connectionpool:544]  https://ext-dokument.lansstyrelsen.se:443 "HEAD /gemensamt/geodata/ATOM/ATOM_raa.RAA_RI_kulturmiljovard_MB3kap6.xml HTTP/1.1" 200 0
2025-07-25 01:22:45,061  INFO     [etl.utils.io:44]  ‚¨á riksintresse_kulturmiljovard_mb3kap6_feed.xml (1.1 KB)
2025-07-25 01:22:45,063  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): ext-dokument.lansstyrelsen.se:443
2025-07-25 01:22:45,212  DEBUG    [urllib3.connectionpool:544]  https://ext-dokument.lansstyrelsen.se:443 "GET /gemensamt/geodata/ATOM/ATOM_raa.RAA_RI_kulturmiljovard_MB3kap6.xml HTTP/1.1" 200 1082
2025-07-25 01:22:45,215  INFO     [etl.utils.io:82]  ‚úÖ riksintresse_kulturmiljovard_mb3kap6_feed.xml
2025-07-25 01:22:45,217  INFO     [etl.handlers.atom_feed:77]  Target staging directory for all content from Atom source 'Riksintresse Kulturmilj√∂v√•rd MB3kap6': data\staging\RAA\riksintresse_kulturmiljovard_mb3kap6
2025-07-25 01:22:45,217  INFO     [etl.handlers.atom_feed:105]  Found linked resource in Atom feed for 'Riksintresse Kulturmilj√∂v√•rd MB3kap6': https://ext-dokument.lansstyrelsen.se/gemensamt/geodata/ShapeExport/raa.RAA_RI_kulturmiljovard_MB3kap6.zip
2025-07-25 01:22:45,346  INFO     [etl.utils.http:110]      Derived filename by unquoting URL basename ('https://ext-dokument.lansstyrelsen.se/gemensamt/geodata/ShapeExport/raa.RAA_RI_kulturmiljovard_MB3kap6.zip'): raa.RAA_RI_kulturmiljovard_MB3kap6.zip
2025-07-25 01:22:45,346  INFO     [etl.handlers.atom_feed:157]  Attempting to download linked resource: https://ext-dokument.lansstyrelsen.se/gemensamt/geodata/ShapeExport/raa.RAA_RI_kulturmiljovard_MB3kap6.zip 
        -> to local file: raa_raa_ri_kulturmiljovard_mb3kap6.zip
2025-07-25 01:22:45,348  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): ext-dokument.lansstyrelsen.se:443
2025-07-25 01:22:45,451  DEBUG    [urllib3.connectionpool:544]  https://ext-dokument.lansstyrelsen.se:443 "HEAD /gemensamt/geodata/ShapeExport/raa.RAA_RI_kulturmiljovard_MB3kap6.zip HTTP/1.1" 200 0
2025-07-25 01:22:45,452  INFO     [etl.utils.io:44]  ‚¨á raa_raa_ri_kulturmiljovard_mb3kap6.zip (5.4 MB)
2025-07-25 01:22:45,453  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): ext-dokument.lansstyrelsen.se:443
2025-07-25 01:22:45,552  DEBUG    [urllib3.connectionpool:544]  https://ext-dokument.lansstyrelsen.se:443 "GET /gemensamt/geodata/ShapeExport/raa.RAA_RI_kulturmiljovard_MB3kap6.zip HTTP/1.1" 200 5687784
2025-07-25 01:22:46,167  INFO     [etl.utils.io:82]  ‚úÖ raa_raa_ri_kulturmiljovard_mb3kap6.zip
2025-07-25 01:22:46,168  INFO     [etl.handlers.atom_feed:168]  Downloaded file 'raa_raa_ri_kulturmiljovard_mb3kap6.zip' is a ZIP archive. Extracting...
2025-07-25 01:22:46,168  INFO     [etl.utils.io:88]  üì¶ Extracting raa_raa_ri_kulturmiljovard_mb3kap6.zip ‚Üí C:\Git\ETL-pipeline\data\staging\RAA\riksintresse_kulturmiljovard_mb3kap6
2025-07-25 01:22:46,248  INFO     [etl.handlers.atom_feed:173]  ‚ûï Extracted and staged archive raa_raa_ri_kulturmiljovard_mb3kap6.zip into data\staging\RAA\riksintresse_kulturmiljovard_mb3kap6
2025-07-25 01:22:46,248  INFO     [etl.handlers.atom_feed:180]  Source 'Riksintresse Kulturmilj√∂v√•rd MB3kap6' expects a GPKG. Searching in extracted contents of raa_raa_ri_kulturmiljovard_mb3kap6.zip...
2025-07-25 01:22:46,250  INFO     [etl.handlers.atom_feed:197]  Renaming/moving extracted GPKG 'raa.RAA_RI_kulturmiljovard_MB3kap6.gpkg' to 'riksintresse_kulturmiljovard_mb3kap6.gpkg'
2025-07-25 01:22:46,251  INFO     [etl.handlers.atom_feed:207]  ‚úÖ Successfully staged GPKG 'riksintresse_kulturmiljovard_mb3kap6.gpkg' for source 'Riksintresse Kulturmilj√∂v√•rd MB3kap6'.
2025-07-25 01:22:46,251  INFO     [pipeline:623]  üöö RAA Byggnader Sverige
2025-07-25 01:22:46,252  INFO     [etl.handlers.file:162]  üîó Single resource download mode for 'RAA Byggnader Sverige' from URL: https://pub.raa.se/nedladdning/datauttag/bebyggelse/byggnader_kulthist_inv/byggnader_sverige.gpkg
2025-07-25 01:22:46,370  INFO     [etl.utils.http:110]      Derived filename by unquoting URL basename ('https://pub.raa.se/nedladdning/datauttag/bebyggelse/byggnader_kulthist_inv/byggnader_sverige.gpkg'): byggnader_sverige.gpkg
2025-07-25 01:22:46,372  DEBUG    [etl.handlers.file:247]  Attempting to download: https://pub.raa.se/nedladdning/datauttag/bebyggelse/byggnader_kulthist_inv/byggnader_sverige.gpkg 
    -> to local file: raa_byggnader_sverige.gpkg 
    -> staging dir: data\staging\RAA\raa_byggnader_sverige
2025-07-25 01:22:46,373  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): pub.raa.se:443
2025-07-25 01:22:46,453  DEBUG    [urllib3.connectionpool:544]  https://pub.raa.se:443 "HEAD /nedladdning/datauttag/bebyggelse/byggnader_kulthist_inv/byggnader_sverige.gpkg HTTP/1.1" 200 0
2025-07-25 01:22:46,453  INFO     [etl.utils.io:44]  ‚¨á raa_byggnader_sverige.gpkg (75.4 MB)
2025-07-25 01:22:46,454  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): pub.raa.se:443
2025-07-25 01:22:46,522  DEBUG    [urllib3.connectionpool:544]  https://pub.raa.se:443 "GET /nedladdning/datauttag/bebyggelse/byggnader_kulthist_inv/byggnader_sverige.gpkg HTTP/1.1" 200 79097856
2025-07-25 01:22:51,533  DEBUG    [etl.utils.io:66]  üìä raa_byggnader_sverige.gpkg: 24.9% (18.8 MB / 75.4 MB)
2025-07-25 01:22:56,535  DEBUG    [etl.utils.io:66]  üìä raa_byggnader_sverige.gpkg: 49.9% (37.7 MB / 75.4 MB)
2025-07-25 01:23:01,537  DEBUG    [etl.utils.io:66]  üìä raa_byggnader_sverige.gpkg: 74.0% (55.9 MB / 75.4 MB)
2025-07-25 01:23:06,541  DEBUG    [etl.utils.io:66]  üìä raa_byggnader_sverige.gpkg: 99.4% (74.9 MB / 75.4 MB)
2025-07-25 01:23:06,651  INFO     [etl.utils.io:82]  ‚úÖ raa_byggnader_sverige.gpkg
2025-07-25 01:23:06,652  INFO     [etl.handlers.file:278]  Determined staged_data_type: 'gpkg' for downloaded file 'raa_byggnader_sverige.gpkg'
2025-07-25 01:23:06,723  INFO     [etl.handlers.file:292]  ‚ûï Staged GPKG raa_byggnader_sverige.gpkg to data\staging\RAA\raa_byggnader_sverige\raa_byggnader_sverige.gpkg
2025-07-25 01:23:06,724  INFO     [pipeline:623]  üöö Enskilda och statliga byggnadsminnen, skyddsomr√•den
2025-07-25 01:23:06,725  INFO     [etl.handlers.file:162]  üîó Single resource download mode for 'Enskilda och statliga byggnadsminnen, skyddsomr√•den' from URL: https://pub.raa.se/nedladdning/datauttag/bebyggelse/byggnadsminne_skyddsomr/skyddsomrade_byggnadsminne_sverige.gpkg
2025-07-25 01:23:06,868  INFO     [etl.utils.http:110]      Derived filename by unquoting URL basename ('https://pub.raa.se/nedladdning/datauttag/bebyggelse/byggnadsminne_skyddsomr/skyddsomrade_byggnadsminne_sverige.gpkg'): skyddsomrade_byggnadsminne_sverige.gpkg
2025-07-25 01:23:06,872  DEBUG    [etl.handlers.file:247]  Attempting to download: https://pub.raa.se/nedladdning/datauttag/bebyggelse/byggnadsminne_skyddsomr/skyddsomrade_byggnadsminne_sverige.gpkg 
    -> to local file: enskilda_och_statliga_byggnadsminnen_skyddsomraden.gpkg 
    -> staging dir: data\staging\RAA\enskilda_och_statliga_byggnadsminnen_skyddsomraden
2025-07-25 01:23:06,876  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): pub.raa.se:443
2025-07-25 01:23:06,953  DEBUG    [urllib3.connectionpool:544]  https://pub.raa.se:443 "HEAD /nedladdning/datauttag/bebyggelse/byggnadsminne_skyddsomr/skyddsomrade_byggnadsminne_sverige.gpkg HTTP/1.1" 200 0
2025-07-25 01:23:06,954  INFO     [etl.utils.io:44]  ‚¨á enskilda_och_statliga_byggnadsminnen_skyddsomraden.gpkg (7.5 MB)
2025-07-25 01:23:06,956  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): pub.raa.se:443
2025-07-25 01:23:07,048  DEBUG    [urllib3.connectionpool:544]  https://pub.raa.se:443 "GET /nedladdning/datauttag/bebyggelse/byggnadsminne_skyddsomr/skyddsomrade_byggnadsminne_sverige.gpkg HTTP/1.1" 200 7843840
2025-07-25 01:23:08,917  INFO     [etl.utils.io:82]  ‚úÖ enskilda_och_statliga_byggnadsminnen_skyddsomraden.gpkg
2025-07-25 01:23:08,918  INFO     [etl.handlers.file:278]  Determined staged_data_type: 'gpkg' for downloaded file 'enskilda_och_statliga_byggnadsminnen_skyddsomraden.gpkg'
2025-07-25 01:23:08,937  INFO     [etl.handlers.file:292]  ‚ûï Staged GPKG enskilda_och_statliga_byggnadsminnen_skyddsomraden.gpkg to data\staging\RAA\enskilda_och_statliga_byggnadsminnen_skyddsomraden\enskilda_och_statliga_byggnadsminnen_skyddsomraden.gpkg
2025-07-25 01:23:08,938  INFO     [pipeline:623]  üöö Kulturhistoriska l√§mningar, S√∂dermanland
2025-07-25 01:23:08,939  INFO     [etl.handlers.file:162]  üîó Single resource download mode for 'Kulturhistoriska l√§mningar, S√∂dermanland' from URL: https://pub.raa.se/nedladdning/datauttag/lamningar/lan/l%C3%A4mningar_l%C3%A4n_s%C3%B6dermanland.gpkg
2025-07-25 01:23:09,062  INFO     [etl.utils.http:110]      Derived filename by unquoting URL basename ('https://pub.raa.se/nedladdning/datauttag/lamningar/lan/l%C3%A4mningar_l%C3%A4n_s%C3%B6dermanland.gpkg'): l√§mningar_l√§n_s√∂dermanland.gpkg
2025-07-25 01:23:09,064  DEBUG    [etl.handlers.file:247]  Attempting to download: https://pub.raa.se/nedladdning/datauttag/lamningar/lan/l%C3%A4mningar_l%C3%A4n_s%C3%B6dermanland.gpkg 
    -> to local file: kulturhistoriska_lamningar_sodermanland.gpkg 
    -> staging dir: data\staging\RAA\kulturhistoriska_lamningar_sodermanland
2025-07-25 01:23:09,066  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): pub.raa.se:443
2025-07-25 01:23:09,154  DEBUG    [urllib3.connectionpool:544]  https://pub.raa.se:443 "HEAD /nedladdning/datauttag/lamningar/lan/l%C3%A4mningar_l%C3%A4n_s%C3%B6dermanland.gpkg HTTP/1.1" 200 0
2025-07-25 01:23:09,157  INFO     [etl.utils.io:44]  ‚¨á kulturhistoriska_lamningar_sodermanland.gpkg (41.1 MB)
2025-07-25 01:23:09,160  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): pub.raa.se:443
2025-07-25 01:23:09,257  DEBUG    [urllib3.connectionpool:544]  https://pub.raa.se:443 "GET /nedladdning/datauttag/lamningar/lan/l%C3%A4mningar_l%C3%A4n_s%C3%B6dermanland.gpkg HTTP/1.1" 200 43102208
2025-07-25 01:23:14,260  DEBUG    [etl.utils.io:66]  üìä kulturhistoriska_lamningar_sodermanland.gpkg: 47.9% (19.7 MB / 41.1 MB)
2025-07-25 01:23:19,262  DEBUG    [etl.utils.io:66]  üìä kulturhistoriska_lamningar_sodermanland.gpkg: 95.3% (39.2 MB / 41.1 MB)
2025-07-25 01:23:19,738  INFO     [etl.utils.io:82]  ‚úÖ kulturhistoriska_lamningar_sodermanland.gpkg
2025-07-25 01:23:19,738  INFO     [etl.handlers.file:278]  Determined staged_data_type: 'gpkg' for downloaded file 'kulturhistoriska_lamningar_sodermanland.gpkg'
2025-07-25 01:23:19,764  INFO     [etl.handlers.file:292]  ‚ûï Staged GPKG kulturhistoriska_lamningar_sodermanland.gpkg to data\staging\RAA\kulturhistoriska_lamningar_sodermanland\kulturhistoriska_lamningar_sodermanland.gpkg
2025-07-25 01:23:19,765  INFO     [pipeline:623]  üöö RAA V√§rldsarv i Sverige
2025-07-25 01:23:19,765  INFO     [etl.handlers.file:162]  üîó Single resource download mode for 'RAA V√§rldsarv i Sverige' from URL: https://pub.raa.se/nedladdning/datauttag/varldsarv/varldsarv_sverige.gpkg
2025-07-25 01:23:19,896  INFO     [etl.utils.http:110]      Derived filename by unquoting URL basename ('https://pub.raa.se/nedladdning/datauttag/varldsarv/varldsarv_sverige.gpkg'): varldsarv_sverige.gpkg
2025-07-25 01:23:19,899  DEBUG    [etl.handlers.file:247]  Attempting to download: https://pub.raa.se/nedladdning/datauttag/varldsarv/varldsarv_sverige.gpkg 
    -> to local file: raa_varldsarv_i_sverige.gpkg 
    -> staging dir: data\staging\RAA\raa_varldsarv_i_sverige
2025-07-25 01:23:19,903  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): pub.raa.se:443
2025-07-25 01:23:19,967  DEBUG    [urllib3.connectionpool:544]  https://pub.raa.se:443 "HEAD /nedladdning/datauttag/varldsarv/varldsarv_sverige.gpkg HTTP/1.1" 200 0
2025-07-25 01:23:19,968  INFO     [etl.utils.io:44]  ‚¨á raa_varldsarv_i_sverige.gpkg (520.0 KB)
2025-07-25 01:23:19,971  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): pub.raa.se:443
2025-07-25 01:23:20,049  DEBUG    [urllib3.connectionpool:544]  https://pub.raa.se:443 "GET /nedladdning/datauttag/varldsarv/varldsarv_sverige.gpkg HTTP/1.1" 200 532480
2025-07-25 01:23:20,220  INFO     [etl.utils.io:82]  ‚úÖ raa_varldsarv_i_sverige.gpkg
2025-07-25 01:23:20,221  INFO     [etl.handlers.file:278]  Determined staged_data_type: 'gpkg' for downloaded file 'raa_varldsarv_i_sverige.gpkg'
2025-07-25 01:23:20,230  INFO     [etl.handlers.file:292]  ‚ûï Staged GPKG raa_varldsarv_i_sverige.gpkg to data\staging\RAA\raa_varldsarv_i_sverige\raa_varldsarv_i_sverige.gpkg
2025-07-25 01:23:20,230  INFO     [pipeline:623]  üöö Intr√§ffade skred, ras och √∂vriga jordr√∂relser (skreddatabas)
2025-07-25 01:23:20,231  INFO     [etl.handlers.file:162]  üîó Single resource download mode for 'Intr√§ffade skred, ras och √∂vriga jordr√∂relser (skreddatabas)' from URL: https://gis.sgi.se/dokument/geodatasezip/SGI_Skreddatabas_ver2.zip
2025-07-25 01:23:20,417  INFO     [etl.utils.http:110]      Derived filename by unquoting URL basename ('https://gis.sgi.se/dokument/geodatasezip/SGI_Skreddatabas_ver2.zip'): SGI_Skreddatabas_ver2.zip
2025-07-25 01:23:20,420  DEBUG    [etl.handlers.file:247]  Attempting to download: https://gis.sgi.se/dokument/geodatasezip/SGI_Skreddatabas_ver2.zip 
    -> to local file: intraffade_skred_ras_och_ovriga_jordrorelser_skreddatabas.zip 
    -> staging dir: data\staging\SGI\intraffade_skred_ras_och_ovriga_jordrorelser_skreddatabas
2025-07-25 01:23:20,422  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): gis.sgi.se:443
2025-07-25 01:23:20,545  DEBUG    [urllib3.connectionpool:544]  https://gis.sgi.se:443 "HEAD /dokument/geodatasezip/SGI_Skreddatabas_ver2.zip HTTP/1.1" 200 0
2025-07-25 01:23:20,545  INFO     [etl.utils.io:44]  ‚¨á intraffade_skred_ras_och_ovriga_jordrorelser_skreddatabas.zip (188.2 KB)
2025-07-25 01:23:20,546  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): gis.sgi.se:443
2025-07-25 01:23:20,670  DEBUG    [urllib3.connectionpool:544]  https://gis.sgi.se:443 "GET /dokument/geodatasezip/SGI_Skreddatabas_ver2.zip HTTP/1.1" 200 192714
2025-07-25 01:23:20,903  INFO     [etl.utils.io:82]  ‚úÖ intraffade_skred_ras_och_ovriga_jordrorelser_skreddatabas.zip
2025-07-25 01:23:20,904  INFO     [etl.handlers.file:278]  Determined staged_data_type: 'shapefile_collection' for downloaded file 'intraffade_skred_ras_och_ovriga_jordrorelser_skreddatabas.zip'
2025-07-25 01:23:20,904  INFO     [etl.utils.io:88]  üì¶ Extracting intraffade_skred_ras_och_ovriga_jordrorelser_skreddatabas.zip ‚Üí C:\Git\ETL-pipeline\data\staging\SGI\intraffade_skred_ras_och_ovriga_jordrorelser_skreddatabas
2025-07-25 01:23:20,932  INFO     [etl.handlers.file:351]  ‚ûï Extracted and staged archive intraffade_skred_ras_och_ovriga_jordrorelser_skreddatabas.zip to data\staging\SGI\intraffade_skred_ras_och_ovriga_jordrorelser_skreddatabas
2025-07-25 01:23:20,933  INFO     [pipeline:623]  üöö Erosion
2025-07-25 01:23:20,933  INFO     [etl.handlers.ogc_api:103]      üó∫Ô∏è BBOX configured for source 'Erosion': 16.5008129,59.0906713,17.6220373,59.6050281 (CRS: CRS84 (default))
2025-07-25 01:23:20,933  INFO     [etl.handlers.ogc_api:178]  üåê Processing OGC API source: 'Erosion' from URL: https://api.sgu.se/oppnadata/stranderosion-kust/ogc/features/v1/collections/
2025-07-25 01:23:20,933  INFO     [etl.handlers.ogc_api:352]  üîÑ Discovering collections from: https://api.sgu.se/oppnadata/stranderosion-kust/ogc/features/v1/collections
2025-07-25 01:23:20,934  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): api.sgu.se:443
2025-07-25 01:23:21,071  DEBUG    [urllib3.connectionpool:544]  https://api.sgu.se:443 "GET /oppnadata/stranderosion-kust/ogc/features/v1/collections HTTP/1.1" 200 None
2025-07-25 01:23:21,110  INFO     [etl.handlers.ogc_api:386]  ‚úÖ Discovered 14 collections for source 'Erosion'
2025-07-25 01:23:21,110  DEBUG    [etl.handlers.ogc_api:392]      - Collection ID: aktiv-erosion, Title: Observerad aktiv erosion
2025-07-25 01:23:21,110  DEBUG    [etl.handlers.ogc_api:392]      - Collection ID: bottendynamik, Title: Bottendynamik
2025-07-25 01:23:21,110  DEBUG    [etl.handlers.ogc_api:392]      - Collection ID: bottenmaterial, Title: Bottenmaterial
2025-07-25 01:23:21,110  DEBUG    [etl.handlers.ogc_api:392]      - Collection ID: dynfotsforandring, Title: Dynfotens l√§gesf√∂r√§ndring
2025-07-25 01:23:21,110  DEBUG    [etl.handlers.ogc_api:392]      - Collection ID: erosionsforhallande-plus1m, Title: Erosionsf√∂rh√•llanden vid en framtida havsniv√•h√∂jning p√• ca 1 m
2025-07-25 01:23:21,110  DEBUG    [etl.handlers.ogc_api:392]      - Collection ID: erosionsforhallande-strand, Title: Erosionf√∂rh√•llanden p√• stranden
2025-07-25 01:23:21,110  DEBUG    [etl.handlers.ogc_api:392]      - Collection ID: erosionsindex, Title: Erosionsk√§nslighet baserat p√• index
2025-07-25 01:23:21,110  DEBUG    [etl.handlers.ogc_api:392]      - Collection ID: erosionsskydd, Title: Erosionsskydd
2025-07-25 01:23:21,110  DEBUG    [etl.handlers.ogc_api:392]      - Collection ID: oversvamningsskydd, Title: √ñversv√§mningsskydd
2025-07-25 01:23:21,111  DEBUG    [etl.handlers.ogc_api:392]      - Collection ID: sedimentsystem-grans, Title: Sedimentsystem, gr√§nslinje
2025-07-25 01:23:21,111  DEBUG    [etl.handlers.ogc_api:392]      - Collection ID: sedimenttransport-kustparallell, Title: Modellerad potentiell kustparallell sedimenttransport
2025-07-25 01:23:21,111  DEBUG    [etl.handlers.ogc_api:392]      - Collection ID: stranddynamik, Title: Stranddynamik
2025-07-25 01:23:21,111  DEBUG    [etl.handlers.ogc_api:392]      - Collection ID: strandmaterial, Title: Strandmaterial
2025-07-25 01:23:21,111  DEBUG    [etl.handlers.ogc_api:392]      - Collection ID: vattenyta-prognos, Title: Vattenyta vid h√∂jda havsniv√•er
2025-07-25 01:23:21,111  INFO     [etl.handlers.ogc_api:315]  üîß Filtering for configured collections: ['aktiv-erosion'] for source 'Erosion'
2025-07-25 01:23:21,111  INFO     [etl.handlers.ogc_api:212]  üì¶ Processing collection: aktiv-erosion (Source: Erosion)
2025-07-25 01:23:21,111  INFO     [etl.handlers.ogc_api:427]      üì¶ Fetching collection: aktiv-erosion (Observerad aktiv erosion)
2025-07-25 01:23:21,111  INFO     [etl.handlers.ogc_api:443]      üó∫Ô∏è Applied BBOX to items URL for collection 'aktiv-erosion'
2025-07-25 01:23:21,112  INFO     [etl.handlers.ogc_api:459]          üìÑ Fetching page 1 for collection 'aktiv-erosion' from https://api.sgu.se/oppnadata/stranderosion-kust/ogc/features/v1/collections/aktiv-erosion/items?f=application%2Fvnd.ogc.fg%2Bjson&bbox=16.5008129%2C59.0906713%2C17.6220373%2C59.6050281
2025-07-25 01:23:21,112  DEBUG    [etl.handlers.ogc_api:739]          Requesting OGC API page: https://api.sgu.se/oppnadata/stranderosion-kust/ogc/features/v1/collections/aktiv-erosion/items?f=application%2Fvnd.ogc.fg%2Bjson&bbox=16.5008129%2C59.0906713%2C17.6220373%2C59.6050281
2025-07-25 01:23:21,216  DEBUG    [urllib3.connectionpool:544]  https://api.sgu.se:443 "GET /oppnadata/stranderosion-kust/ogc/features/v1/collections/aktiv-erosion/items?f=application%2Fvnd.ogc.fg%2Bjson&bbox=16.5008129%2C59.0906713%2C17.6220373%2C59.6050281 HTTP/1.1" 500 137
2025-07-25 01:23:21,216  DEBUG    [urllib3.util.retry:521]  Incremented Retry for (url='/oppnadata/stranderosion-kust/ogc/features/v1/collections/aktiv-erosion/items?f=application%2Fvnd.ogc.fg%2Bjson&bbox=16.5008129%2C59.0906713%2C17.6220373%2C59.6050281'): Retry(total=1, connect=None, read=None, redirect=None, status=None)
2025-07-25 01:23:21,217  DEBUG    [urllib3.connectionpool:941]  Retry: /oppnadata/stranderosion-kust/ogc/features/v1/collections/aktiv-erosion/items?f=application%2Fvnd.ogc.fg%2Bjson&bbox=16.5008129%2C59.0906713%2C17.6220373%2C59.6050281
2025-07-25 01:23:21,294  DEBUG    [urllib3.connectionpool:544]  https://api.sgu.se:443 "GET /oppnadata/stranderosion-kust/ogc/features/v1/collections/aktiv-erosion/items?f=application%2Fvnd.ogc.fg%2Bjson&bbox=16.5008129%2C59.0906713%2C17.6220373%2C59.6050281 HTTP/1.1" 500 137
2025-07-25 01:23:21,295  DEBUG    [urllib3.util.retry:521]  Incremented Retry for (url='/oppnadata/stranderosion-kust/ogc/features/v1/collections/aktiv-erosion/items?f=application%2Fvnd.ogc.fg%2Bjson&bbox=16.5008129%2C59.0906713%2C17.6220373%2C59.6050281'): Retry(total=0, connect=None, read=None, redirect=None, status=None)
2025-07-25 01:23:21,896  DEBUG    [urllib3.connectionpool:941]  Retry: /oppnadata/stranderosion-kust/ogc/features/v1/collections/aktiv-erosion/items?f=application%2Fvnd.ogc.fg%2Bjson&bbox=16.5008129%2C59.0906713%2C17.6220373%2C59.6050281
2025-07-25 01:23:21,965  DEBUG    [urllib3.connectionpool:544]  https://api.sgu.se:443 "GET /oppnadata/stranderosion-kust/ogc/features/v1/collections/aktiv-erosion/items?f=application%2Fvnd.ogc.fg%2Bjson&bbox=16.5008129%2C59.0906713%2C17.6220373%2C59.6050281 HTTP/1.1" 500 137
2025-07-25 01:23:21,966  ERROR    [etl.handlers.ogc_api:236]  ‚ùå Error during OGC API processing for source Erosion: 'context'
urllib3.exceptions.ResponseError: too many 500 error responses

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\kije\AppData\Roaming\Python\Python311\site-packages\requests\adapters.py", line 667, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "C:\Users\kije\AppData\Local\ESRI\conda\envs\arcgispro-py3-dev\Lib\site-packages\urllib3\connectionpool.py", line 942, in urlopen
    return self.urlopen(
           ^^^^^^^^^^^^^
  File "C:\Users\kije\AppData\Local\ESRI\conda\envs\arcgispro-py3-dev\Lib\site-packages\urllib3\connectionpool.py", line 942, in urlopen
    return self.urlopen(
           ^^^^^^^^^^^^^
  File "C:\Users\kije\AppData\Local\ESRI\conda\envs\arcgispro-py3-dev\Lib\site-packages\urllib3\connectionpool.py", line 932, in urlopen
    retries = retries.increment(method, url, response=response, _pool=self)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\kije\AppData\Local\ESRI\conda\envs\arcgispro-py3-dev\Lib\site-packages\urllib3\util\retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='api.sgu.se', port=443): Max retries exceeded with url: /oppnadata/stranderosion-kust/ogc/features/v1/collections/aktiv-erosion/items?f=application%2Fvnd.ogc.fg%2Bjson&bbox=16.5008129%2C59.0906713%2C17.6220373%2C59.6050281 (Caused by ResponseError('too many 500 error responses'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Git\ETL-pipeline\etl\handlers\ogc_api.py", line 740, in _fetch_page
    response = self.session.get(url, timeout=DEFAULT_TIMEOUT)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\kije\AppData\Roaming\Python\Python311\site-packages\requests\sessions.py", line 602, in get
    return self.request("GET", url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Git\ETL-pipeline\etl\utils\http_session.py", line 133, in request_with_timeout
    return original_request(method, url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\kije\AppData\Roaming\Python\Python311\site-packages\requests\sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\kije\AppData\Roaming\Python\Python311\site-packages\requests\sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\kije\AppData\Roaming\Python\Python311\site-packages\requests\adapters.py", line 691, in send
    raise RetryError(e, request=request)
requests.exceptions.RetryError: HTTPSConnectionPool(host='api.sgu.se', port=443): Max retries exceeded with url: /oppnadata/stranderosion-kust/ogc/features/v1/collections/aktiv-erosion/items?f=application%2Fvnd.ogc.fg%2Bjson&bbox=16.5008129%2C59.0906713%2C17.6220373%2C59.6050281 (Caused by ResponseError('too many 500 error responses'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Git\ETL-pipeline\etl\utils\retry.py", line 464, in wrapper
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Git\ETL-pipeline\etl\handlers\ogc_api.py", line 791, in _fetch_page
    raise NetworkError(
          ^^^^^^^^^^^^^
  File "C:\Git\ETL-pipeline\etl\exceptions\core.py", line 144, in __init__
    super().__init__(
KeyError: 'context'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Git\ETL-pipeline\etl\handlers\ogc_api.py", line 217, in fetch
    if self._fetch_collection(collection_data):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Git\ETL-pipeline\etl\handlers\ogc_api.py", line 466, in _fetch_collection
    features_page, next_url_from_page = self._fetch_page(next_url)
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Git\ETL-pipeline\etl\utils\retry.py", line 482, in wrapper
    classified_error = classify_exception(e)
                       ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Git\ETL-pipeline\etl\exceptions\core.py", line 456, in classify_exception
    return SystemError(
           ^^^^^^^^^^^^
  File "C:\Git\ETL-pipeline\etl\exceptions\core.py", line 228, in __init__
    super().__init__(
KeyError: 'context'
2025-07-25 01:23:21,981  INFO     [pipeline:623]  üöö Brunnar
2025-07-25 01:23:21,982  INFO     [etl.handlers.ogc_api:103]      üó∫Ô∏è BBOX configured for source 'Brunnar': 16.5008129,59.0906713,17.6220373,59.6050281 (CRS: CRS84 (default))
2025-07-25 01:23:21,982  INFO     [etl.handlers.ogc_api:178]  üåê Processing OGC API source: 'Brunnar' from URL: https://api.sgu.se/oppnadata/brunnar/ogc/features/v1/collections/
2025-07-25 01:23:21,982  INFO     [etl.handlers.ogc_api:352]  üîÑ Discovering collections from: https://api.sgu.se/oppnadata/brunnar/ogc/features/v1/collections
2025-07-25 01:23:21,986  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): api.sgu.se:443
2025-07-25 01:23:22,099  DEBUG    [urllib3.connectionpool:544]  https://api.sgu.se:443 "GET /oppnadata/brunnar/ogc/features/v1/collections HTTP/1.1" 200 None
2025-07-25 01:23:22,101  INFO     [etl.handlers.ogc_api:386]  ‚úÖ Discovered 2 collections for source 'Brunnar'
2025-07-25 01:23:22,101  DEBUG    [etl.handlers.ogc_api:392]      - Collection ID: brunnar, Title: Brunnar
2025-07-25 01:23:22,101  DEBUG    [etl.handlers.ogc_api:392]      - Collection ID: brunnar-lager, Title: Brunnars lagerf√∂ljder
2025-07-25 01:23:22,101  INFO     [etl.handlers.ogc_api:315]  üîß Filtering for configured collections: ['brunnar'] for source 'Brunnar'
2025-07-25 01:23:22,101  INFO     [etl.handlers.ogc_api:212]  üì¶ Processing collection: brunnar (Source: Brunnar)
2025-07-25 01:23:22,102  INFO     [etl.handlers.ogc_api:427]      üì¶ Fetching collection: brunnar (Brunnar)
2025-07-25 01:23:22,102  INFO     [etl.handlers.ogc_api:443]      üó∫Ô∏è Applied BBOX to items URL for collection 'brunnar'
2025-07-25 01:23:22,103  INFO     [etl.handlers.ogc_api:459]          üìÑ Fetching page 1 for collection 'brunnar' from https://api.sgu.se/oppnadata/brunnar/ogc/features/v1/collections/brunnar/items?f=application%2Fvnd.ogc.fg%2Bjson&bbox=16.5008129%2C59.0906713%2C17.6220373%2C59.6050281
2025-07-25 01:23:22,104  DEBUG    [etl.handlers.ogc_api:739]          Requesting OGC API page: https://api.sgu.se/oppnadata/brunnar/ogc/features/v1/collections/brunnar/items?f=application%2Fvnd.ogc.fg%2Bjson&bbox=16.5008129%2C59.0906713%2C17.6220373%2C59.6050281
2025-07-25 01:23:31,609  DEBUG    [urllib3.connectionpool:544]  https://api.sgu.se:443 "GET /oppnadata/brunnar/ogc/features/v1/collections/brunnar/items?f=application%2Fvnd.ogc.fg%2Bjson&bbox=16.5008129%2C59.0906713%2C17.6220373%2C59.6050281 HTTP/1.1" 200 None
2025-07-25 01:23:32,601  INFO     [etl.handlers.ogc_api:477]          ‚úÖ Retrieved 19579 features on this page (total: 19579)
2025-07-25 01:23:32,602  WARNING  [etl.handlers.ogc_api:584]      ‚ö†Ô∏è SGU service for collection 'brunnar' reports EPSG:3006, but coordinates appear to be WGS84. Using EPSG:4326.
2025-07-25 01:23:32,602  INFO     [etl.handlers.ogc_api:592]      üó∫Ô∏è Using CRS from storageCrs for collection 'brunnar': EPSG:4326
2025-07-25 01:23:34,044  INFO     [etl.handlers.ogc_api:519]      üíæ Saved 19579 features for collection 'brunnar' to data\staging\SGU\brunnar\brunnar.geojson
2025-07-25 01:23:34,057  INFO     [pipeline:623]  üöö Jordskred och raviner
2025-07-25 01:23:34,057  INFO     [etl.handlers.ogc_api:103]      üó∫Ô∏è BBOX configured for source 'Jordskred och raviner': 16.5008129,59.0906713,17.6220373,59.6050281 (CRS: CRS84 (default))
2025-07-25 01:23:34,057  INFO     [etl.handlers.ogc_api:178]  üåê Processing OGC API source: 'Jordskred och raviner' from URL: https://api.sgu.se/oppnadata/jordskred-raviner/ogc/features/v1/collections/
2025-07-25 01:23:34,058  INFO     [etl.handlers.ogc_api:352]  üîÑ Discovering collections from: https://api.sgu.se/oppnadata/jordskred-raviner/ogc/features/v1/collections
2025-07-25 01:23:34,059  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): api.sgu.se:443
2025-07-25 01:23:34,150  DEBUG    [urllib3.connectionpool:544]  https://api.sgu.se:443 "GET /oppnadata/jordskred-raviner/ogc/features/v1/collections HTTP/1.1" 200 None
2025-07-25 01:23:34,152  INFO     [etl.handlers.ogc_api:386]  ‚úÖ Discovered 2 collections for source 'Jordskred och raviner'
2025-07-25 01:23:34,152  DEBUG    [etl.handlers.ogc_api:392]      - Collection ID: inventerat-omrade, Title: Inventerat omr√•de
2025-07-25 01:23:34,152  DEBUG    [etl.handlers.ogc_api:392]      - Collection ID: jordskred-raviner, Title: Jordskred och raviner
2025-07-25 01:23:34,152  INFO     [etl.handlers.ogc_api:315]  üîß Filtering for configured collections: ['jordskred-raviner'] for source 'Jordskred och raviner'
2025-07-25 01:23:34,152  INFO     [etl.handlers.ogc_api:212]  üì¶ Processing collection: jordskred-raviner (Source: Jordskred och raviner)
2025-07-25 01:23:34,153  INFO     [etl.handlers.ogc_api:427]      üì¶ Fetching collection: jordskred-raviner (Jordskred och raviner)
2025-07-25 01:23:34,153  INFO     [etl.handlers.ogc_api:443]      üó∫Ô∏è Applied BBOX to items URL for collection 'jordskred-raviner'
2025-07-25 01:23:34,154  INFO     [etl.handlers.ogc_api:459]          üìÑ Fetching page 1 for collection 'jordskred-raviner' from https://api.sgu.se/oppnadata/jordskred-raviner/ogc/features/v1/collections/jordskred-raviner/items?f=application%2Fvnd.ogc.fg%2Bjson&bbox=16.5008129%2C59.0906713%2C17.6220373%2C59.6050281
2025-07-25 01:23:34,155  DEBUG    [etl.handlers.ogc_api:739]          Requesting OGC API page: https://api.sgu.se/oppnadata/jordskred-raviner/ogc/features/v1/collections/jordskred-raviner/items?f=application%2Fvnd.ogc.fg%2Bjson&bbox=16.5008129%2C59.0906713%2C17.6220373%2C59.6050281
2025-07-25 01:23:34,279  DEBUG    [urllib3.connectionpool:544]  https://api.sgu.se:443 "GET /oppnadata/jordskred-raviner/ogc/features/v1/collections/jordskred-raviner/items?f=application%2Fvnd.ogc.fg%2Bjson&bbox=16.5008129%2C59.0906713%2C17.6220373%2C59.6050281 HTTP/1.1" 200 None
2025-07-25 01:23:34,298  INFO     [etl.handlers.ogc_api:477]          ‚úÖ Retrieved 48 features on this page (total: 48)
2025-07-25 01:23:34,298  WARNING  [etl.handlers.ogc_api:584]      ‚ö†Ô∏è SGU service for collection 'jordskred-raviner' reports EPSG:3006, but coordinates appear to be WGS84. Using EPSG:4326.
2025-07-25 01:23:34,299  INFO     [etl.handlers.ogc_api:592]      üó∫Ô∏è Using CRS from storageCrs for collection 'jordskred-raviner': EPSG:4326
2025-07-25 01:23:34,314  INFO     [etl.handlers.ogc_api:519]      üíæ Saved 48 features for collection 'jordskred-raviner' to data\staging\SGU\jordskred_och_raviner\jordskred-raviner.geojson
2025-07-25 01:23:34,315  INFO     [pipeline:623]  üöö Grus Krossberg
2025-07-25 01:23:34,315  INFO     [etl.handlers.ogc_api:103]      üó∫Ô∏è BBOX configured for source 'Grus Krossberg': 16.5008129,59.0906713,17.6220373,59.6050281 (CRS: CRS84 (default))
2025-07-25 01:23:34,315  INFO     [etl.handlers.ogc_api:178]  üåê Processing OGC API source: 'Grus Krossberg' from URL: https://api.sgu.se/oppnadata/grus-krossberg/ogc/features/v1/collections
2025-07-25 01:23:34,315  INFO     [etl.handlers.ogc_api:352]  üîÑ Discovering collections from: https://api.sgu.se/oppnadata/grus-krossberg/ogc/features/v1/collections
2025-07-25 01:23:34,317  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): api.sgu.se:443
2025-07-25 01:23:34,395  DEBUG    [urllib3.connectionpool:544]  https://api.sgu.se:443 "GET /oppnadata/grus-krossberg/ogc/features/v1/collections HTTP/1.1" 200 None
2025-07-25 01:23:34,397  INFO     [etl.handlers.ogc_api:386]  ‚úÖ Discovered 3 collections for source 'Grus Krossberg'
2025-07-25 01:23:34,397  DEBUG    [etl.handlers.ogc_api:392]      - Collection ID: grus-berg, Title: Bergf√∂rekomster
2025-07-25 01:23:34,397  DEBUG    [etl.handlers.ogc_api:392]      - Collection ID: grus-grus, Title: Grusf√∂rekomster
2025-07-25 01:23:34,397  DEBUG    [etl.handlers.ogc_api:392]      - Collection ID: grus-moran, Title: Mor√§nf√∂rekomster
2025-07-25 01:23:34,397  INFO     [etl.handlers.ogc_api:315]  üîß Filtering for configured collections: ['grus-grus', 'grus-berg', 'grus-moran'] for source 'Grus Krossberg'
2025-07-25 01:23:34,397  INFO     [etl.handlers.ogc_api:247]  üöÄ Starting concurrent download of 3 collections
2025-07-25 01:23:34,398  INFO     [etl.utils.concurrent:86]  Initialized ConcurrentDownloadManager with 3 workers
2025-07-25 01:23:34,398  INFO     [etl.utils.concurrent:293]  Starting concurrent download of 3 collections
2025-07-25 01:23:34,399  INFO     [etl.utils.concurrent:121]  Starting concurrent execution of 3 tasks with 3 workers
2025-07-25 01:23:34,407  INFO     [etl.utils.concurrent:215]  Concurrent execution completed: 0/3 successful (0.0%), avg=0.00s, max=0.00s, total=0.00s
2025-07-25 01:23:34,408  INFO     [etl.handlers.ogc_api:283]  üèÅ Concurrent collection downloads completed: 0 successful, 3 failed
2025-07-25 01:23:34,408  ERROR    [etl.handlers.ogc_api:292]  ‚ùå Collection download failed: collection_grus-berg - name 'time' is not defined
2025-07-25 01:23:34,408  ERROR    [etl.handlers.ogc_api:292]  ‚ùå Collection download failed: collection_grus-grus - name 'time' is not defined
2025-07-25 01:23:34,408  ERROR    [etl.handlers.ogc_api:292]  ‚ùå Collection download failed: collection_grus-moran - name 'time' is not defined
2025-07-25 01:23:34,408  WARNING  [etl.handlers.ogc_api:227]  ‚ö†Ô∏è No collections were successfully processed/saved with data for source: Grus Krossberg
2025-07-25 01:23:34,409  INFO     [pipeline:623]  üöö Jordbruksblock (2024)
2025-07-25 01:23:34,411  INFO     [etl.handlers.rest_api:68]  üöÄ Initializing RestApiDownloadHandler for source: Jordbruksblock (2024)
2025-07-25 01:23:34,411  INFO     [etl.handlers.rest_api:321]  üåê Processing REST API source: 'Jordbruksblock (2024)' from URL: https://ext-geodata-nationella.lansstyrelsen.se/arcgis/rest/services/SJV/lst_sjv_fak04jbb/MapServer
2025-07-25 01:23:34,485  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-nationella.lansstyrelsen.se:443 "GET /arcgis/rest/services/SJV/lst_sjv_fak04jbb/MapServer?f=json HTTP/1.1" 200 1193
2025-07-25 01:23:34,486  INFO     [etl.handlers.rest_api:346]  Found explicit layer_ids in config: [18] for source 'Jordbruksblock (2024)'. Processing only these.
2025-07-25 01:23:34,486  INFO     [etl.handlers.rest_api:427]  Source 'Jordbruksblock (2024)': Will attempt to query 1 layer(s): ['18']
2025-07-25 01:23:34,486  INFO     [etl.handlers.rest_api:659]  üöö sjv_jordbruksblock_2024
2025-07-25 01:23:34,486  DEBUG    [etl.handlers.rest_api:660]  Querying Layer ID: 18 (Sanitized Name: sjv_jordbruksblock_2024, Original: SJV Jordbruksblock 2024) from https://ext-geodata-nationella.lansstyrelsen.se/arcgis/rest/services/SJV/lst_sjv_fak04jbb/MapServer/18/query
2025-07-25 01:23:34,486  DEBUG    [etl.handlers.rest_api:530]  maxRecordCount not found in layer metadata, using default: 5000
2025-07-25 01:23:34,486  DEBUG    [etl.handlers.rest_api:199]  Applying BBOX: 586206,6551160,647910,6610992 (SRID: 3006)
2025-07-25 01:23:34,489  DEBUG    [etl.handlers.rest_api:565]  Fetching page 1 for layer sjv_jordbruksblock_2024 (offset 0, limit 5000)
2025-07-25 01:23:35,144  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-nationella.lansstyrelsen.se:443 "GET /arcgis/rest/services/SJV/lst_sjv_fak04jbb/MapServer/18/query?where=1%3D1&outFields=%2A&returnGeometry=true&f=geojson&geometry=586206%2C6551160%2C647910%2C6610992&geometryType=esriGeometryEnvelope&inSR=3006&spatialRel=esriSpatialRelIntersects&resultOffset=0&resultRecordCount=5000 HTTP/1.1" 200 None
2025-07-25 01:23:35,558  DEBUG    [etl.handlers.rest_api:270]  ‚ö†Ô∏è Exceeded transfer limit for layer sjv_jordbruksblock_2024, fetching next page.
2025-07-25 01:23:35,559  DEBUG    [etl.handlers.rest_api:565]  Fetching page 2 for layer sjv_jordbruksblock_2024 (offset 2000, limit 5000)
2025-07-25 01:23:36,216  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-nationella.lansstyrelsen.se:443 "GET /arcgis/rest/services/SJV/lst_sjv_fak04jbb/MapServer/18/query?where=1%3D1&outFields=%2A&returnGeometry=true&f=geojson&geometry=586206%2C6551160%2C647910%2C6610992&geometryType=esriGeometryEnvelope&inSR=3006&spatialRel=esriSpatialRelIntersects&resultOffset=2000&resultRecordCount=5000 HTTP/1.1" 200 None
2025-07-25 01:23:36,759  DEBUG    [etl.handlers.rest_api:270]  ‚ö†Ô∏è Exceeded transfer limit for layer sjv_jordbruksblock_2024, fetching next page.
2025-07-25 01:23:36,759  DEBUG    [etl.handlers.rest_api:565]  Fetching page 3 for layer sjv_jordbruksblock_2024 (offset 4000, limit 5000)
2025-07-25 01:23:37,350  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-nationella.lansstyrelsen.se:443 "GET /arcgis/rest/services/SJV/lst_sjv_fak04jbb/MapServer/18/query?where=1%3D1&outFields=%2A&returnGeometry=true&f=geojson&geometry=586206%2C6551160%2C647910%2C6610992&geometryType=esriGeometryEnvelope&inSR=3006&spatialRel=esriSpatialRelIntersects&resultOffset=4000&resultRecordCount=5000 HTTP/1.1" 200 None
2025-07-25 01:23:38,009  DEBUG    [etl.handlers.rest_api:270]  ‚ö†Ô∏è Exceeded transfer limit for layer sjv_jordbruksblock_2024, fetching next page.
2025-07-25 01:23:38,009  DEBUG    [etl.handlers.rest_api:565]  Fetching page 4 for layer sjv_jordbruksblock_2024 (offset 6000, limit 5000)
2025-07-25 01:23:38,586  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-nationella.lansstyrelsen.se:443 "GET /arcgis/rest/services/SJV/lst_sjv_fak04jbb/MapServer/18/query?where=1%3D1&outFields=%2A&returnGeometry=true&f=geojson&geometry=586206%2C6551160%2C647910%2C6610992&geometryType=esriGeometryEnvelope&inSR=3006&spatialRel=esriSpatialRelIntersects&resultOffset=6000&resultRecordCount=5000 HTTP/1.1" 200 None
2025-07-25 01:23:39,227  DEBUG    [etl.handlers.rest_api:270]  ‚ö†Ô∏è Exceeded transfer limit for layer sjv_jordbruksblock_2024, fetching next page.
2025-07-25 01:23:39,227  DEBUG    [etl.handlers.rest_api:565]  Fetching page 5 for layer sjv_jordbruksblock_2024 (offset 8000, limit 5000)
2025-07-25 01:23:39,856  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-nationella.lansstyrelsen.se:443 "GET /arcgis/rest/services/SJV/lst_sjv_fak04jbb/MapServer/18/query?where=1%3D1&outFields=%2A&returnGeometry=true&f=geojson&geometry=586206%2C6551160%2C647910%2C6610992&geometryType=esriGeometryEnvelope&inSR=3006&spatialRel=esriSpatialRelIntersects&resultOffset=8000&resultRecordCount=5000 HTTP/1.1" 200 None
2025-07-25 01:23:40,509  DEBUG    [etl.handlers.rest_api:270]  ‚ö†Ô∏è Exceeded transfer limit for layer sjv_jordbruksblock_2024, fetching next page.
2025-07-25 01:23:40,509  DEBUG    [etl.handlers.rest_api:565]  Fetching page 6 for layer sjv_jordbruksblock_2024 (offset 10000, limit 5000)
2025-07-25 01:23:41,151  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-nationella.lansstyrelsen.se:443 "GET /arcgis/rest/services/SJV/lst_sjv_fak04jbb/MapServer/18/query?where=1%3D1&outFields=%2A&returnGeometry=true&f=geojson&geometry=586206%2C6551160%2C647910%2C6610992&geometryType=esriGeometryEnvelope&inSR=3006&spatialRel=esriSpatialRelIntersects&resultOffset=10000&resultRecordCount=5000 HTTP/1.1" 200 None
2025-07-25 01:23:41,878  DEBUG    [etl.handlers.rest_api:270]  ‚ö†Ô∏è Exceeded transfer limit for layer sjv_jordbruksblock_2024, fetching next page.
2025-07-25 01:23:41,878  DEBUG    [etl.handlers.rest_api:565]  Fetching page 7 for layer sjv_jordbruksblock_2024 (offset 12000, limit 5000)
2025-07-25 01:23:42,544  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-nationella.lansstyrelsen.se:443 "GET /arcgis/rest/services/SJV/lst_sjv_fak04jbb/MapServer/18/query?where=1%3D1&outFields=%2A&returnGeometry=true&f=geojson&geometry=586206%2C6551160%2C647910%2C6610992&geometryType=esriGeometryEnvelope&inSR=3006&spatialRel=esriSpatialRelIntersects&resultOffset=12000&resultRecordCount=5000 HTTP/1.1" 200 None
2025-07-25 01:23:43,368  DEBUG    [etl.handlers.rest_api:270]  ‚ö†Ô∏è Exceeded transfer limit for layer sjv_jordbruksblock_2024, fetching next page.
2025-07-25 01:23:43,368  DEBUG    [etl.handlers.rest_api:565]  Fetching page 8 for layer sjv_jordbruksblock_2024 (offset 14000, limit 5000)
2025-07-25 01:23:44,030  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-nationella.lansstyrelsen.se:443 "GET /arcgis/rest/services/SJV/lst_sjv_fak04jbb/MapServer/18/query?where=1%3D1&outFields=%2A&returnGeometry=true&f=geojson&geometry=586206%2C6551160%2C647910%2C6610992&geometryType=esriGeometryEnvelope&inSR=3006&spatialRel=esriSpatialRelIntersects&resultOffset=14000&resultRecordCount=5000 HTTP/1.1" 200 None
2025-07-25 01:23:44,673  DEBUG    [etl.handlers.rest_api:270]  ‚ö†Ô∏è Exceeded transfer limit for layer sjv_jordbruksblock_2024, fetching next page.
2025-07-25 01:23:44,673  DEBUG    [etl.handlers.rest_api:565]  Fetching page 9 for layer sjv_jordbruksblock_2024 (offset 16000, limit 5000)
2025-07-25 01:23:45,323  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-nationella.lansstyrelsen.se:443 "GET /arcgis/rest/services/SJV/lst_sjv_fak04jbb/MapServer/18/query?where=1%3D1&outFields=%2A&returnGeometry=true&f=geojson&geometry=586206%2C6551160%2C647910%2C6610992&geometryType=esriGeometryEnvelope&inSR=3006&spatialRel=esriSpatialRelIntersects&resultOffset=16000&resultRecordCount=5000 HTTP/1.1" 200 None
2025-07-25 01:23:46,084  DEBUG    [etl.handlers.rest_api:270]  ‚ö†Ô∏è Exceeded transfer limit for layer sjv_jordbruksblock_2024, fetching next page.
2025-07-25 01:23:46,085  DEBUG    [etl.handlers.rest_api:565]  Fetching page 10 for layer sjv_jordbruksblock_2024 (offset 18000, limit 5000)
2025-07-25 01:23:46,432  DEBUG    [urllib3.connectionpool:544]  https://ext-geodata-nationella.lansstyrelsen.se:443 "GET /arcgis/rest/services/SJV/lst_sjv_fak04jbb/MapServer/18/query?where=1%3D1&outFields=%2A&returnGeometry=true&f=geojson&geometry=586206%2C6551160%2C647910%2C6610992&geometryType=esriGeometryEnvelope&inSR=3006&spatialRel=esriSpatialRelIntersects&resultOffset=18000&resultRecordCount=5000 HTTP/1.1" 200 None
2025-07-25 01:23:46,627  DEBUG    [etl.handlers.rest_api:279]  üèÅ All features likely retrieved for layer sjv_jordbruksblock_2024 (less than page limit or server maxRecordCount is 0).
2025-07-25 01:23:55,605  INFO     [etl.handlers.rest_api:298]  ‚úÖ sjv_jordbruksblock_2024: 18581 features
2025-07-25 01:23:55,605  DEBUG    [etl.handlers.rest_api:299]  üíæ Successfully saved 18581 features for layer sjv_jordbruksblock_2024 to C:\Git\ETL-pipeline\data\staging\SJV\jordbruksblock_2024\sjv_jordbruksblock_2024.geojson
2025-07-25 01:23:55,671  INFO     [pipeline:623]  üöö Jordbruksskiften (senaste √•ret)
2025-07-25 01:23:55,672  INFO     [etl.handlers.rest_api:68]  üöÄ Initializing RestApiDownloadHandler for source: Jordbruksskiften (senaste √•ret)
2025-07-25 01:23:55,672  INFO     [etl.handlers.rest_api:321]  üåê Processing REST API source: 'Jordbruksskiften (senaste √•ret)' from URL: https://epub.sjv.se/inspire/inspire/wfs?service=WFS&request=GetFeature&typeName=inspire:senaste_arslager_skifte&outputFormat=application/json
2025-07-25 01:23:55,674  DEBUG    [urllib3.connectionpool:1049]  Starting new HTTPS connection (1): epub.sjv.se:443
2025-07-25 01:23:56,508  DEBUG    [urllib3.connectionpool:544]  https://epub.sjv.se:443 "GET /inspire/inspire/wfs?service=WFS&request=GetFeature&typeName=inspire:senaste_arslager_skifte&outputFormat=application/json&f=json HTTP/1.1" 200 None
